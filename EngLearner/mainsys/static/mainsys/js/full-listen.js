define("new_toefl/js/channel/intensive/full-listen",["jquery","../../mod/intensive/newplayer","../../mod/cursor","../../mod/player/write_scrollto","../../plugin/jquery-jplayer","../../plugin/jquery-slider","jqueryui","../../../tpl/newplayer/write-operate-l.tpl","../../mod/intensive/word/screen_word","../../mod/intensive/word/note","../../../tpl/intensive/note.tpl","../../mod/intensive/word/drag","../../util/new_favorite","../../util/form-textarea","../../../tpl/favorite/favList.tpl","../../../tpl/favorite/favorite.tpl","../../../tpl/favorite/newFavList.tpl","../../../tpl/intensive/popButton.tpl","../../../tpl/intensive/translate.tpl","../../mod/intensive/exit_listen","../../mod/intensive/original-ctrl","../../mod/intensive/favorite","../../mod/intensive/note-event","../../../kmf_components/xss-filter/main","../../util/drag","../../../tpl/intensive/note-dialog.tpl","../../mod/intensive/nice-research","../../../tpl/intensive/researchCard.tpl"],function(a,b,c){var d=a("jquery"),e=a("../../mod/intensive/newplayer"),f=a("../../mod/intensive/word/screen_word"),g=a("../../mod/intensive/exit_listen"),h=a("../../mod/intensive/original-ctrl"),i=a("../../mod/intensive/note-event"),j=a("../../mod/intensive/nice-research");new f(".js-translate-newcontent",{noteEvent:i}),{init:function(a){var b=this,a=a||{},c={style:{active:"active"},select:{showTransition:".js-switch-translation",showOrigin:".js-switch-origin",collectBox:".js-collect-cont",loopLists:".loop-current",sideSentence:".js-playSelected",fullSentences:".lrc-sentence",pauseEl:".js-audio-pause"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.ajaxGetData="",a},getDom:function(){var a=this;return a.$audioUd=d(".js-audio-ud"),a.$audioSpeed=d(".js-audio-speed"),a.$volumeCont=d(".js-volume-cont"),a.$showTransition=d(a.select.showTransition),a.$showOrigin=d(a.select.showOrigin),a.$collectBox=d(a.select.collectBox),a.$loopLists=d(a.select.loopLists),a.$sideSentence=d(a.select.sideSentence),a.$fullSentences=d(a.select.fullSentences),a.$pauseEl=d(a.select.pauseEl),a},setVariable:function(){var a=this;return a.status=200,a.data={},a},bindEvent:function(){var a=this;return a._showTransition(),a._broswerTip(),a._hideSelectListsEvent(),a._addIndex(),a._showOrigin(),g({ele:".js-quit-listen",title:"精听练习",message:"确认退出此次的精听练习吗?"}),h({noteEvent:i}),j(a.opt),a},_addIndex:function(){var a=this;return d.each(a.$sideSentence,function(a,b){d(b).attr("data-index",a)}),d.each(a.$fullSentences,function(a,b){d(b).attr("data-index",a)}),a},_showTransition:function(){var a=this;a.$showTransition.on("click",function(){var a=d(this);a.hasClass("active")?(a.removeClass("active"),a.parents(".paragraph-sentence").find(".translation-box").hide()):(a.addClass("active"),a.parents(".paragraph-sentence").find(".translation-box").show())}),a.$showTransition.on({mouseenter:function(){d(this).find(".show-transition").show()},mouseleave:function(){d(this).find(".show-transition").hide()}})},_showOrigin:function(){var a=this;a.$showOrigin.on("click",function(){d(this).parents(".js-orgin-content").find(".origin-hide").show()}),a.$showOrigin.on({mouseenter:function(){d(this).find(".show-transition").show()},mouseleave:function(){d(this).find(".show-transition").hide()}})},_hideSelectListsEvent:function(){var a=this;return d(document).on("click",function(b){a.$pauseEl.removeClass("active"),a.$loopLists.removeClass("active"),a.$collectBox.removeClass("active"),a.$audioUd.removeClass("active"),a.$audioSpeed.removeClass("active"),a.$volumeCont.removeClass("active");var c=d(".g-word-translate");c.size()&&c.remove()}),a},_broswerTip:function(){var a=this;return-1!=navigator.userAgent.indexOf("Edge")&&alert("Edge浏览器可能存在音频点不准确问题，建议切换浏览器使用<br/>>_<"),a}}.init(),c.exports={kmfPlay:e}}),define("new_toefl/js/mod/intensive/newplayer",["jquery","new_toefl/js/mod/cursor","new_toefl/js/mod/player/write_scrollto","new_toefl/js/plugin/jquery-jplayer","new_toefl/js/plugin/jquery-slider","jqueryui"],function(a,b,c){var d=a("jquery");a("new_toefl/js/mod/cursor"),a("new_toefl/js/mod/player/write_scrollto");a("new_toefl/js/plugin/jquery-jplayer"),a("new_toefl/js/plugin/jquery-slider");var e=function(a,b,c){var e,f=this,g=d('<div id="kmflayer"></div>'),h={playList:null,listUrl:"",cssSelector:{originalMain:".js-origin-main",originalCont:".original-cont",originalBegin:".js-original-begin",fullBegin:".original-begin",sentenceBegin:".sentence-begin",allPage:".origin-hidden-page",sentencePage:".listen-sentence-cont",playType:".listen-modes a",playProgress:".audio-progress",volume:".volume-progress",totalTime:".jp-total-time",next:".jp-next",prev:".jp-prev",volumeCont:".js-volume-cont",playRate:".js-audio-speed",pauseTime:".js-audio-pause",loopEvent:".js-pop-loop",miniPlay:".js-playSelected",rateSubmenu:".js-speed-lists",speedDetail:".js-speed-detail",originalSuggest:".js-original-suggest",pannelCnLrc:".js-translation-btn",audioUd:".js-audio-ud",udBtn:".js-ud-btn",udTime:".js-ud-time",defaultUdBtn:".js-default-ud",forward:".audio-forward",backward:".audio-backward",pannelPlaying:".pannel-playing",pannelPause:".pannel-pause",pannelRepeatW:".pannel-repeat-w",pannelNext:".pannel-next",pannelStatusW:".pannel-status-w",pannelWarp:".original-cont",pannelPlay:".pannel-play",initialStart:".js-start-intensive",pannelLrc:".js-original-btn",writeCurSentence:".pannel-towrite",lrcEnter:".not-show-original",lrcBody:".original-detail-box",originContent:".js-switch-origin",originPlayIcon:".origin-play-icon",version:"#version",unique:"#js-examUnique",lrcSentence:".lrc-sentence",lrcParagraph:".lrc-paragraph",lrcEn:".original-en",lrcCn:".original-cn",listenCount:".listen-count .count",inWord:".pannel-word",words:".js-words",writeWword:".write-word",words:".js-words",originDisplay:".js-origin-display",originBtnWrap:".rel-action",toWritePannel:"#js-toWrite",toListenPannel:"#js-toListen",listenBox:".listen-original-cont",sentenceBox:".sentence-original-cont",selectBtn:".js-type-select",initialPage:".original-begin",playingEl:".playing-style",sentenceShow:".show-translation-btn",sentenceOriginText:".listen-sentence-detail",allHide:".origin-hide-box",hideBox:".origin-hide",sentenceList:".listen-sentence-list",sideSentence:".pl-sentence",nextAudio:".js-next-audio",prevAudio:".js-prev-audio",fullDbl:".hover-style",noplayingIcon:".noplaying-hover-style",refreshBtn:".refresh-current",loopBtn:".loop-current",showTransition:".js-sentence-transition",transitionBtn:".translation-btn-msg",fullHover:".hover-style-title",sentenceOrigin:".js-sentence-origin"},lrcCenter:"lrc-list-center",playTypeSty:"current",playType:"full",autoPlay:!1,postType:"accurate",listenUrl:"",logUrl:"",favUrl:"",completeUrl:"",curAudio:0,listenType:0,sentencePlayObj:{}};this.listOptions=d.extend({},h,b),b&&b.cssSelector?this.selector=d.extend({},h.cssSelector,b.cssSelector):this.selector=this.listOptions.cssSelector,this.curAudio=this.listOptions.curAudio,current={sentence:-1,write:-1,paragraph:0,full:0},this.current={},this.ajaxStatus=200,this.playType=this.listOptions.playType,this.isBegin=!0,this.answers={},this.writeStatus={},this.lrcStatus={},this.playTimer=null,this.hasLrc=!0,this.lrcTimer=null;var i=navigator.userAgent;if(this.isSafari=/safari/i.test(i)&&!/chrome/i.test(i),this.totalWriteTime=0,this.questionId=d(this.selector.questionId).val(),this.loginState=~~parseInt(kmfGlobalUser.loginStatus),this.playing=!1,this.loopTimes=3,this.curAudioPlayTimes=0,this.sideSpace=0,this.isEnd=!1,this.playRate=1,this.nextPreBool=!1,this.size=d(this.selector.sideSentence).size(),this.fullPause=null,this.bComplate=!1,this.bLogin=~~d("#GlobeLogin").val(),this.bGrowth=!1,this.i=0,this.scrollVar=180,this.cardAnimate=!0,this.dblclickTimer=null,this.dblclickerPause=200,this.drillingVersion=d("#drilling_version").val(),this.unique=d("#js-examUnique").val(),this.ajaxLoginStatus="/ajax/statdrillinglog",this.listOptions&&this.listOptions.playList){this.playList=this.initList(this.listOptions.playList);for(var j=0;j<this.playList.length;j++)this.current[j]=d.extend({},current),this.totalWriteTime+=parseFloat(this.playList[j].article[0].audio_time)}this.listOptions&&this.listOptions.listUrl&&this.loadList();var k={ready:function(a){f.fixFlash_mp4=a.jPlayer.flash.used&&/m4a|m4v/.test(a.jPlayer.options.supplied),f.listOptions.playList&&(f.setMedia(f.playList[0].filePath),f.listOptions.autoPlay&&f.play.call(f))},swfPath:"/dist/new_toefl/images/",solution:"html, flash",supplied:"mp3",wmode:"window",defaultPlaybackRate:1,smoothPlayBar:!0,keyEnabled:1==this.listOptions.listenType||2==this.listOptions.listenType,keyBindings:{muted:{key:8,fn:function(){}}},remainingDuration:!0,toggleDuration:!0,cssSelectorAncestor:"#jp_container_1",timeupdate:function(a){e||d(f.listOptions.cssSelector.playProgress).slider("value",a.jPlayer.status.currentPercentAbsolute)}};return!a||a.length<1?(g.appendTo("body"),this.$ele=g):this.$ele=a,this.options=d.extend({},k,c),this.$ele.jPlayer(this.options),this.initialiseEvent(),this.sendLoginData(),this._hideOrigin(),this._showSTransition(),this._showOrigin(),this._sentenceHideOrigin(),d(".js-origin-main").addClass("full"),setInterval(function(){f.isCanSendRequest()},1e3),this};e.prototype={status:{isWrite:!1,whichType:1,sentenceIndex:0,originDisplay:!1,originEnShow:!1,originCnShow:!1,complate:!1,backwardTime:1,forwardTime:1,hasWriteWordNum:0,isCanSendWordNumRequest:!0,isCanSendListenRequest:!0,isBigNum80Percent:!1,isBigListen80Percent:!1,totalWordNum:0,startWriteTime:0,EndWriteTime:0,FinishWriteTime:0,listenTime:0,isBegin:!0,isBreak:!1,isPercent:!1,bSend:!1,bPercent:!1,beginNum:d.cookie("toefl_intensive_"+this.questionId)||0,hasWriteTime:0,playStatus:!1},initList:function(a){var b=a||[];return d.each(b,function(){this.paragraph=this.section||[],this.write=this.sentence,this.full=this.article||[],this.audio=this.audio||{},this.filePath={},this.audio.formatType&&this.audio.filePath&&(this.filePath[this.audio.formatType]=this.audio.filePath)}),b},loadList:function(){var a=this;d.post(this.listOptions.listUrl,function(b){1==b.status&&(a.playList=a.initList(b.result))},"json")},setMedia:function(a){this.$ele.jPlayer("setMedia",a)},play:function(a,b){this.nextPreBool=!1;var c=this;this.$ele.jPlayer("playbackRate",this.playRate),void 0!==a?this.isSafari?this.$ele.jPlayer("play",parseFloat(a)+.05):this.$ele.jPlayer("play",parseFloat(a)):this.$ele.jPlayer("play"),this.playTimer&&(clearTimeout(this.playTimer),this.playTimer),b&&(this.playTimer=setTimeout(function(){c.$ele.trigger(d.jPlayer.event.play)},220))},nextPlay:function(a){if(!this.nextPreBool){this.nextPreBool=!0;var b=this.playType,c=this.current.sentence,e=this.size;if(a){if(c-1<0)return}else if(c+1>e-1)return;if("full"==(b="full"===b?"full":"sentence")){if(a)var f=d(this.selector.noplayingIcon).eq(2*(c-1));else var f=d(this.selector.noplayingIcon).eq(2*(c+1));f.click()}else a?d(this.selector.prevAudio).click():d(this.selector.nextAudio).click()}},next:function(){var a=this.playList[this.curAudio].sentence,b=a.length;"paragraph"==this.playType&&this.$ele.jPlayer("setSeek",!0),this.current.sentence<b-1&&(this.current.sentence++,this.play(a[this.current.sentence].start_time,!0))},prev:function(){var a=this.playList[this.curAudio].sentence;this.current.sentence>0&&(this.current.sentence--,this.play(a[this.current.sentence].start_time,!0))},select:function(){},pause:function(a){void 0!==a?this.isSafari?this.$ele.jPlayer("pause",parseFloat(a)+.05):this.$ele.jPlayer("pause",parseFloat(a)):this.$ele.jPlayer("pause"),d.jPlayer.browser.msie&&(Number(d.jPlayer.browser.version)<9||d.jPlayer.browser.documentMode<9)&&self.$ele.trigger(d.jPlayer.event.timeupdate)},getTotalTime:function(){var a,b=this.playList[this.curAudio],c=b.audio.audio_time,d=c.split(":"),e=d.length,f=0;for(a=0;a<e-1;a++)f+=Math.pow(60,e-a-1)*parseInt(d[a]);return f+=parseFloat(d[e-1])},switchType:function(){return"write"===this.playType?"sentence":this.playType},breakPoint:function(a,b){var c=this.switchType(),d=this.playList[this.curAudio][c],e=(d.timeList,"full"==this.switchType()?this.current[this.curAudio][c]:this.current[c]),f=!1;e<0||(f=d[e+1]?a.jPlayer.status.currentTime>=d[e+1].start_time:b,f&&(d[e].start_time,this.isBreak=!0),b&&"sentence"==c&&this._dataStatistics(e))},_dataStatistics:function(a){var b=this;if(!(a<0)){d(b.selector.sideSentence).eq(a).attr("data-status");b._totalLog(a),d(b.selector.sideSentence).eq(a).attr("data-status",1)}},totalLog:function(a){var b,c,e=this.listOptions.logUrl,f=this.playType,g=this.playList[this.curAudio][f],h=d("#target_id").val(),i=d("#js-question_source").val(),j=g[a].id,k=g[a].audio_time,l=this,m=this.selector;""!=e&&(b="write"===this.playType?2:1,c={at:k,type:b,source:i,qid:h,lid:j,version:d(m.version).val(),u:d(m.unique).val()},l.loginState&&d.post(e,c,function(a){a.status},"json"))},totalCount:function(a){var b,c=this.listOptions.listenUrl,e=this.listOptions.postType,f=this.playType,g=this.playList[this.curAudio][f],h=g[a].id,i=this;""!=c&&(b={type:e,lyric_id:h},d.post(c,b,function(b){1==b.status&&(g[a].listenCount++,i.updateCount.call(i))},"json"))},totalComplete:function(){var a,b,c,e,f=this,g=d("#js-question_source").val(),h=this.selector;a=this.listOptions.completeUrl,b=d("#target_id").val(),c=d("#js-examUnique").val(),e=d("#js-listenType").val(),f.status.complate||parseInt(kmfGlobalUser.loginStatus,10)&&d.post(a,{qid:b,exam_unique:c,source:g,listen_type:e,version:d(h.version).val()},function(a){0==a.status?alert(a.result):1==a.status&&f.setting("complate",!0)},"json")},sendLoginData:function(){var a=this,b={version:a.drillingVersion,exam_unique:a.unique};return setTimeout(function(){d.post(a.ajaxLoginStatus,b,function(a){var b=a.status,c=(a.result,a.message);200!=b&&console.warn("warn: ",c)},"json")},6e4),a},setPlayRate:function(a){a>0&&(this.$ele.jPlayer("playbackRate",a),this.playRate=a)},updateCount:function(){var a,b=d(this.options.cssSelectorAncestor),c=this.playType,e=this.playList[this.curAudio][c],f=this.current[this.curAudio][c]<0?0:this.current[this.curAudio][c],g=b.find(this.selector.listenCount);a=e[f].listenCount,g.text(a)},updateCurrent:function(a){function b(a){for(var b=-1,c=0,d=a.length;c<d;c++)f>=a[c].start_time-g&&(b=c);return b}var c=this;"sentence"==c.playType&&c.updateSentenceBtn(),this.isEnd=a.jPlayer.status.paused;var d=this.playList[this.curAudio].sentence,e=this.playList[this.curAudio].paragraph,f=a.jPlayer.status.currentTime,g=.3;if("full"==this.playType){var h=b(d);this.playing&&this.current.sentence==h-1?(this._dataStatistics(this.current.sentence),1*c.sideSpace?(this.pause(),c.fullPause=setTimeout(function(){c.current.sentence=h;var a=sessionStorage.getItem("is_pause");a="false"==a?0:1,a?(clearTimeout(c.fullPause),c.fullPause=null):c.play()},1e3*c.sideSpace)):c.current.sentence=h):c.current.sentence=h}this.current.paragraph=b(e)<0?0:b(e),a.jPlayer.status.isSeeked&&this.$ele.jPlayer("setSeek",!1)},updateSentenceBtn:function(){var a=this;a.current.sentence>=a.size-1?d(a.selector.nextAudio).addClass("disable"):d(a.selector.nextAudio).removeClass("disable"),a.current.sentence<=0?d(a.selector.prevAudio).addClass("disable"):d(a.selector.prevAudio).removeClass("disable")},_originalAnimate:function(){var a=d(".js-listen-sentence"),b=d(".js-listen-sentences"),c=a.size(),e=this,a=a.eq(0),f=a.outerWidth();return b.css("width",f*c),b.stop().animate({left:-f*this.current.sentence},300,function(){var a=d(e.selector.sentenceList).eq(e.current.sentence).data("type"),b=d(e.selector.sentenceList).eq(e.current.sentence).data("url");e.listOptions.sentencePlayObj[a]=b,e.setMedia(e.listOptions.sentencePlayObj),e.play(),e.cardAnimate=!0}),e},repeat:function(a){var b=this.playList[this.curAudio][a],c=-1==this.current[a]?0:this.current[a],d=b[c].start_time;this.play(d)},refreshPlay:function(){this.repeat("sentence")},updateInterface:function(){var a=this.current.sentence,b=(this.current.paragraph,"lrc-sentence-current"),c="current",e=d(".lrc-sentence"),f=(d(".pl-paragraph"),d(".pl-sentence")),g=d("#js-btn-modify"),h=d(".origin-hide-box"),i=d(".icon-player"),j="active",k=(d(".listen-sentence-list"),this);d("."+b).removeClass(b),a>-1?(g.data("reportid",this.playList[this.curAudio].sentence[a].id),h.removeClass("js-playing"),h.eq(a).addClass("js-playing"),f.removeClass("js-playing"),f.removeClass(j),f.eq(a).addClass("js-playing"),f.eq(a).addClass(j),k.status.playStatus&&(e.eq(a).addClass(b),k.isEnd||i.eq(a).addClass(b))):h.removeClass("js-playing"),f.length>0&&(f.removeClass(c),a>-1&&(f.eq(a).addClass(c),a>0&&(k.scrollEvent({$li:f,$wrap:d(".sentence-navigation"),timmer:"asideTimmer",scroll:"asideScroll",delayScroll:"asideDelayScroll",curIndex:a}),"full"==k.playType&&k.scrollEvent({$li:e,$wrap:d(".listen-original-cont"),timmer:"lrcTimmer",scroll:"lrcScroll",delayScroll:"lrcDelayScroll",curIndex:a})))),this.status.originEnShow&&this.showLrc(!0)},saveVolume:function(a){void 0!=a&&d.cookie("toefl_player_volume",a,{expires:3650,path:"/"})},initVolume:function(){var a=d.cookie("toefl_player_volume")||.8;return this.$ele.jPlayer("volume",a),a},_volumeEvent:function(){var a=this;return d(a.listOptions.cssSelector.volumeCont).off("click").on("click",function(a){var b=d(this);return b.hasClass("active")?b.removeClass("active"):b.addClass("active"),!1}),a},writePannelEvent:function(){var a=this,b=d(this.options.cssSelectorAncestor),c=d(this.selector.originalMain);1==this.listOptions.listenType&&(d(document).on("keyup",function(b){switch(b.keyCode){case 32:a._hideBeginPage();break;case 219:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;a.nextPlay.call(a,!0),a._hideBeginPage();break;case 221:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;a.nextPlay.call(a),a._hideBeginPage();break;case 220:break;case 190:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;a.offsetTime(a.status.forwardTime),a._hideBeginPage();break;case 188:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;a.offsetTime(-a.status.backwardTime),a._hideBeginPage();break;case 189:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;var e=a.current.sentence,f=d(".js-listen-sentence").eq(e),g=f.find(".js-sentence-transition .transition-text"),h=d(".translation-box").eq(e),i=h.parent(".paragraph-sentence").find(".switch-translation"),j=h.css("display");"block"==j?(h.hide(),i.removeClass("active")):(h.show(),i.addClass("active")),f.hasClass("translation")?(f.removeClass("translation").addClass("hide-translation"),g.text("显示译文")):(f.addClass("translation").removeClass("hide-translation"),g.text("隐藏译文"));break;case 187:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;var e=a.current.sentence,f=d(".js-listen-sentence").eq(e),k=d(".origin-hide").eq(e),l=d(".paragraph-sentence").eq(e),j=k.css("display"),m=f.find(".js-sentence-origin .transition-text");"block"==j?(k.hide(),k.parents(".js-orgin-content").addClass("original"),l.addClass("original"),l.find(".origin-action-buttons").addClass("active")):(k.show(),k.parents(".js-orgin-content").removeClass("original"),l.removeClass("original"),l.find(".origin-action-buttons").removeClass("active")),f.hasClass("original")?(f.removeClass("original").addClass("hide-original"),m.text("显示原文")):(f.removeClass("hide-original").addClass("original"),m.text("隐藏原文"));break;case 191:var c=sessionStorage.getItem("hasNoteDialog");if(c&&"true"==c)return;a.refreshPlay.call(a)}}),b.delegate(this.selector.initialStart,"click",function(){sessionStorage.setItem("is_pause",!1),a.play.call(a),a.$ele.trigger("changePlay"),a.status.startWriteTime=(new Date).getTime()}),b.delegate(this.selector.selectBtn,"click",function(){sessionStorage.setItem("is_pause",!1);var b=d(this).data("type");b!=a.playType&&("full"==b?d(".js-origin-main").removeClass("sentence").addClass("full"):d(".js-origin-main").removeClass("full").addClass("sentence"),a.initPlayType(b))}),b.delegate(this.selector.nextAudio,"click",function(){sessionStorage.setItem("is_pause",!1),d(this).hasClass("disable")||a.cardAnimate&&(a.cardAnimate=!1,a.curAudioPlayTimes=0,a.current.sentence++,a._originalAnimate(),d(a.selector.prevAudio).removeClass("disable"))}),b.delegate(this.selector.prevAudio,"click",function(){sessionStorage.setItem("is_pause",!1),d(this).hasClass("disable")||a.cardAnimate&&(a.cardAnimate=!1,a.curAudioPlayTimes=0,a.current.sentence--,a._originalAnimate(),d(a.selector.nextAudio).removeClass("disable"))}),b.delegate(this.selector.pannelLrc,"click",function(){c.hasClass("original")?(c.removeClass("original"),d(this).removeClass("original"),a.setting("originDisplay",!1),d(".paragraph-sentence").removeClass("original"),d(".origin-action-buttons").removeClass("active"),d(".orgin-content").removeClass("original"),d(a.selector.hideBox).show(),d(a.selector.originPlayIcon).hide(),d(".origin-hide-box").show(),d(a.selector.sentenceList).removeClass("original").addClass("hide-original"),d(".js-sentence-origin .transition-text").text("显示原文")):(c.addClass("original"),d(this).addClass("original"),a.setting("originDisplay",!0),d(".paragraph-sentence").addClass("original"),d(".origin-action-buttons").addClass("active"),d(".orgin-content").addClass("original"),d(a.selector.hideBox).hide(),d(a.selector.originPlayIcon).show(),d(".origin-hide-box").hide(),d(a.selector.sentenceList).removeClass("hide-original").addClass("original"),d(".js-sentence-origin .transition-text").text("隐藏原文"))}),d(this.selector.noplayingIcon).on("click",function(b){sessionStorage.setItem("is_pause",!1);for(var c=d(a.selector.miniPlay),e=d(this).closest(".lrc-sentence").data("index"),f=0;f<a.size;f++){var g=c.eq(f);if(e==g.data("index")){g.click();break}}return!1}),d(this.selector.fullDbl).on("click",function(){var a=d(this),b=a.closest(".origin-hide-box"),c=a.closest(".paragraph-sentence"),e=b.find(".origin-hide"),f=b.find(".playing-style");e.hide(),f.hide(),b.hide(),c.find(".origin-action-buttons").addClass("active"),c.addClass("original"),c.find(".origin-play-icon").show()}))},initPlayType:function(a){var b=this,c=d(this.options.cssSelectorAncestor),e=this.listOptions.cssSelector.playType;b.changeType.call(b,a,function(){b.updateUI(a)}),c.find(e).each(function(){if(d(this).data("type")===a)return d(this).siblings(".current").removeClass("current"),d(this).addClass("current"),!1})},changeType:function(a,b){this.playType=a,"full"==this.playType?(d(this.selector.loopBtn).hide(),d(this.selector.refreshBtn).show()):"sentence"==this.playType&&(d(this.selector.refreshBtn).hide(),d(this.selector.loopBtn).show()),"function"==typeof b&&b()},updateUI:function(a){var b=this;"full"===a?(d(b.selector.sentenceBox).hide(),d(b.selector.listenBox).show(),b.playing?(d(b.selector.fullBegin).hide(),d(b.selector.allPage).show()):b.setMedia(b.playList[0].filePath)):"sentence"===a&&(b.current.sentence<0&&(b.current.sentence=0),d(b.selector.listenBox).hide(),d(b.selector.sentenceBox).show(),b.playing?(d(b.selector.sentenceBegin).hide(),this._switchSentence(),d(b.selector.sentencePage).show()):b._updateProcess()),b.playing&&(b.pause(),b.changeProcess(a))},_updateProcess:function(){var a=this,b=d(a.selector.sentenceList).eq(a.current.sentence).data("type"),c=d(a.selector.sentenceList).eq(a.current.sentence).data("url");return a.listOptions.sentencePlayObj[b]=c,a.setMedia(a.listOptions.sentencePlayObj),a},changeProcess:function(a){var b=this,c=this.current.sentence,e=d(this.selector.sentenceList).eq(c),f=e.data("url"),g=e.data("type"),h=d(this.selector.sideSentence).eq(c).data("time");d(this.selector.sideSentence).eq(c+1).data("time");if("full"==a){var i=this.playerStatus.currentTime+Number(h);this.setMedia(b.playList[0].filePath),this.play(i)}else{var j=this.playerStatus.currentTime-h,k={};j=j<0?0:j,k[g]=f,this.setMedia(k),this.play(j)}},_switchSentence:function(){var a=d(".js-listen-sentence"),b=d(".js-listen-sentences"),c=a.size(),e=this,a=a.eq(0),f=a.outerWidth();return b.css("width",f*c),b.css("left",-f*this.current.sentence),e},_hideBeginPage:function(){var a=this;if("full"==this.playType){var b=d(a.selector.fullBegin).css("display");"block"==b?(d(a.selector.fullBegin).hide(),d(a.selector.allPage).show()):d(a.selector.listenBox).show()}else{var b=d(a.selector.sentenceBegin).css("display");"block"==b?(d(a.selector.sentenceBegin).hide(),d(a.selector.sentencePage).show()):d(a.selector.sentenceBox).show()}return a},_hideOrigin:function(){var a=this;return d(a.selector.originContent).on("click",function(b){if(!d(a.selector.originalMain).data("word")){var c=d(this),e=c.closest(".paragraph-sentence"),f=e.find(".orgin-content"),g=e.find(".origin-hide");return c.find(".show-transition").hide(),e.find(".origin-action-buttons").removeClass("active"),f.removeClass("original"),e.removeClass("original"),g.show(),g.parents(".origin-hide-box").show(),d(a.selector.originPlayIcon).hide(),!1}}),a},_showSTransition:function(){var a=this;d(a.selector.showTransition).on("click",function(){var b=d(this),c=b.closest(a.selector.sentenceList),e=b.find(".transition-text");c.hasClass("hide-translation")?(c.removeClass("hide-translation").addClass("translation"),e.text("隐藏译文")):(c.removeClass("translation").addClass("hide-translation"),e.text("显示译文"))})},_showOrigin:function(){var a=this;d(a.selector.sentenceOrigin).on("click",function(){var b=d(this),c=b.find(".transition-text");if(!d(a.selector.originalMain).data("word")){var e=sessionStorage.getItem("hasNoteDialog");if(!e||"true"!=e){var f=a.current.sentence,g=d(".js-listen-sentence").eq(f);g.hasClass("original")?(g.removeClass("original").addClass("hide-original"),c.text("显示原文")):(g.removeClass("hide-original").addClass("original"),c.text("隐藏原文"))}}})},_sentenceHideOrigin:function(){var a=this;d(a.selector.sentenceOriginText).on("click",function(){var b=d(this),c=b.parents(".listen-sentence-list").find(".js-sentence-origin .transition-text"),e=a.current.sentence;d(".js-listen-sentence").eq(e).removeClass("hide-original").addClass("original"),c.text("隐藏原文")})},_totalLog:function(a){var b=this;if(!b.bLogin)return b;var c=d(b.selector.sentenceList).eq(a),e=c.data("id"),f=(c.data("url"),b.playList[0].sentence[a].audio_time),g={at:f,type:1,source:d("#js-question_source").val(),qid:d("#js-question_id").val(),lid:e,version:d(b.selector.version).val(),u:b.unique};return d.post(b.listOptions.logUrl,g,function(a){var b=(a.status,a.result,a.message);1!=a.status&&console.warn("warn: ",b)},"json"),b},_totalComplete:function(){var a=this,b=d('.pl-sentence[data-status="1"]').size(),c=b<a.size-1;return a.bComplate||!a.bLogin||c?a:(d.post(a.listOptions.completeUrl,{qid:d("#target_id").val(),exam_unique:a.unique,source:d("#js-question_source").val(),listen_type:d("#js-listenType").val(),version:d(a.selector.version).val()},function(b){0==b.status&&alert(b.result),1!=b.status&&1!=b.status||(a.bComplate=!0)},"json"),a)},_sendGrowth:function(){var a=this,b=d('.pl-sentence[data-status="1"]').size(),c=.8*a.size,e={type:1,qid:d("#js-question_id").val(),d:a.status.hasWriteTime/1e3,t:a.size};return b<c||a.bGrowth||!a.bLogin?a:(d.post("/ajax/ajaxlistenstatus",e,function(b){var c=b.status;b.result,b.message,1==c&&(a.bGrowth=!0)},"json"),a)},updateWriteTypeUI:function(b){var c,e,f,g=a("new_toefl/tpl/newplayer/write-operate-l.tpl"),h=".js-btn-over",i=(this.playType,this.playType),j=this.current[i]<0?0:this.current[i],k=template.compile(g),l=d(this.options.cssSelectorAncestor),m=this.selector.pannelStatusW;f="number"==typeof b?b:!this.hasLrc||this.writeStatus[j]?3:1,c={writeStatus:f,isEnd:!this.playList[this.curAudio][i][j+1],overUrl:d(h).attr("href")},e=k(c),l.find(m).html(e)},setting:function(a,b,c){"object"==typeof a?d.extend(this.status,a):void 0!=b?(this.status[a]=b,"function"==typeof c&&c()):console&&console.log&&console.log("%c设置失败！请检查setting方法!","color:#f30;font-size:12px;")},setPlayerStatus:function(a){this.playerStatus=a.jPlayer.status},offsetTime:function(a){var b,c,d,e,f,g,h=.3,i=this;b=this.playType,c=this.playList[this.curAudio],d=c[b][this.current[b]]?c[b][this.current[b]].start_time:c[b][this.current[0][b]].start_time,e=c[b][this.current[b]]?c[b][this.current[b]].audio_time:c[b][this.current[0][b]].audio_time,f=Number(d)+Number(e),g=this.playerStatus.currentTime+a,"sentence"==b?(g=g<0?0:g,g=g>=e-h?0:g,0==g?(this.curAudioPlayTimes++,i.loopTimes<=i.curAudioPlayTimes?i.curAudioPlayTimes=0:this.play(g)):this.play(g)):(g=g<d?d:g,g=g>=f-h?d:g,this.play(g))},inCurParagraph:function(a){var b,c,a,d,e,f=this.playType;return"paragraph"===f&&(b=this.current.paragraph,c=this.playList[this.curAudio][f][b],a=Number(a),d=Number(c.start_time),e=d+Number(c.audio_time),a<e&&a>=d)}},d.extend(e.prototype,{isCanSendRequest:function(){var a=this,b=(d(".play-model a.current").attr("data-type"),0),c=0,e=0;if(b=1,e=a.totalWriteTime,c=a.status.hasWriteTime/1e3,a.status.isBigListen80Percent=c/e>.8,(e>0&&c>3*e&&c<4*e||3==a.status.beginNum)&&(a.status.beginNum=3,d(a.selector.originalSuggest).removeClass("first").addClass("more"),d.cookie("toefl_intensive_"+this.questionId,a.status.beginNum)),(e>0&&c>4*e||a.status.beginNum>=4)&&(a.status.beginNum=4,d(a.selector.originalSuggest).removeClass("more first").addClass("other"),d.cookie("toefl_intensive_"+this.questionId,a.status.beginNum)),e>0&&a.status.isBigListen80Percent&&!a.status.bPercent){if(!a.loginState)return;a.status.beginNum=1,a.status.bPercent=!0,d.post("/ajax/ajaxlistenstatus",{type:b,qid:d("#js-question_id").val(),d:c,t:e},function(a){},"json"),d.cookie("toefl_intensive_"+this.questionId,a.status.beginNum),a.totalComplete()}},initialiseEvent:function(){var a,b,c,e,f=this,g=this.fixFlash_mp4,h=d(this.options.cssSelectorAncestor);b=this.selector.next,c=this.selector.prev,e=this.selector.pannelRepeatW,this.$ele.on(d.jPlayer.event.loadedmetadata,function(a){d(f.listOptions.cssSelector.totalTime).text(d.jPlayer.convertTime(a.jPlayer.status.duration))}),this.$ele.on(d.jPlayer.event.timeupdate,function(a){var b=Number(d(".js-speed-detail").html())||1;if(a.jPlayer.status.isSeeked?(f.updateCurrent(a),f.breakPoint(a)):(f.breakPoint(a),f.updateCurrent(a)),f.setPlayerStatus(a),f.updateInterface(),f.status.startWriteTime){var c=f.status.startWriteTime,e=(new Date).getTime(),g=(new Date).getTime();f.status.hasWriteTime+=(g-c)*b,f.status.startWriteTime=e}}),this.$ele.on(d.jPlayer.event.ended,function(a){this.nextPreBool=!1;d(f.listOptions.cssSelector.playProgress).slider("value",0);var b=f.current.sentence;"sentence"==f.playType?(f.curAudioPlayTimes++,1!=f.loopTimes&&(1e3==f.loopTimes?f.fullPause=setTimeout(function(){var a=sessionStorage.getItem("is_pause");a="false"==a?0:1,a?(clearTimeout(f.fullPause),f.fullPause=null):f.play()},1e3*f.sideSpace):f.loopTimes<=f.curAudioPlayTimes?f.curAudioPlayTimes=0:f.fullPause=setTimeout(function(){var a=sessionStorage.getItem("is_pause");a="false"==a?0:1,a?(clearTimeout(f.fullPause),f.fullPause=null):f.play()},1e3*f.sideSpace))):f._dataStatistics(b);var c=Number(d(".js-speed-detail").html())||1;f.breakPoint(a,!0),f.status.FinishWriteTime=(new Date).getTime(),f.status.EndWriteTime=(new Date).getTime(),f.status.hasWriteTime+=(f.status.FinishWriteTime-f.status.startWriteTime)*c}),h.delegate(b,"click",function(){f.nextPlay.call(f)}),h.delegate(c,"click",function(){f.nextPlay.call(f,!0)}),h.delegate(this.selector.forward,"click",function(){var a=f.status;f.offsetTime(a.forwardTime)}),h.delegate(e,"click",function(){f.refreshPlay.call(f)}),h.delegate(this.selector.backward,"click",function(){var a=f.status;f.offsetTime(-a.backwardTime)}),h.delegate(this.selector.miniPlay,"click",function(){sessionStorage.setItem("is_pause",!1);var a=d(this),b=a.data("index");if(f.curAudioPlayTimes=0,f.current.sentence=b,"full"==f.playType){var c=a.data("time");f.play(c),f.scrollEvent({$li:d(".lrc-sentence"),$wrap:d(".listen-original-cont"),timmer:"lrcTimmer",scroll:"lrcScroll",delayScroll:"lrcDelayScroll",curIndex:f.current.sentence})}else"sentence"==f.playType&&(d(f.selector.miniPlay).removeClass("current"),d(this).addClass("current"),f._originalAnimate())}),d(this.selector.playProgress).slider({animate:"fast",max:100,range:"min",step:.1,value:0,slide:function(b,c){var e=f.$ele.data("jPlayer").status.seekPercent;e>0?(g&&(ignore_timeupdate=!0,clearTimeout(a),a=setTimeout(function(){ignore_timeupdate=!1},1e3)),f.$ele.jPlayer("playHead",c.value*(100/e)),f.$ele.jPlayer("setSeek",!0)):setTimeout(function(){d(f.listOptions.cssSelector.playProgress).slider("value",0)},0)}}),d(this.selector.volume).slider({animate:"fast",max:1,range:"min",orientation:"vertical",step:.01,value:f.initVolume(),slide:function(a,b){f.$ele.jPlayer("option","muted",!1),f.$ele.jPlayer("option","volume",b.value),f.saveVolume(b.value)}}),this.writePannelEvent(),this.rateEvent(),this.pauseTimeEvent(),this._volumeEvent(),this.loopTimeEvent(),d(".sentence-navigation").scroll(function(){f.status.asideScroll?(clearTimeout(f.status.asideTimmer),f.status.asideTimmer=null,f.status.asideScroll=!1):(f.delayScollTimmer&&(clearTimeout(f.delayScollTimmer),f.delayScollTimmer=null),f.status.asideDelayScroll=!0,f.delayScollTimmer=setTimeout(function(){f.status.asideDelayScroll=!1},4e3))}),d(".listen-original-cont").scroll(function(){d(this).addClass("scroll"),f.status.lrcScroll?(clearTimeout(f.status.lrcTimmer),f.status.lrcTimmer=null,f.status.lrcScroll=!1):(f.delayLrcScollTimmer&&(clearTimeout(f.delayLrcScollTimmer),f.delayLrcScollTimmer=null),f.status.lrcDelayScroll=!0,f.delayLrcScollTimmer=setTimeout(function(){f.status.lrcDelayScroll=!1},4e3))}),this.playStatusEvent(),this.selectTimeEvent(),h.on("click",this.selector.originDisplay,function(){var a="is-show-original",b="is-hide-original";f.status.originDisplay?(d(this).addClass(b).removeClass(a),f.setting("originDisplay",!1),f.hideLrc()):(d(this).addClass(a).removeClass(b),f.setting("originDisplay",!0),f.showLrc())})},hideLrc:function(){var a=d(this.listOptions.cssSelector.lrcBody),b=d(this.options.cssSelectorAncestor),c=b.find(this.listOptions.cssSelector.lrcEnter),e=b.find(this.listOptions.cssSelector.lrcEn),f=this.listOptions.cssSelector.pannelLrc,g=this.playType;if(!(a.lenght<1)){if(this.setting("originEnShow",!1),b.find(f+" i").text("显示原文"),"write"==g)return this.hideWriteLrc(),this.status.originCnShow||a.hide(),a.find(e).hide(),void a.find(".js-paragraph-sn").hide();b.find(e).hide(),this.status.originCnShow||(b.find(c).show(),a.hide())}},selectTimeEvent:function(){var a=this,b=d(a.selector.udBtn),c=d(a.selector.udTime);return b.on("click",function(){var b=d(this),c=b.closest(a.selector.audioUd);return c.hasClass("active")?c.removeClass("active"):c.addClass("active"),!1}),c.on("click",function(){var b=d(this),c=b.data("num"),e=b.closest(a.selector.audioUd),f=e.find(".ud-time-msg");return e.hasClass("audio-forward")?a.status.forwardTime=c:a.status.backwardTime=c,f.text(c),e.removeClass("active"),!1}),a},playStatusEvent:function(){var a=d(this.options.cssSelectorAncestor),b=a.find(".js-play-status"),c=a.find(".icon-player"),e="icon-playing",f=this;this.$ele.on(d.jPlayer.event.play,function(){f.setting("playStatus",!0),f.playing=!0,f.playing&&f._hideBeginPage(),f.isBegin=!1,f.isBreak=!1,b.addClass(e),f.status.startWriteTime=(new Date).getTime()}),this.$ele.on(d.jPlayer.event.pause,function(a){var g=Number(d(".js-speed-detail").html())||1;b.removeClass(e),c.removeClass("lrc-sentence-current"),f.isBreak=!0,f.status.EndWriteTime=(new Date).getTime(),f.status.hasWriteTime+=(f.status.EndWriteTime-f.status.startWriteTime)*g,f.status.startWriteTime=f.status.EndWriteTime})},rateEvent:function(){var a=this,b=d(this.options.cssSelectorAncestor),c=this.selector.playRate,e=this.selector.speedDetail,f=b.find(c),g=b.find(this.selector.rateSubmenu),h=f.find(e);f.off("click").on("click",function(a){var b=d(this);return b.hasClass("active")?b.removeClass("active"):b.addClass("active"),!1}),g.on("click","li",function(b){var c=d(this),e=c.data("num").toFixed(1);return h.text(e),a.setPlayRate.call(a,e),f.removeClass("active"),!1})},pauseTimeEvent:function(){var a=this,b=d(this.options.cssSelectorAncestor),c=this.selector.pauseTime,e=b.find(c),f=d(".js-pause-detail"),g=d(".js-pause-lists");e.off("click").on("click",function(a){var b=d(this);return b.hasClass("active")?b.removeClass("active"):b.addClass("active"),!1}),g.on("click","li",function(b){var c=d(this),g=c.data("num").toFixed(0)+"S";return c.addClass("active").siblings().removeClass("active"),g="0S"==g?"关":g,f.text(g),a.sideSpace=parseInt(c.data("num")),e.removeClass("active"),!1})},loopTimeEvent:function(){var a=this,b=d(this.options.cssSelectorAncestor),c=this.selector.loopEvent,e=b.find(c),f=e.find(".loop-text"),g=e.find(".loop-icon"),h=d(".loop-lists");e.on("click",function(a){var b=d(this),c=b.closest(".loop-current");return c.hasClass("active")?(c.removeClass("active"),g.removeClass("active")):(c.addClass("active"),g.addClass("active")),!1}),h.on("click","li",function(b){var c=d(this),h=c.text();return a.curAudioPlayTimes=0,f.text(h),a.loopTimes=c.data("loop"),1==a.loopTimes?(g.removeClass("times-loop"),g.addClass("no-loop")):(g.removeClass("no-loop"),g.addClass("times-loop")),e.closest(".loop-current").removeClass("active"),e.find(".loop-icon").removeClass("active"),!1})},scrollEvent:function(a){var b=a.$li.eq(a.curIndex).position();if(b){var c=a.$wrap,e=c.outerHeight(),f=c.scrollTop(),g=b.top,h=this;h.status[a.delayScroll]||(c.hasClass("listen-original-cont")?(f>0&&d(".listen-original-cont").addClass("scroll"),h.status[a.timmer]&&(clearTimeout(h.status[a.timmer]),h.status[a.timmer]=null,h.status[a.scroll]=!1),h.status[a.scroll]=!0,c.stop(!0,!1).animate({scrollTop:g-e/2+h.scrollVar},300,function(){h.status[a.timmer]=setTimeout(function(){h.status[a.scroll]=!1},100)})):(h.status[a.timmer]&&(clearTimeout(h.status[a.timmer]),h.status[a.timmer]=null,h.status[a.scroll]=!1),h.status[a.scroll]=!0,c.stop(!0,!1).animate({scrollTop:g-e/2+304},300,function(){h.status[a.timmer]=setTimeout(function(){h.status[a.scroll]=!1},100)})))}}}),c.exports=function(a,b,c){return new e(a,b,c)}}),define("new_toefl/js/mod/cursor",[],function(a,b,c){var d={get:function(a){var b={text:"",start:0,end:0};a.value;if(a.setSelectionRange)a.focus(),b.start=a.selectionStart,b.end=a.selectionEnd,b.text=a.value.substring(b.start,b.end);else if(document.selection){a.focus();var c,d=document.selection.createRange(),e=document.body.createTextRange();for(e.moveToElementText(a),b.text=d.text,b.bookmark=d.getBookmark(),c=0;e.compareEndPoints("StartToStart",d)<0&&0!==d.moveStart("character",-1);c++)"/r"==a.value.charAt(c)&&c++;b.start=c,b.end=c+b.text.length}return b},set:function(a,b){var c;b||alert("You must get cursor position first."),a.focus(),a.setSelectionRange?a.setSelectionRange(b.start,b.end):a.createTextRange&&(c=a.createTextRange(),a.value.length===b.start?(c.collapse(!1),c.select()):(c.moveToBookmark(b.bookmark),c.select()))},add:function(a,b,c){var d,e,f,g,h;this.set(a,b),a.setSelectionRange?(d=a.value,e=d.substring(0,b.start)+c+d.substring(b.end),g=h=b.start+c.length,a.scrollTop,a.value=e,a.setSelectionRange(g,h)):a.createTextRange&&(f=document.selection.createRange(),f.text=c,f.setEndPoint("StartToEnd",f),f.select())},insertText:function(a,b,c){a.focus();var d=b.start+1,e=b.start+5;if(a.setSelectionRange)a.setSelectionRange(d,e);else{var f=document.body.createTextRange();f.moveToElementText(a),f.moveStart("character",d),f.moveEnd("character",-(a.value.length-d-4)),f.select()}},setCursorPos:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}};c.exports=d}),define("new_toefl/js/mod/player/write_scrollto",["jquery"],function(a,b,c){var d=a("jquery");c.exports=function(a){var b,c,e,f,g,h,i,j={$ele:null,sParent:".player-article"};b=d.extend({},j,a),e=d(b.sParent),c=b.$ele,c.length<1||(f=c.position().top,g=c.outerHeight(),h=e.outerHeight(),curScrollTop=e.scrollTop(),i=f+g+curScrollTop-h/2,(f<10||f+g>h)&&i>0&&e.scrollTop(i))}}),define("new_toefl/js/plugin/jquery-jplayer",[],function(a,b,c){!function(a,b){b(a.jQuery?a.jQuery:a.Zepto)}(this,function(a,b){a.fn.jPlayer=function(c){var d="jPlayer",e="string"==typeof c,f=Array.prototype.slice.call(arguments,1),g=this;return c=!e&&f.length?a.extend.apply(null,[!0,c].concat(f)):c,e&&"_"===c.charAt(0)?g:(e?this.each(function(){var e=a(this).data(d),h=e&&a.isFunction(e[c])?e[c].apply(e,f):e;if(h!==e&&h!==b)return g=h,!1}):this.each(function(){var b=a(this).data(d);b?b.option(c||{}):a(this).data(d,new a.jPlayer(c,this))}),g)},a.jPlayer=function(b,c){if(arguments.length){this.element=a(c),this.options=a.extend(!0,{},this.options,b);var d=this;this.element.bind("remove.jPlayer",function(){d.destroy()}),this._init()}},"function"!=typeof a.fn.stop&&(a.fn.stop=function(){}),a.jPlayer.emulateMethods="load play pause",a.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",a.jPlayer.emulateOptions="muted volume",a.jPlayer.reservedEvent="ready flashreset resize repeat error warning",a.jPlayer.event={},a.each(["ready","setmedia","flashreset","resize","repeat","click","error","warning","loadstart","progress","suspend","abort","emptied","stalled","play","pause","loadedmetadata","loadeddata","waiting","playing","canplay","canplaythrough","seeking","seeked","timeupdate","ended","ratechange","durationchange","volumechange"],function(){a.jPlayer.event[this]="jPlayer_"+this}),a.jPlayer.htmlEvent=["loadstart","abort","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough"],a.jPlayer.pause=function(){a.each(a.jPlayer.prototype.instances,function(a,b){b.data("jPlayer").status.srcSet&&b.jPlayer("pause")})},a.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""};var c=function(){this.init()};c.prototype={init:function(){this.options={timeFormat:a.jPlayer.timeFormat}},time:function(a){a=a&&"number"==typeof a?a:0;var b=new Date(1e3*a),c=b.getUTCHours(),d=this.options.timeFormat.showHour?b.getUTCMinutes():b.getUTCMinutes()+60*c,e=this.options.timeFormat.showMin?b.getUTCSeconds():b.getUTCSeconds()+60*d,f=this.options.timeFormat.padHour&&c<10?"0"+c:c,g=this.options.timeFormat.padMin&&d<10?"0"+d:d,h=this.options.timeFormat.padSec&&e<10?"0"+e:e,i="";return i+=this.options.timeFormat.showHour?f+this.options.timeFormat.sepHour:"",i+=this.options.timeFormat.showMin?g+this.options.timeFormat.sepMin:"",i+=this.options.timeFormat.showSec?h+this.options.timeFormat.sepSec:""}};var d=new c;a.jPlayer.convertTime=function(a){return d.time(a)},a.jPlayer.uaBrowser=function(a){var b=a.toLowerCase(),c=/(webkit)[ \/]([\w.]+)/,d=/(opera)(?:.*version)?[ \/]([\w.]+)/,e=/(msie) ([\w.]+)/,f=/(mozilla)(?:.*? rv:([\w.]+))?/,g=c.exec(b)||d.exec(b)||e.exec(b)||b.indexOf("compatible")<0&&f.exec(b)||[];return{browser:g[1]||"",version:g[2]||"0"}},a.jPlayer.uaPlatform=function(a){var b=a.toLowerCase(),c=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/,d=/(ipad|playbook)/,e=/(android)/,f=/(mobile)/,g=c.exec(b)||[],h=d.exec(b)||!f.exec(b)&&e.exec(b)||[];return g[1]&&(g[1]=g[1].replace(/\s/g,"_")),{platform:g[1]||"",tablet:h[1]||""}},a.jPlayer.browser={},a.jPlayer.platform={};var e=a.jPlayer.uaBrowser(navigator.userAgent);e.browser&&(a.jPlayer.browser[e.browser]=!0,a.jPlayer.browser.version=e.version);var f=a.jPlayer.uaPlatform(navigator.userAgent);f.platform&&(a.jPlayer.platform[f.platform]=!0,a.jPlayer.platform.mobile=!f.tablet,a.jPlayer.platform.tablet=!!f.tablet),a.jPlayer.getDocMode=function(){var b;return a.jPlayer.browser.msie&&(document.documentMode?b=document.documentMode:(b=5,document.compatMode&&"CSS1Compat"===document.compatMode&&(b=7))),b},a.jPlayer.browser.documentMode=a.jPlayer.getDocMode(),a.jPlayer.nativeFeatures={init:function(){var a,b,c,d=document,e=d.createElement("video"),f={w3c:["fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror"],moz:["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],webkit:["","webkitCurrentFullScreenElement","webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange",""],webkitVideo:["webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitEnterFullscreen","webkitExitFullscreen","",""]},g=["w3c","moz","webkit","webkitVideo"];for(this.fullscreen=a={support:{w3c:!!d[f.w3c[0]],moz:!!d[f.moz[0]],webkit:"function"==typeof d[f.webkit[3]],webkitVideo:"function"==typeof e[f.webkitVideo[2]]},used:{}},b=0,c=g.length;b<c;b++){var h=g[b];if(a.support[h]){a.spec=h,a.used[h]=!0;break}}if(a.spec){var i=f[a.spec];a.api={fullscreenEnabled:!0,fullscreenElement:function(a){return a=a||d,a[i[1]]},requestFullscreen:function(a){return a[i[2]]()},exitFullscreen:function(a){return a=a||d,a[i[3]]()}},a.event={fullscreenchange:i[4],fullscreenerror:i[5]}}else a.api={fullscreenEnabled:!1,fullscreenElement:function(){return null},requestFullscreen:function(){},exitFullscreen:function(){}},a.event={}}},a.jPlayer.nativeFeatures.init(),a.jPlayer.focus=null,a.jPlayer.keyIgnoreElementNames="INPUT TEXTAREA";var g=function(b){var c,d=a.jPlayer.focus;d&&(a.each(a.jPlayer.keyIgnoreElementNames.split(/\s+/g),function(a,d){if(b.target.nodeName.toUpperCase()===d.toUpperCase())return c=!0,!1}),c||a.each(d.options.keyBindings,function(c,e){if(e&&b.which===e.key&&a.isFunction(e.fn))return b.preventDefault(),e.fn(d),!1}))};a.jPlayer.keys=function(b){var c="keydown.jPlayer";a(document.documentElement).unbind(c),b&&a(document.documentElement).bind(c,g)},a.jPlayer.keys(!0),a.jPlayer.prototype={count:0,version:{script:"2.6.1",needFlash:"2.6.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",preload:"metadata",volume:.8,muted:!1,remainingDuration:!1,toggleDuration:!1,captureDuration:!0,playbackRate:1,defaultPlaybackRate:1,minPlaybackRate:.5,maxPlaybackRate:4,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",playbackRateBar:".jp-playback-rate-bar",playbackRateBarValue:".jp-playback-rate-bar-value",currentTime:".jp-current-time",duration:".jp-duration",title:".jp-title",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},smoothPlayBar:!1,fullScreen:!1,fullWindow:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1e3},loop:!1,repeat:function(b){b.jPlayer.options.loop?a(this).unbind(".jPlayerRepeat").bind(a.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){a(this).jPlayer("play")}):a(this).unbind(".jPlayerRepeat")},nativeVideoControls:{},noFullWindow:{msie:/msie [0-6]\./,ipad:/ipad.*?os [0-4]\./,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3]\.(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,iemobile:/iemobile/,webos:/webos/,playbook:/playbook/},timeFormat:{},keyEnabled:!1,audioFullScreen:!1,keyBindings:{play:{key:32,fn:function(a){a.status.paused?(sessionStorage.setItem("is_pause",!1),a.play()):(sessionStorage.setItem("is_pause",!0),a.pause())}},fullScreen:{key:13,fn:function(a){(a.status.video||a.options.audioFullScreen)&&a._setOption("fullScreen",!a.options.fullScreen)}},muted:{key:8,fn:function(a){a._muted(!a.options.muted)}},volumeUp:{key:38,fn:function(a){a.volume(a.options.volume+.1)}},volumeDown:{key:40,fn:function(a){a.volume(a.options.volume-.1)}}},verticalVolume:!1,verticalPlaybackRate:!1,globalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,consoleAlerts:!0,errorAlerts:!1,warningAlerts:!1,seekDisable:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,remaining:0,videoWidth:0,videoHeight:0,readyState:0,networkState:0,playbackRate:1,ended:0,isSeeked:!1},internal:{ready:!1},solution:{html:!0,flash:!0},format:{mp3:{codec:'audio/mpeg; codecs="mp3"',flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},m3u8a:{codec:'application/vnd.apple.mpegurl; codecs="mp4a.40.2"',flashCanPlay:!1,media:"audio"},m3ua:{codec:"audio/mpegurl",flashCanPlay:!1,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis, opus"',flashCanPlay:!1,media:"audio"},flac:{codec:"audio/x-flac",flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},rtmpa:{codec:'audio/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},m3u8v:{codec:'application/vnd.apple.mpegurl; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!1,media:"video"},m3uv:{codec:"audio/mpegurl",flashCanPlay:!1,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"},rtmpv:{codec:'video/rtmp; codecs="rtmp"',flashCanPlay:!0,media:"video"}},_init:function(){var c=this;if(this.element.empty(),this.status=a.extend({},this.status),this.internal=a.extend({},this.internal),this.options.timeFormat=a.extend({},a.jPlayer.timeFormat,this.options.timeFormat),this.internal.cmdsIgnored=a.jPlayer.platform.ipad||a.jPlayer.platform.iphone||a.jPlayer.platform.ipod,this.internal.domNode=this.element.get(0),this.options.keyEnabled&&!a.jPlayer.focus&&(a.jPlayer.focus=this),this.androidFix={setMedia:!1,play:!1,pause:!1,time:NaN},a.jPlayer.platform.android&&(this.options.preload="auto"!==this.options.preload?"metadata":"auto"),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),a.each(this.options.supplied.toLowerCase().split(","),function(b,d){var e=d.replace(/^\s+|\s+$/g,"");if(c.format[e]){var f=!1;a.each(c.formats,function(a,b){if(e===b)return f=!0,!1}),f||c.formats.push(e)}}),a.each(this.options.solution.toLowerCase().split(","),function(b,d){var e=d.replace(/^\s+|\s+$/g,"");if(c.solution[e]){var f=!1;a.each(c.solutions,function(a,b){if(e===b)return f=!0,!1}),f||c.solutions.push(e)}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=a.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=a.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:b}),this.internal.video=a.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:b}),this.internal.flash=a.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:b,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"Jplayer.swf":"")}),this.internal.poster=a.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:b}),a.each(a.jPlayer.event,function(a,d){c.options[a]!==b&&(c.element.bind(d+".jPlayer",c.options[a]),c.options[a]=b)}),this.require.audio=!1,this.require.video=!1,a.each(this.formats,function(a,b){c.require[c.format[b].media]=!0}),this.require.video?this.options=a.extend(!0,{},this.optionsVideo,this.options):this.options=a.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this.status.noVolume=this._uaBlocklist(this.options.noVolume),a.jPlayer.nativeFeatures.fullscreen.api.fullscreenEnabled&&this._fullscreenAddEventListeners(),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){c.status.video&&!c.status.waitForPlay||c.internal.poster.jq.show()},this.element.append(this.htmlElement.poster),this.internal.poster.jq=a("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){c._trigger(a.jPlayer.event.click)}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10.1),this.html.canPlay={},this.flash.canPlay={},a.each(this.formats,function(a,b){c.html.canPlay[b]=c.html[c.format[b].media].available,c.flash.canPlay[b]=c.format[b].flashCanPlay&&c.flash.available}),this.html.desired=!1,this.flash.desired=!1,a.each(this.solutions,function(b,d){if(0===b)c[d].desired=!0;else{var e=!1,f=!1;a.each(c.formats,function(a,b){c[c.solutions[0]].canPlay[b]&&("video"===c.format[b].media?f=!0:e=!0)}),c[d].desired=c.require.audio&&!e||c.require.video&&!f}}),this.html.support={},this.flash.support={},a.each(this.formats,function(a,b){c.html.support[b]=c.html.canPlay[b]&&c.html.desired,c.flash.support[b]=c.flash.canPlay[b]&&c.flash.desired}),this.html.used=!1,this.flash.used=!1,a.each(this.solutions,function(b,d){a.each(c.formats,function(a,b){if(c[d].support[b])return c[d].used=!0,!1})}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:a.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:a.jPlayer.errorMsg.NO_SOLUTION,hint:a.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var d,e="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if(a.jPlayer.browser.msie&&(Number(a.jPlayer.browser.version)<9||a.jPlayer.browser.documentMode<9)){var f='<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0" tabindex="-1"></object>',g=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+e+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'];d=document.createElement(f);for(var h=0;h<g.length;h++)d.appendChild(document.createElement(g[h]))}else{var i=function(a,b,c){var d=document.createElement("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)};d=document.createElement("object"),d.setAttribute("id",this.internal.flash.id),d.setAttribute("name",this.internal.flash.id),d.setAttribute("data",this.internal.flash.swf),d.setAttribute("type","application/x-shockwave-flash"),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("tabindex","-1"),i(d,"flashvars",e),i(d,"allowscriptaccess","always"),i(d,"bgcolor",this.options.backgroundColor),i(d,"wmode",this.options.wmode)}this.element.append(d),this.internal.flash.jq=a(d)}this.html.used&&!this.flash.used?this.status.playbackRateEnabled=this._testPlaybackRate("audio"):this.status.playbackRateEnabled=!1,this._updatePlaybackRate(),this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=a("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=a("#"+this.internal.video.id),this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):this.internal.video.jq.css({width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){c._trigger(a.jPlayer.event.click)}))),this.options.emulateHtml&&this._emulateHtmlBridge(),this.html.used&&!this.flash.used&&setTimeout(function(){c.internal.ready=!0,c.version.flash="n/a",c._trigger(a.jPlayer.event.repeat),c._trigger(a.jPlayer.event.ready)},100),this._updateNativeVideoControls(),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),a.jPlayer.prototype.count++},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),a.each(this.css.jq,function(a,b){b.length&&b.unbind(".jPlayer")}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this._fullscreenRemoveEventListeners(),this===a.jPlayer.focus&&(a.jPlayer.focus=null),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]},enable:function(){},disable:function(){},_testCanPlayType:function(a){try{return a.canPlayType(this.format.mp3.codec),!0}catch(a){return!1}},_testPlaybackRate:function(a){var b,c=.5;a="string"==typeof a?a:"audio",b=document.createElement(a);try{return"playbackRate"in b&&(b.playbackRate=c,b.playbackRate===c)}catch(a){return!1}},_uaBlocklist:function(b){var c=navigator.userAgent.toLowerCase(),d=!1;return a.each(b,function(a,b){if(b&&b.test(c))return d=!0,!1}),d},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullWindow=!0)},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))},_addHtmlEventListeners:function(b,c){var d=this;b.preload=this.options.preload,b.muted=this.options.muted,b.volume=this.options.volume,this.status.playbackRateEnabled&&(b.defaultPlaybackRate=this.options.defaultPlaybackRate,b.playbackRate=this.options.playbackRate),b.addEventListener("progress",function(){c.gate&&(d.internal.cmdsIgnored&&this.readyState>0&&(d.internal.cmdsIgnored=!1),d.androidFix.setMedia=!1,d.androidFix.play&&(d.androidFix.play=!1,d.play(d.androidFix.time)),d.androidFix.pause&&(d.androidFix.pause=!1,d.pause(d.androidFix.time)),d._getHtmlStatus(b),d._updateInterface(),d._trigger(a.jPlayer.event.progress))},!1),b.addEventListener("timeupdate",function(){c.gate&&(d._getHtmlStatus(b),d._updateInterface(),d._trigger(a.jPlayer.event.timeupdate))},!1),b.addEventListener("durationchange",function(){c.gate&&(d._getHtmlStatus(b),d._updateInterface(),d._trigger(a.jPlayer.event.durationchange))},!1),b.addEventListener("play",function(){c.gate&&(d._updateButtons(!0),d._html_checkWaitForPlay(),d._trigger(a.jPlayer.event.play))},!1),b.addEventListener("playing",function(){c.gate&&(d._updateButtons(!0),d._seeked(),d._trigger(a.jPlayer.event.playing))},!1),b.addEventListener("pause",function(){c.gate&&(d._updateButtons(!1),d._trigger(a.jPlayer.event.pause))},!1),b.addEventListener("waiting",function(){c.gate&&(d._seeking(),d._trigger(a.jPlayer.event.waiting))},!1),b.addEventListener("seeking",function(){c.gate&&(d._seeking(),d._trigger(a.jPlayer.event.seeking))},!1),b.addEventListener("seeked",function(){c.gate&&(d._seeked(),d._trigger(a.jPlayer.event.seeked))},!1),b.addEventListener("volumechange",function(){c.gate&&(d.options.volume=b.volume,d.options.muted=b.muted,d._updateMute(),d._updateVolume(),d._trigger(a.jPlayer.event.volumechange))},!1),b.addEventListener("ratechange",function(){c.gate&&(d.options.defaultPlaybackRate=b.defaultPlaybackRate,d.options.playbackRate=b.playbackRate,d._updatePlaybackRate(),d._trigger(a.jPlayer.event.ratechange))},!1),b.addEventListener("suspend",function(){c.gate&&(d._seeked(),d._trigger(a.jPlayer.event.suspend))},!1),b.addEventListener("ended",function(){c.gate&&(a.jPlayer.browser.webkit||(d.htmlElement.media.currentTime=0),d.htmlElement.media.pause(),d._updateButtons(!1),d._getHtmlStatus(b,!0),d._updateInterface(),d._trigger(a.jPlayer.event.ended))},!1),b.addEventListener("error",function(){c.gate&&(d._updateButtons(!1),d._seeked(),d.status.srcSet&&(clearTimeout(d.internal.htmlDlyCmdId),d.status.waitForLoad=!0,d.status.waitForPlay=!0,d.status.video&&!d.status.nativeVideoControls&&d.internal.video.jq.css({width:"0px",height:"0px"}),d._validString(d.status.media.poster)&&!d.status.nativeVideoControls&&d.internal.poster.jq.show(),d.css.jq.videoPlay.length&&d.css.jq.videoPlay.show(),d._error({type:a.jPlayer.error.URL,context:d.status.src,message:a.jPlayer.errorMsg.URL,hint:a.jPlayer.errorHint.URL})))},!1),a.each(a.jPlayer.htmlEvent,function(e,f){b.addEventListener(this,function(){c.gate&&d._trigger(a.jPlayer.event[f])},!1)})},_getHtmlStatus:function(a,b){var c=0,d=0,e=0,f=0;isFinite(a.duration)&&(this.status.duration=a.duration),c=a.currentTime,d=this.status.duration>0?100*c/this.status.duration:0,"object"==typeof a.seekable&&a.seekable.length>0?(e=this.status.duration>0?100*a.seekable.end(a.seekable.length-1)/this.status.duration:100,f=this.status.duration>0?100*a.currentTime/a.seekable.end(a.seekable.length-1):0):(e=100,f=d),b&&(c=0,f=0,d=0),this.status.seekPercent=e,this.status.currentPercentRelative=f,this.status.currentPercentAbsolute=d,this.status.currentTime=c,this.status.remaining=this.status.duration-this.status.currentTime,this.status.videoWidth=a.videoWidth,this.status.videoHeight=a.videoHeight,this.status.readyState=a.readyState,this.status.networkState=a.networkState,this.status.playbackRate=a.playbackRate,this.status.ended=a.ended},_resetStatus:function(){this.status=a.extend({},this.status,a.jPlayer.prototype.status)},_trigger:function(b,c,d){var e=a.Event(b);e.jPlayer={},e.jPlayer.version=a.extend({},this.version),e.jPlayer.options=a.extend(!0,{},this.options),e.jPlayer.status=a.extend(!0,{},this.status),e.jPlayer.html=a.extend(!0,{},this.html),e.jPlayer.flash=a.extend(!0,{},this.flash),c&&(e.jPlayer.error=a.extend({},c)),d&&(e.jPlayer.warning=a.extend({},d)),this.element.trigger(e)},jPlayerFlashEvent:function(b,c){if(b===a.jPlayer.event.ready)if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var d=this.status.currentTime,e=this.status.paused;this.setMedia(this.status.media),this.volumeWorker(this.options.volume),d>0&&(e?this.pause(d):this.play(d))}this._trigger(a.jPlayer.event.flashreset)}}else this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=c.version,this.version.needFlash!==this.version.flash&&this._error({type:a.jPlayer.error.VERSION,context:this.version.flash,message:a.jPlayer.errorMsg.VERSION+this.version.flash,hint:a.jPlayer.errorHint.VERSION}),this._trigger(a.jPlayer.event.repeat),this._trigger(b);if(this.flash.gate)switch(b){case a.jPlayer.event.progress:case a.jPlayer.event.timeupdate:this._getFlashStatus(c),this._updateInterface(),this._trigger(b);break;case a.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(b);break;case a.jPlayer.event.pause:case a.jPlayer.event.ended:this._updateButtons(!1),this._trigger(b);break;case a.jPlayer.event.click:this._trigger(b);break;case a.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:a.jPlayer.error.URL,context:c.src,message:a.jPlayer.errorMsg.URL,hint:a.jPlayer.errorHint.URL});break;case a.jPlayer.event.seeking:this._seeking(),this._trigger(b);break;case a.jPlayer.event.seeked:this._seeked(),this._trigger(b);break;case a.jPlayer.event.ready:break;default:this._trigger(b)}return!1},_getFlashStatus:function(a){this.status.seekPercent=a.seekPercent,this.status.currentPercentRelative=a.currentPercentRelative,this.status.currentPercentAbsolute=a.currentPercentAbsolute,this.status.currentTime=a.currentTime,this.status.duration=a.duration,this.status.remaining=a.duration-a.currentTime,this.status.videoWidth=a.videoWidth,this.status.videoHeight=a.videoHeight,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_updateButtons:function(a){a===b?a=!this.status.paused:this.status.paused=!a,this.css.jq.play.length&&this.css.jq.pause.length&&(a?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide())),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullWindow?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&(this.options.smoothPlayBar?this.css.jq.playBar.stop().animate({width:this.status.currentPercentAbsolute+"%"},250,"linear"):this.css.jq.playBar.width(this.status.currentPercentRelative+"%"));this.css.jq.currentTime.length&&this._convertTime(this.status.currentTime)!==this.css.jq.currentTime.text()&&this.css.jq.currentTime.text(this._convertTime(this.status.currentTime));var a="",b=this.status.duration,c=this.status.remaining;this.css.jq.duration.length&&("string"==typeof this.status.media.duration?a=this.status.media.duration:("number"==typeof this.status.media.duration&&(b=this.status.media.duration,c=b-this.status.currentTime),a=this.options.remainingDuration?(c>0?"-":"")+this._convertTime(c):this._convertTime(b)),a!==this.css.jq.duration.text()&&this.css.jq.duration.text(a))},_convertTime:c.prototype.time,_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg")},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg")},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.flash.gate=!1},_resetActive:function(){this.html.active=!1,this.flash.active=!1},_escapeHtml:function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")},_qualifyURL:function(a){var b=document.createElement("div");return b.innerHTML='<a href="'+this._escapeHtml(a)+'">x</a>',b.firstChild.href},_absoluteMediaUrls:function(b){var c=this;return a.each(b,function(a,d){d&&c.format[a]&&(b[a]=c._qualifyURL(d))}),b},setMedia:function(b){var c=this,d=!1,e=this.status.media.poster!==b.poster;this._resetMedia(),this._resetGate(),this._resetActive(),this.androidFix.setMedia=!1,this.androidFix.play=!1,this.androidFix.pause=!1,b=this._absoluteMediaUrls(b),a.each(this.formats,function(e,f){var g="video"===c.format[f].media;if(a.each(c.solutions,function(e,h){if(c[h].support[f]&&c._validString(b[f])){var i="html"===h;return g?(i?(c.html.video.gate=!0,c._html_setVideo(b),c.html.active=!0):(c.flash.gate=!0,c._flash_setVideo(b),c.flash.active=!0),c.css.jq.videoPlay.length&&c.css.jq.videoPlay.show(),c.status.video=!0):(i?(c.html.audio.gate=!0,c._html_setAudio(b),c.html.active=!0,a.jPlayer.platform.android&&(c.androidFix.setMedia=!0)):(c.flash.gate=!0,c._flash_setAudio(b),c.flash.active=!0),c.css.jq.videoPlay.length&&c.css.jq.videoPlay.hide(),c.status.video=!1),d=!0,!1}}),d)return!1}),d?(this.status.nativeVideoControls&&this.html.video.gate||this._validString(b.poster)&&(e?this.htmlElement.poster.src=b.poster:this.internal.poster.jq.show()),this.css.jq.title.length&&"string"==typeof b.title&&(this.css.jq.title.html(b.title),this.htmlElement.audio&&this.htmlElement.audio.setAttribute("title",b.title),this.htmlElement.video&&this.htmlElement.video.setAttribute("title",b.title)),this.status.srcSet=!0,this.status.media=a.extend({},b),this._updateButtons(!1),this._updateInterface(),this._trigger(a.jPlayer.event.setmedia)):this._error({type:a.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:a.jPlayer.errorMsg.NO_SUPPORT,hint:a.jPlayer.errorHint.NO_SUPPORT})},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.flash.active&&this._flash_resetMedia()},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()},load:function(){this.status.srcSet?this.html.active?this._html_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")},focus:function(){this.options.keyEnabled&&(a.jPlayer.focus=this)},play:function(a){a="number"==typeof a?a:NaN,this.status.srcSet?(this.focus(),this.html.active?this._html_play(a):this.flash.active&&this._flash_play(a)):this._urlNotSetError("play")},videoPlay:function(){this.play()},pause:function(a){a="number"==typeof a?a:NaN,this.status.srcSet?this.html.active?this._html_pause(a):this.flash.active&&this._flash_pause(a):this._urlNotSetError("pause")},tellOthers:function(b,c){var d=this,e="function"==typeof c,f=Array.prototype.slice.call(arguments);"string"==typeof b&&(e&&f.splice(1,1),a.each(this.instances,function(){d.element!==this&&(e&&!c.call(this.data("jPlayer"),d)||this.jPlayer.apply(this,f))}))},pauseOthers:function(a){this.tellOthers("pause",function(){return this.status.srcSet},a)},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")},playHead:function(a){a=this._limitValue(a,0,100),this.status.srcSet?this.html.active?this._html_playHead(a):this.flash.active&&this._flash_playHead(a):this._urlNotSetError("playHead")},_muted:function(a){this.mutedWorker(a),this.options.globalVolume&&this.tellOthers("mutedWorker",function(){return this.options.globalVolume},a)},mutedWorker:function(b){this.options.muted=b,this.html.used&&this._html_setProperty("muted",b),this.flash.used&&this._flash_mute(b),this.html.video.gate||this.html.audio.gate||(this._updateMute(b),this._updateVolume(this.options.volume),this._trigger(a.jPlayer.event.volumechange))},mute:function(a){a=a===b||!!a,this._muted(a)},unmute:function(a){a=a===b||!!a,this._muted(!a)},_updateMute:function(a){a===b&&(a=this.options.muted),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):a?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))},volume:function(a){this.volumeWorker(a),this.options.globalVolume&&this.tellOthers("volumeWorker",function(){return this.options.globalVolume},a)},volumeWorker:function(b){b=this._limitValue(b,0,1),this.options.volume=b,this.html.used&&this._html_setProperty("volume",b),this.flash.used&&this._flash_volume(b),this.html.video.gate||this.html.audio.gate||(this._updateVolume(b),this._trigger(a.jPlayer.event.volumechange))},volumeBar:function(b){if(this.css.jq.volumeBar.length){var c=a(b.currentTarget),d=c.offset(),e=b.pageX-d.left,f=c.width(),g=c.height()-b.pageY+d.top,h=c.height();this.options.verticalVolume?this.volume(g/h):this.volume(e/f)}this.options.muted&&this._muted(!1)},_updateVolume:function(a){a===b&&(a=this.options.volume),a=this.options.muted?0:a,this.status.noVolume?(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*a+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)},_cssSelectorAncestor:function(b){var c=this;this.options.cssSelectorAncestor=b,this._removeUiClass(),this.ancestorJq=b?a(b):[],b&&1!==this.ancestorJq.length&&this._warning({type:a.jPlayer.warning.CSS_SELECTOR_COUNT,context:b,message:a.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:a.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),a.each(this.options.cssSelector,function(a,b){c._cssSelector(a,b)}),this._updateInterface(),this._updateButtons(),this._updateAutohide(),this._updateVolume(),this._updateMute()},_cssSelector:function(b,c){var d=this;if("string"==typeof c)if(a.jPlayer.prototype.options.cssSelector[b]){if(this.css.jq[b]&&this.css.jq[b].length&&this.css.jq[b].unbind(".jPlayer"),this.options.cssSelector[b]=c,this.css.cs[b]=this.options.cssSelectorAncestor+" "+c,this.css.jq[b]=c?a(this.css.cs[b]):[],this.css.jq[b].length&&this[b]){var e=function(c){c.preventDefault(),"pause"==b?sessionStorage.setItem("is_pause",!0):"play"==b&&sessionStorage.setItem("is_pause",!1),d[b](c),a(this).blur()};this.css.jq[b].bind("click.jPlayer",e)}c&&1!==this.css.jq[b].length&&this._warning({type:a.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[b],message:a.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[b].length+" found for "+b+" method.",hint:a.jPlayer.warningHint.CSS_SELECTOR_COUNT})}else this._warning({type:a.jPlayer.warning.CSS_SELECTOR_METHOD,context:b,message:a.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:a.jPlayer.warningHint.CSS_SELECTOR_METHOD});else this._warning({type:a.jPlayer.warning.CSS_SELECTOR_STRING,context:c,message:a.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:a.jPlayer.warningHint.CSS_SELECTOR_STRING})},duration:function(a){this.options.toggleDuration&&(this.options.captureDuration&&a.stopPropagation(),this._setOption("remainingDuration",!this.options.remainingDuration))},seekBar:function(b){if(!this.options.seekDisable&&this.css.jq.seekBar.length){var c=a(b.currentTarget),d=c.offset(),e=b.pageX-d.left,f=c.width(),g=100*e/f;this.playHead(g),this.setSeek(!0)}},setSeek:function(a){this.status.isSeeked=a},playbackRate:function(a){this._setOption("playbackRate",a)},playbackRateBar:function(b){if(this.css.jq.playbackRateBar.length){var c,d,e=a(b.currentTarget),f=e.offset(),g=b.pageX-f.left,h=e.width(),i=e.height()-b.pageY+f.top,j=e.height();c=this.options.verticalPlaybackRate?i/j:g/h,d=c*(this.options.maxPlaybackRate-this.options.minPlaybackRate)+this.options.minPlaybackRate,this.playbackRate(d)}},_updatePlaybackRate:function(){var a=this.options.playbackRate,b=(a-this.options.minPlaybackRate)/(this.options.maxPlaybackRate-this.options.minPlaybackRate);this.status.playbackRateEnabled?(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.show(),this.css.jq.playbackRateBarValue.length&&(this.css.jq.playbackRateBarValue.show(),this.css.jq.playbackRateBarValue[this.options.verticalPlaybackRate?"height":"width"](100*b+"%"))):(this.css.jq.playbackRateBar.length&&this.css.jq.playbackRateBar.hide(),this.css.jq.playbackRateBarValue.length&&this.css.jq.playbackRateBarValue.hide())},repeat:function(){this._loop(!0)},repeatOff:function(){this._loop(!1)},_loop:function(b){this.options.loop!==b&&(this.options.loop=b,this._updateButtons(),this._trigger(a.jPlayer.event.repeat))},option:function(c,d){var e=c;if(0===arguments.length)return a.extend(!0,{},this.options);if("string"==typeof c){var f=c.split(".");if(d===b){for(var g=a.extend(!0,{},this.options),h=0;h<f.length;h++){if(g[f[h]]===b)return this._warning({type:a.jPlayer.warning.OPTION_KEY,context:c,message:a.jPlayer.warningMsg.OPTION_KEY,hint:a.jPlayer.warningHint.OPTION_KEY}),b;g=g[f[h]]}return g}e={};for(var i=e,j=0;j<f.length;j++)j<f.length-1?(i[f[j]]={},i=i[f[j]]):i[f[j]]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(b,c){var d=this;switch(b){case"volume":this.volume(c);break;case"muted":this._muted(c);break;case"globalVolume":this.options[b]=c;break;case"cssSelectorAncestor":this._cssSelectorAncestor(c);break;case"cssSelector":a.each(c,function(a,b){d._cssSelector(a,b)});break;case"playbackRate":this.options[b]=c=this._limitValue(c,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("playbackRate",c),this._updatePlaybackRate();break;case"defaultPlaybackRate":this.options[b]=c=this._limitValue(c,this.options.minPlaybackRate,this.options.maxPlaybackRate),this.html.used&&this._html_setProperty("defaultPlaybackRate",c),this._updatePlaybackRate();break;case"minPlaybackRate":this.options[b]=c=this._limitValue(c,.1,this.options.maxPlaybackRate-.1),this._updatePlaybackRate();break;case"maxPlaybackRate":this.options[b]=c=this._limitValue(c,this.options.minPlaybackRate+.1,16),this._updatePlaybackRate();break;case"fullScreen":if(this.options[b]!==c){var e=a.jPlayer.nativeFeatures.fullscreen.used.webkitVideo;(!e||e&&!this.status.waitForPlay)&&(e||(this.options[b]=c),c?this._requestFullscreen():this._exitFullscreen(),e||this._setOption("fullWindow",c))}break;case"fullWindow":this.options[b]!==c&&(this._removeUiClass(),this.options[b]=c,this._refreshSize());break;case"size":this.options.fullWindow||this.options[b].cssClass===c.cssClass||this._removeUiClass(),this.options[b]=a.extend({},this.options[b],c),this._refreshSize();break;case"sizeFull":this.options.fullWindow&&this.options[b].cssClass!==c.cssClass&&this._removeUiClass(),this.options[b]=a.extend({},this.options[b],c),this._refreshSize();break;case"autohide":this.options[b]=a.extend({},this.options[b],c),this._updateAutohide();break;case"loop":this._loop(c);break;case"remainingDuration":this.options[b]=c,this._updateInterface();break;case"toggleDuration":this.options[b]=c;break;case"nativeVideoControls":this.options[b]=a.extend({},this.options[b],c),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();break;case"noFullWindow":this.options[b]=a.extend({},this.options[b],c),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullWindow=this._uaBlocklist(this.options.noFullWindow),this._restrictNativeVideoControls(),this._updateButtons();break;case"noVolume":this.options[b]=a.extend({},this.options[b],c),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();break;case"emulateHtml":this.options[b]!==c&&(this.options[b]=c,c?this._emulateHtmlBridge():this._destroyHtmlBridge());break;case"timeFormat":this.options[b]=a.extend({},this.options[b],c);break;case"keyEnabled":this.options[b]=c,c||this!==a.jPlayer.focus||(a.jPlayer.focus=null);break;case"keyBindings":this.options[b]=a.extend(!0,{},this.options[b],c);break;case"audioFullScreen":this.options[b]=c}return this},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger(a.jPlayer.event.resize)},_setSize:function(){this.options.fullWindow?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})},_updateAutohide:function(){var a=this,b="mousemove.jPlayer",c=".jPlayerAutohide",d=b+c,e=function(){a.css.jq.gui.fadeIn(a.options.autohide.fadeIn,function(){clearTimeout(a.internal.autohideId),a.internal.autohideId=setTimeout(function(){a.css.jq.gui.fadeOut(a.options.autohide.fadeOut)},a.options.autohide.hold)})};this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),this.element.unbind(c),this.css.jq.gui.unbind(c),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullWindow&&this.options.autohide.full||!this.options.fullWindow&&this.options.autohide.restored?(this.element.bind(d,e),this.css.jq.gui.bind(d,e),this.css.jq.gui.hide()):this.css.jq.gui.show())},fullScreen:function(){this._setOption("fullScreen",!0)},restoreScreen:function(){this._setOption("fullScreen",!1)},_fullscreenAddEventListeners:function(){var b=this,c=a.jPlayer.nativeFeatures.fullscreen;c.api.fullscreenEnabled&&c.event.fullscreenchange&&("function"!=typeof this.internal.fullscreenchangeHandler&&(this.internal.fullscreenchangeHandler=function(){b._fullscreenchange()}),document.addEventListener(c.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1))},_fullscreenRemoveEventListeners:function(){var b=a.jPlayer.nativeFeatures.fullscreen;this.internal.fullscreenchangeHandler&&document.removeEventListener(b.event.fullscreenchange,this.internal.fullscreenchangeHandler,!1)},_fullscreenchange:function(){this.options.fullScreen&&!a.jPlayer.nativeFeatures.fullscreen.api.fullscreenElement()&&this._setOption("fullScreen",!1)},_requestFullscreen:function(){var b=this.ancestorJq.length?this.ancestorJq[0]:this.element[0],c=a.jPlayer.nativeFeatures.fullscreen;c.used.webkitVideo&&(b=this.htmlElement.video),c.api.fullscreenEnabled&&c.api.requestFullscreen(b)},_exitFullscreen:function(){var b,c=a.jPlayer.nativeFeatures.fullscreen;c.used.webkitVideo&&(b=this.htmlElement.video),c.api.fullscreenEnabled&&c.api.exitFullscreen(b)},_html_initMedia:function(b){var c=a(this.htmlElement.media).empty();a.each(b.track||[],function(a,b){var d=document.createElement("track");d.setAttribute("kind",b.kind?b.kind:""),d.setAttribute("src",b.src?b.src:""),d.setAttribute("srclang",b.srclang?b.srclang:""),d.setAttribute("label",b.label?b.label:""),b.def&&d.setAttribute("default",b.def),c.append(d)}),this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger(a.jPlayer.event.timeupdate)},_html_setFormat:function(b){var c=this;a.each(this.formats,function(a,d){if(c.html.support[d]&&b[d])return c.status.src=b[d],c.status.format[d]=!0,c.status.formatType=d,!1})},_html_setAudio:function(a){this._html_setFormat(a),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia(a)},_html_setVideo:function(a){this._html_setFormat(a),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(a.poster)?a.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia(a)},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id!==this.internal.video.id||this.status.nativeVideoControls||this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="about:blank",this.htmlElement.media.load())},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(a){var b=this,c=this.htmlElement.media;if(this.androidFix.pause=!1,this._html_load(),this.androidFix.setMedia)this.androidFix.play=!0,this.androidFix.time=a;else if(isNaN(a))c.play();else{this.internal.cmdsIgnored&&c.play();try{if(c.seekable&&!("object"==typeof c.seekable&&c.seekable.length>0))throw 1;c.currentTime=a,c.play()}catch(c){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.play(a)},250))}}this._html_checkWaitForPlay()},_html_pause:function(a){var b=this,c=this.htmlElement.media;if(this.androidFix.play=!1,a>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),c.pause(),this.androidFix.setMedia)this.androidFix.pause=!0,this.androidFix.time=a;else if(!isNaN(a))try{if(c.seekable&&!("object"==typeof c.seekable&&c.seekable.length>0))throw 1;c.currentTime=a}catch(c){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.pause(a)},250))}a>0&&this._html_checkWaitForPlay()},_html_playHead:function(a){var b=this,c=this.htmlElement.media;this._html_load();try{if("object"==typeof c.seekable&&c.seekable.length>0)c.currentTime=a*c.seekable.end(c.seekable.length-1)/100;else{if(!(c.duration>0)||isNaN(c.duration))throw"e";c.currentTime=a*c.duration/100}}catch(c){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.playHead(a)},250))}this.status.waitForLoad||this._html_checkWaitForPlay()},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))},_html_setProperty:function(a,b){this.html.audio.available&&(this.htmlElement.audio[a]=b),this.html.video.available&&(this.htmlElement.video[a]=b)},_flash_setAudio:function(b){var c=this;try{a.each(this.formats,function(a,d){if(c.flash.support[d]&&b[d]){switch(d){case"m4a":case"fla":c._getMovie().fl_setAudio_m4a(b[d]);break;case"mp3":c._getMovie().fl_setAudio_mp3(b[d]);break;case"rtmpa":c._getMovie().fl_setAudio_rtmp(b[d])}return c.status.src=b[d],c.status.format[d]=!0,c.status.formatType=d,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(a){this._flashError(a)}},_flash_setVideo:function(b){var c=this;try{a.each(this.formats,function(a,d){if(c.flash.support[d]&&b[d]){switch(d){case"m4v":case"flv":c._getMovie().fl_setVideo_m4v(b[d]);break;case"rtmpv":c._getMovie().fl_setVideo_rtmp(b[d])}return c.status.src=b[d],c.status.format[d]=!0,c.status.formatType=d,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(a){this._flashError(a)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(NaN)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(a){this._flashError(a)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(a){this._flashError(a)}this.status.waitForLoad=!1},_flash_play:function(a){try{this._getMovie().fl_play(a)}catch(a){this._flashError(a)}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()},_flash_pause:function(a){try{this._getMovie().fl_pause(a)}catch(a){this._flashError(a)}a>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())},_flash_playHead:function(a){try{this._getMovie().fl_play_head(a)}catch(a){this._flashError(a)}this.status.waitForLoad||this._flash_checkWaitForPlay()},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))},_flash_volume:function(a){try{this._getMovie().fl_volume(a)}catch(a){this._flashError(a)}},_flash_mute:function(a){try{this._getMovie().fl_mute(a)}catch(a){this._flashError(a)}},_getMovie:function(){return document[this.internal.flash.id]},_getFlashPluginVersion:function(){var a,b=0;if(window.ActiveXObject)try{if(a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){var c=a.GetVariable("$version");c&&(c=c.split(" ")[1].split(","),b=parseInt(c[0],10)+"."+parseInt(c[1],10))}}catch(a){}else navigator.plugins&&navigator.mimeTypes.length>0&&(a=navigator.plugins["Shockwave Flash"])&&(b=navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1"));return 1*b},_checkForFlash:function(a){var b=!1;return this._getFlashPluginVersion()>=a&&(b=!0),b},_validString:function(a){return a&&"string"==typeof a},_limitValue:function(a,b,c){return a<b?b:a>c?c:a},_urlNotSetError:function(b){this._error({type:a.jPlayer.error.URL_NOT_SET,context:b,message:a.jPlayer.errorMsg.URL_NOT_SET,hint:a.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(b){var c;c=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:a.jPlayer.error[c],context:this.internal.flash.swf,message:a.jPlayer.errorMsg[c]+b.message,hint:a.jPlayer.errorHint[c]}),this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(b){this._trigger(a.jPlayer.event.error,b),this.options.errorAlerts&&this._alert("Error!"+(b.message?"\n"+b.message:"")+(b.hint?"\n"+b.hint:"")+"\nContext: "+b.context)},_warning:function(c){this._trigger(a.jPlayer.event.warning,b,c),this.options.warningAlerts&&this._alert("Warning!"+(c.message?"\n"+c.message:"")+(c.hint?"\n"+c.hint:"")+"\nContext: "+c.context)},_alert:function(a){var b="jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+a;this.options.consoleAlerts?window.console&&window.console.log&&window.console.log(b):alert(b)},_emulateHtmlBridge:function(){var b=this;a.each(a.jPlayer.emulateMethods.split(/\s+/g),function(a,c){b.internal.domNode[c]=function(a){b[c](a)}}),a.each(a.jPlayer.event,function(c,d){var e=!0;a.each(a.jPlayer.reservedEvent.split(/\s+/g),function(a,b){if(b===c)return e=!1,!1}),e&&b.element.bind(d+".jPlayer.jPlayerHtml",function(){b._emulateHtmlUpdate();var a=document.createEvent("Event");a.initEvent(c,!1,!0),b.internal.domNode.dispatchEvent(a)})})},_emulateHtmlUpdate:function(){var b=this;a.each(a.jPlayer.emulateStatus.split(/\s+/g),function(a,c){b.internal.domNode[c]=b.status[c]}),a.each(a.jPlayer.emulateOptions.split(/\s+/g),function(a,c){b.internal.domNode[c]=b.options[c]})},_destroyHtmlBridge:function(){var b=this;this.element.unbind(".jPlayerHtml");var c=a.jPlayer.emulateMethods+" "+a.jPlayer.emulateStatus+" "+a.jPlayer.emulateOptions;a.each(c.split(/\s+/g),function(a,c){delete b.internal.domNode[c]})}},a.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},a.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+a.jPlayer.prototype.version.script+" needs Jplayer.swf version "+a.jPlayer.prototype.version.needFlash+" but found "},a.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},a.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},a.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},a.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}})}),define("new_toefl/js/plugin/jquery-slider",["jqueryui"],function(a,b,c){var d=a("jqueryui");!function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;b<c;b++)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=e.add(a(f.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(!0===b.range&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j=this,k=this.options;return!k.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-j.values(b));(e>c||e===c&&(b===j._lastChangedValue||j.values(b)===k.min))&&(e=c,f=a(this),g=b)}),!1!==this._start(b,g)&&(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),h=f.offset(),i=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=i?{left:0,top:0}:{left:b.pageX-h.left-f.width()/2,top:b.pageY-h.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),!1!==f&&this.values(b,c))):c!==this.value()&&!1!==(f=this._trigger("slide",a,{handle:this.handles[b],value:c}))&&this.value(c)},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&!0===this.options.range&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=!this._animateOff&&h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),!0===i.options.range&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var d,e,f,g=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),!1===this._start(b,g)))return}switch(f=this.options.step,d=e=this.options.values&&this.options.values.length?this.values(g):this.value(),b.keyCode){case a.ui.keyCode.HOME:e=this._valueMin();break;case a.ui.keyCode.END:e=this._valueMax();break;case a.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+f);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-f)}this._slide(b,g,e)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(d)}),define("new_toefl/tpl/newplayer/write-operate-l.tpl",[],'<p class="pannel-pause">\n\t<a href="javascript:void(0)" class="pannel-repeat-w js-kmf-tips" data-msg="快捷键:<span class=\'g-b\'>[</span>"><span class="i-toefl-icobg i-rel-repeat"></span>再播一遍本句</a>\n\t{{if writeStatus==1}}\n\t<a href="javascript:void(0)" class="pannel-write-lrc"><span class="i-toefl-icobg i-rel-showlrc"></span>查看原文</a>\n\t{{else if writeStatus==2}}\n\t<a href="javascript:void(0)" class="pannel-write-lrc js-writing-continue"><span class="i-toefl-icobg i-rel-showlrc"></span>继续听写(<em class="js-lrc-countdown">5</em>)</a>\n\t{{else if writeStatus==3}}\n\t<a href="javascript:void(0)" class="pannel-write-lrc pannel-disabled"><span class="i-toefl-icobg i-rel-showlrc"></span>查看原文</a>\n\t{{/if}}\n\t{{if isEnd}}\n\t<a href="{{overUrl}}" class="pannel-over"><span class="i-toefl-icobg i-rel-complete"></span>结束训练</a>\n\t{{else}}\n\t<a href="javascript:void(0)" class="pannel-next js-kmf-tips" data-msg="快捷键:<span class=\'g-b\'>]</span>"><span class="i-toefl-icobg i-rel-next"></span>进入下一句</a>\n\t{{/if}}\n</p>'),define("new_toefl/js/mod/intensive/word/screen_word",["jquery","new_toefl/js/mod/intensive/word/note","new_toefl/js/mod/intensive/word/drag","new_toefl/js/util/new_favorite","new_toefl/js/util/form-textarea"],function(a,b,c){function d(a,b){for(var c in b)a[c]?alert("划词功能扩展时存在相同方法或属性！"):a[c]=b[c]}var e=a("jquery"),f=a("new_toefl/js/mod/intensive/word/note"),g=a("new_toefl/js/mod/intensive/word/drag"),h=a("new_toefl/js/util/new_favorite"),i=function(a,b){var c=e(document);this.ele=a,this.outerBox=".js-origin-main",this.dSty="js-word-disabled",this.elements=e(a),this.eleLayer="#js-word-translate-layer",this.init(),this.url="/vocab/ajaxquery?word=",this.favUrl="/vocab/ajaxfavword",this.curWord="",this.$startEle=null,this.$endEle=null,this.noteHide=e("#noteHide").val()||0,this.offset=10,this.winWidth=c.width(),this.winHeight=c.height(),this.parentEl=null,this.opts=b};i.prototype={status:{loading:!1,fav:!1,$targetEle:{},selectId:[]},init:function(){0!==this.elements.length&&(this.createButton(),h({ele:"",s_icon:".actionbg",iconSty:"fav-ico-ed",eles:["#js-translate-fav"]}),this.setup())},setup:function(){var a=this,b=null,c=this.eleLayer;e(a.ele).on("mouseup",function(c){var d=e(c.target).closest(a.ele);if(a.parentEl=d,b&&(clearTimeout(b),b=null),a.checkLayer.call(a,c)||a.closeLayer(),!a.checkEle.call(a,c))return void a.hideButton();a.checkWord.call(a,d)}),e(this.popButton).on("mousedown",function(a){return a.stopPropagation(),a.preventDefault(),!1}),e(document).delegate(".js-translate-inner","mousedown",function(a){return a.stopPropagation(),a.preventDefault(),!1}),e(this.popButton).on("click",".word",function(b){var c=e(this),d=c.data("qid");return a.openLayer().render(d),b.stopPropagation(),b.preventDefault(),!1}),e(document).delegate(".js-word-play","click",function(){a.phonEvent(e(this))}),g(c,{handleEle:".js-translate-dragHandle"}),e(document).on("click",".js-ignore",function(){e(".js-dict-toefl").hide(),e.cookie("kmfdictguide","1",{expires:10,path:"/"})})},resetCurEle:function(){this.$startEle=null,this.$endEle=null},checkEle:function(a){var b,c=this.ele,d=/^#/,f=/^\./,g=d.test(c),h=f.test(c),i=this.dSty,j=c.slice(1),k=e(a.target);return k.hasClass(i)||k.parents("."+i).length>0?b=!1:g&&(k.attr("id")==j||k.parents(c).length>0)?(k.attr("id")==j?k:k.parents(c),b=!0):h&&(k.hasClass(j)||k.parents(c).length>0)?(k.hasClass(j)?k:k.parents(c),b=!0):b=!1,b},checkLayer:function(a){var b=this.eleLayer,c=b.slice(1),d=e(a.target);return!!(d.attr("id")==c||d.parents(b).length>0||e(b).hasClass("js-blank-retain"))},checkWord:function(a){var b;if(this.curWord=b=e.trim(this.getWord.call(this)),!/^[\u4e00-\u9fa5]+$/.test(this.curWord)){if(""===b)return void this.hideButton();if(/\s/.test(b)){if(e(this.outerBox).data("word",!0),this.noteHide)return;this.createButton({word:{display:!1},parent:a},"note")}else if(/\s/.test(b))e(this.outerBox).data("word",!0),this.createButton({note:{display:!1},parent:a});else{if(e(this.outerBox).data("word",!0),this.noteHide)return;this.createButton({note:{display:!1},parent:a})}this.setButtonPosition()}},getWord:function(){var a,b,c,d="",f=this;if(void 0!==window.getSelection){if(b=window.getSelection(),b.rangeCount)for(a=0,c=b.rangeCount;a<c;a+=1)d+=b.getRangeAt(a).toString();f.status.$targetEle={},f.status.selectId=[],this.elements.each(function(a){if(b.containsNode&&b.containsNode(e(this).get(0),!0)){var c=e(this).data("id");c&&(f.status.selectId.push(c),f.status.$targetEle[c]=e(this))}})}else void 0!==document.selection&&"Text"===document.selection.type&&(d=document.selection.createRange().text);return d},getPosition:function(){var a,b,c,d,f,g,h,i,j=e(document).scrollTop();return void 0!==window.getSelection?(a=window.getSelection(),b=a.getRangeAt(0),c=b.getBoundingClientRect(),f=c.top+j,g=c.bottom+j,h=c.left,i=c.right):void 0!==document.selection&&(d=document.selection.createRange(),f=d.boundingTop+j,g=f+d.boundingHeight,h=d.boundingLeft,i=h+d.boundingWidth),this.boundary={left:h,right:i,top:f,bottom:g},this.boundary},setButtonPosition:function(){var a=this.popButton,b=a.width(),c=38,d=this.getPosition(),e=(d.left+d.right)/2-b/2,f=d.top-c;return a.css({left:e,top:f}).show(),this},setLayerPosition:function(){var a=this.boundary,b=e(this.eleLayer),c=b.width(),d=b.height(),f=a.bottom,g=a.left;return g>this.winWidth-c&&(g=this.winWidth-c-this.offset),f>this.winHeight-d&&(f=this.winHeight-d-this.offset),e(this.eleLayer).css({left:g,top:f}).show(),this},createButton:function(b,c){var d,f=this.popButton||e('<div class="g-word-tool" />'),g=a("new_toefl/tpl/intensive/popButton.tpl"),h=template.compile(g),i="",j={},k=[],l=b?b.parent:e(this.ele),m=this;d=kmfGlobalUser&&1==kmfGlobalUser.loginStatus?"js-original-notes":"js-kmf-login js-original-notes",j.word={menu:"查词",display:!0,className:"word"},this.noteHide||(j.note={menu:"笔记",display:!0,className:d}),f.appendTo("body");for(var n in j)"object"==typeof b&&b[n]&&e.extend(j[n],b[n]),j[n].display&&k.push(j[n]);i=h({toolList:k,qid:l.data("qid")}),f.html(i),c&&"function"==typeof m.opts.noteEvent&&m.opts.noteEvent({word:m.curWord,parent:m.parentEl}),this.popButton=f},hideButton:function(){this.popButton.hide(),e(this.outerBox).data("word",!1)},createLayer:function(){e('<div class="g-word-translate" id="js-word-translate-layer" />').appendTo("body")},closeLayer:function(){return e(this.eleLayer).hide(),this},openLayer:function(){var a=e(this.eleLayer);return a.length<1&&this.createLayer(),this.resetLayer(),a.show(),this},setLayerSty:function(a){return e(this.eleLayer).addClass(a),this},resetLayer:function(){e(this.eleLayer).removeClass().addClass("g-word-translate").html("")},render:function(b){var c,d=this,f=e.trim(this.curWord),g=f.split(/\s/),d=this,b=b||e(this.ele).data("qid"),h=this.url+f+"&qid="+b,i=e(this.eleLayer),j=a("new_toefl/tpl/intensive/translate.tpl"),k=template.compile(j),l='<div class="nocontent"><div class="empty-img"></div><p class="empty-text">未找到释义</p></div>',m=/[\u4e00-\u9fa5]/.test(f),n=e.cookie("kmfdictguide"),o=1!=n,p=b||e("#target_id").val()||0;return this.status.loading?this:g.length>1||m?(i.html(l),this):(this.status.loading=!0,e.post(h,function(a){1==a.status&&0==a.result?i.html(l):1==a.status&&(a.result.supportAudio=d.checkAudio(),a.result.isShowGuide=o,a.result.qid=p,c=k(a),i.html(c),d.curWord=a.result.word,d.curAudio=a.result.us_pron,"function"==typeof d.opts.noteEvent&&(d.opts.noteEvent({word:d.curWord,parent:d.parentEl}),d.hideButton())),d.status.loading=!1,d.setLayerPosition()},"json"),this)},favorite:function(a){var b,c,d=this.curWord,f=this;return c=a.data("op"),this.status.fav||-1==c?this:(b=this.favUrl+"?word="+d+"&op="+c,this.status.fav=!0,e.post(b,function(b){var d=1-c,e=["收藏","已收藏"],g=["word-icobg fav-ico","word-icobg faved-ico"];1==b.status&&(a.data("op",d),a.find(".menu-text").text(e[d]),a.find(".word-icobg").removeClass().addClass(g[d]),f.status.fav=!1)},"json"),this)},phonEvent:function(a){var b=this.curAudio;return this.checkAudio()&&(this.player||this.createPlayer(),this.setMedia(b).play()),this},checkAudio:function(){return!!document.createElement("audio").canPlayType},createPlayer:function(){return this.player=document.createElement("audio"),this.player.setAttribute("preload","auto"),document.body.appendChild(this.player),this},setMedia:function(a){return a&&""!=a?(this.player&&this.player.getAttribute("src")!=a&&this.player.setAttribute("src",a),this):this},play:function(){return this.player.play(),this}},d(i.prototype,f),c.exports=i}),define("new_toefl/js/mod/intensive/word/note",["jquery"],function(a,b,c){var d=a("jquery");c.exports={noteInit:function(){var a,b,c=this,e=this.eleLayer,f={noteButton:".note",noteSave:".note-save",noteCancel:".note-cancel"};this.noteEditorId="js-translate-note-editor",d(this.popButton).on("click",f.noteButton,function(d){kmfGlobalUser&&1!=kmfGlobalUser.loginStatus||(a=c.status.$targetEle,b=c.status.selectId,c.status.$targetEle={},c.openLayer().setLayerSty("g-translate-note js-blank-retain").setLayerPosition().noteRender())}),d(document).on("click",e+" "+f.noteSave,function(){c.noteSave.call(c,d(this),a,b)}),d(document).on("click",e+" "+f.noteCancel,function(){c.closeLayer()}),d(document).on("keyup","#"+this.noteEditorId,function(a){var b=d(e+" "+f.noteSave);""==d.trim(d(this).val())?b.addClass("btn-disabled"):b.removeClass("btn-disabled"),a.stopPropagation()})},noteSave:function(a,b,c){var e,f=this.noteSource,g=d("#"+this.noteEditorId),h=d.trim(g.val()),i=this,j=d("#target_id"),k=d("#parent_id"),l=d("#source_port"),m=d("#type");if(""!=h&&!a.data("doing")&&!a.hasClass("btn-disabled")){if(a.hasClass("js-translate-close"))return void this.closeLayer();1==c.length&&(e=c[0],b[e].data("type")),a.data("doing","doing"),d.post("/record/ajaxaddusernotes",{target_id:j.val(),parent_id:k.val(),source_port:l.val(),type:m.val(),content:h,source:f},function(b){var c=d(i.eleLayer),e=(c.find(".js-translate-notetips"),c.find(".note-cancel"),c.find(".save-btn"));1==b.status&&(a.removeData("doing"),e.show(),g.attr("readonly","readonly"),e.stop().animate({top:"-46px"},300,function(){e.delay(300).animate({top:"-66px",opacity:0},300),c.delay(500).fadeOut(500)}))},"json")}},noteRender:function(){var b,c=d(this.eleLayer),e=a("new_toefl/tpl/intensive/note.tpl"),f=template.compile(e),g="",h=this.curWord.replace(/\s{2,}/g," "),i=h.length+4,j=this.noteEditorId;g=f({words:h}),c.html(g),b=document.getElementById(j),this.setCursorPos(b,i),this.noteSource=h},setCursorPos:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}}}),define("new_toefl/tpl/intensive/note.tpl",[],'<div class="note-inner">\n\t<h2 class="title-bar js-translate-dragHandle">新的笔记</h2>\n\t<div class="note-editor">\n        \x3c!--"{{words}}"--\x3e\n\t\t<textarea class="editor" id="js-translate-note-editor"></textarea>\n\t</div>\n\t<div class="buttons g-clearfix">\n\t\t<span class="g-floatright">\n\t\t\t<a class="note-save" href="javascript:void(0)">保存</a>\n\t\t\t<a class="note-cancel" href="javascript:void(0)">取消</a>\n\t\t</span>\n\t\t<span class="tips js-translate-notetips">保存成功！<em class="g-g9">你可以在“</em><a href="/profile/notes" class="g-hl-1" target="_blank">我的记录→笔记</a><em class="g-g9">”中查看。</em></span>\n\t    <span class="save-btn"></span>\n    </div>\n</div>\n'),define("new_toefl/js/mod/intensive/word/drag",["jquery"],function(a,b,c){var d=a("jquery"),e=function(a,b){var c,e,f,g,h={handleEle:".title-bar"},i=!1,j="js-dragging";h=d.extend(h,b),d(document).delegate(a+" "+h.handleEle,"mousedown",function(b){var h=d(this).parents(a),k=(h.offset(),h.css("top")),l=h.css("left");c=b.pageX,e=b.pageY,f="auto"==l?0:parseInt(l),g="auto"==k?0:parseInt(k),h.addClass(j),i=!0}),d(document).on({mousemove:function(b){if(i){var h=b.pageX,j=b.pageY,k=d(a),l=h-c+f,m=j-e+g;d(this);b.preventDefault(),k.css({left:l,top:m})}},mouseup:function(){d(a).removeClass(j),i=!1}})};c.exports=e}),define("new_toefl/js/util/new_favorite",["jquery","new_toefl/js/util/form-textarea"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/js/util/form-textarea"),f=function(){};f.prototype={init:function(a,b){var c=this;if(c.opts={ele:".js-new-favorite",eles:[],dataEle:"",textEle:".menu-text",menuText:["已收藏","收藏"],delimiter:",",s_icon:".js-favicon",iconSty:"js-faved",cssSelector:{globleLogin:"#GlobeLogin",login:".js-kmf-login",favBox:"#js-kmf-favorite",favTitle:".js-favtitle",favListCont:".js-list-cont",favList:".js-favorite-lists",save:".js-save-btn",cancel:".js-fav-close",create:".js-create-list",deltet:".js-delete-btn",favInput:".js-favorite-input",favName:".js-favorite-name",newFav:".js-newFav"},favAjax:"/record/ajaxaddfavorite",unFavAjax:"/record/ajaxcancelfavorite",getFavAjax:"/record/ajaxgetuserfavorites",favCB:null,unfavCB:null},"Object"==c.checkType(a)?d.extend(c.opts,a):d.extend(c.opts,b),c.cssSelector=c.opts.cssSelector,c.bSend=!0,c.favSelectKey="",c.favCacheDate=null,c.maxNewFavList=10,c.nid=5,c.defaultFavName="默认收藏夹",1!=d(c.cssSelector.globleLogin).val()){var e=d(c.opts.ele),f=c.opts.eles.join(","),g=d(f);return e.addClass("js-kmf-login"),g.addClass("js-kmf-login"),c}return c._creatFavDialog(),c.ajaxUrl().getDom().bindEvent(),c},getDom:function(){var a=this,b="";return a.opts.eles[0]&&(b=a.opts.eles.join(","),a.favSelectKey=b),a.$textEle=d(a.opts.textEle),a.$icon=d(a.opts.s_icon),a.$favDialog=d(a.cssSelector.favBox),a.$favListCont=d(a.cssSelector.favListCont),a.$saveBtn=d(a.cssSelector.save),a.$cancelBtn=d(a.cssSelector.cancel),a.$createBtn=d(a.cssSelector.create),a},ajaxUrl:function(){var a=this;return a.favAjax=a.opts.favAjax,a.unFavAjax=a.opts.unFavAjax,a.getFavAjax=a.opts.getFavAjax,a},bindEvent:function(){var a=this;return a._tabEvent(),a._favoriteEvent(),a._cancelEvent(),a._createFavListEvent(),a._favListBlurEvent(),a._deleteFavListEvent(),a._inputKeybordEvent(),a},_favoriteEvent:function(){var a=this;return a.opts.ele&&d(document).off("click",a.opts.ele).on("click",a.opts.ele,function(){var b=d(this);a._favoriteFn(b)}),a.favSelectKey&&d(document).off("click",a.favSelectKey).on("click",a.favSelectKey,function(){var b=d(this);a._favoriteFn(b)}),a},_favoriteFn:function(a){var b=this,c=d(b.opts.dataEle),e="",f="",g="";b.bSend&&(b.bSend=!1,c[0]?(e=c.data("handle"),g=c.data("op"),f=c.data("text")):(c=d(a),e=a.data("handle"),g=a.data("op"),f=a.data("text")),f&&(b.opts.menuText=f.split(b.opts.delimiter)),1==e&&g?b._unfavorite(a,c):b._getFavList(a,c),b._saveEvent(a,c))},_getFavList:function(b,c){var e=this,f=c.data("type")||b.data("type"),g=c.data("handle")||b.data("handle"),h=c.data("fid")||b.data("fid"),i=d(e.cssSelector.favTitle),j={type:f},k=0;return d.post(e.getFavAjax,j,function(b){if(b.status){1==g?i.html("添加"+b.result.type+"收藏"):i.html("管理收藏");var c=a("new_toefl/tpl/favorite/favList.tpl"),f=template.compile(c),j=f(b.result);d(e.cssSelector.favListCont).html(""),d(e.cssSelector.favListCont).append(j),k=d(e.cssSelector.favList).size(),e.favListNum=k,e.favListNum>=e.maxNewFavList?d(e.cssSelector.create).hide():d(e.cssSelector.create).show(),e._setDefaultSelect(h,b.result.list),e.bSend=!0}},"json"),1==g?e.$createBtn.removeClass("hide"):e.$createBtn.addClass("hide"),e.$favDialog.show(),e.$favDialog.animate({opacity:1}),d(document.body).addClass("scrollHidden"),e},_setDefaultSelect:function(a,b){var c=this,e=d(c.cssSelector.favList);if(a&&b)return e.each(function(b,c){var f=d(c),g=f.data("jtype"),h=f.data("fid");1==g&&a==h&&(e.removeClass("active"),f.addClass("active"))}),c},_unfavorite:function(a,b){var c=this,e=c.checkType(c.opts.unfavCB),f=a.find(c.opts.textEle),g=a.find(c.opts.s_icon),h=b.data("type")||a.data("type"),i=b.data("jid")||a.data("jid"),j=b.data("word")||a.data("word"),k=b.data("handle")||a.data("handle"),l={type:h,jid:i,word:j};return d.post(c.unFavAjax,l,function(d){d.status&&1==k&&(b.data("op",0),g=g.size()?g:a,f.html(c.opts.menuText[1]),g.removeClass(c.opts.iconSty),"Function"==e&&c.opts.unfavCB(a),c.bSend=!0)},"json"),c},_saveEvent:function(a,b){var c=this,e=a.find(c.opts.textEle),f=!0,g=a.find(c.opts.s_icon),h=b.data("type")||a.data("type"),i=b.data("subject")||a.data("subject"),j=b.data("jid")||a.data("jid"),k=b.data("qid")||a.data("qid"),l=b.data("handle")||a.data("handle"),m=b.data("word")||a.data("word");return c.$saveBtn.off().on("click",function(){var n=(d(this),c.checkType(c.opts.favCB)),o=c._newFavListData(),p=c._getFavListData(),q={type:h,subject:i,jid:j,qid:k,handle:l,word:m,jtype:p.jtype,fid:p.fid,newlist:o};if(!f)return c;if(f=!1,p.jtype)d.post(c.favAjax,q,function(d){d.status&&(1==l&&(b.data("op",1),e.html(c.opts.menuText[0]),g.addClass(c.opts.iconSty)),c.$cancelBtn.click(),c.$favListCont.html(""),"Function"==n&&c.opts.favCB(a),f=!0)},"json");else{if(!f)return c;alert("请选择收藏夹")}}),c},_cancelEvent:function(){var a=this;return a.$cancelBtn.off().on("click",function(){d(this);a.$favDialog.animate({opacity:0},function(){a.$favDialog.hide()}),d(document.body).removeClass("scrollHidden")}),a},_creatFavDialog:function(){var b=this;if(!d("#js-kmf-favorite")[0]){var c=a("new_toefl/tpl/favorite/favorite.tpl"),e=template.compile(c),f=e();return d(document.body).append(f),b}},_tabEvent:function(){var a=this;return a.$favDialog.off("click",a.cssSelector.favList).on("click",a.cssSelector.favList,function(){var b=d(this);d(a.cssSelector.favList).removeClass("active"),b.addClass("active")}),a},_createFavListEvent:function(){var b=this;return b.$createBtn.off().on("click",function(){var c=(d(this),null),e=d(b.cssSelector.favList).size();if(b.favListNum=e,!(b.favListNum>=b.maxNewFavList)){var f=a("new_toefl/tpl/favorite/newFavList.tpl"),g=template.compile(f),h=g(b.nid);c=d(h),c.appendTo(b.$favListCont),d(b.cssSelector.favList).removeClass("active"),c.addClass("active"),c.find(b.cssSelector.favInput).focus(),b.favListNum++,b.nid++}}),b},_inputKeybordEvent:function(){var a=this;return a.$favDialog.off("keyup",a.cssSelector.favInput).on("keyup",a.cssSelector.favInput,function(b){return 13==b.keyCode&&d(a.cssSelector.favInput).blur(),!1}),a},_favListBlurEvent:function(){var a=this;return a.$favListCont.on("blur",a.cssSelector.favInput,function(){var b=d(this),c=b.closest(a.cssSelector.favList),f=e(b),g=c.find(a.cssSelector.favName);f?g.html(f):g.html(a.defaultFavName),a.favListNum>=a.maxNewFavList?a.$createBtn.hide():a.$cancelBtn.show(),c.addClass("success")}),a},_deleteFavListEvent:function(){var a=this;return a.$favListCont.on("click",a.cssSelector.deltet,function(b){return d(this).closest(a.cssSelector.favList).remove(),a.favListNum--,a.favListNum<=a.maxNewFavList&&a.$createBtn.show(),!1}),a},_newFavListData:function(){var a=this,b=[];return d(a.cssSelector.newFav).each(function(c,e){var f=d(e),g=f.find(a.cssSelector.favName),h={};h.nid=f.data("fid"),h.name=g.html(),b.push(h)}),b},_getFavListData:function(){var a=this,b={},c=d(a.cssSelector.favList),e="",f="";return c.each(function(a,b){var c=d(b);c.hasClass("active")&&(e=c.data("jtype"),f=c.data("fid"))}),b.jtype=e,b.fid=f,b},checkType:function(a){return Object.prototype.toString.call(a).slice(8,-1)}},c.exports=function(a,b){(new f).init(a,b)}}),define("new_toefl/js/util/form-textarea",[],function(a,b,c){var d={init:function(a,b){var c=this;if(a){if("String"==c._checkType(a)||"HTMLElement"==c._checkType(a))this.ele=$(a);else{if(!c._checkType("HTMLElement"==a[0]))throw new Error("error:参数错误");this.ele=a}return this.opt={trim:!1},$.extend(this.opt,b),this.trim?c._trim(c._textDispose()):c._textDispose()}},_escapeMap:{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},_textDispose:function(){var a=this,b=this.ele.value||this.ele.val();return a._escapeHTML(b)},_checkType:function(a){return Object.prototype.toString.call(a).slice(8,-1)},_toString:function(a,b){var c=this;return"String"!==c._checkType(a)&&(b=c._checkType(a),"Number"===b?a+="":a="Function"===b?toString(a.call(a)):""),a},_escapeHTML:function(a){var b=this;return b._toString(a).replace(/&(?![\w#]+;)|[<>"']/g,function(a){return b._escapeMap[a]})},_trim:function(a){return a.replace(/(^\s+)|(\s+$)/gm,"")}};c.exports=function(a,b){return d.init(a,b)}}),define("new_toefl/tpl/favorite/favList.tpl",[],'{{if $data.list.length > 0}}\n    {{each $data.list as $value $index}}\n    <li class="favorite-lists js-favorite-lists favorite-icon {{if $index==0}}active{{/if}}" data-jtype="1" data-fid="{{$value.id}}">\n        <p class="favorite-name js-favorite-name">{{$value.name}}</p>\n\n    </li>\n    {{/each}}\n{{else}}\n    \x3c!--新建--\x3e\n    <li class="favorite-lists js-favorite-lists favorite-icon js-newFav active" data-jtype="2" data-fid="1">\n        <p class="favorite-name js-favorite-name">默认收藏夹</p>\n    </li>\n{{/if}}'),define("new_toefl/tpl/favorite/favorite.tpl",[],'\x3c!-- 新收藏功能弹窗元素 --\x3e\n<div id="js-kmf-favorite" class="g-new-favorite g-hide">\n    <div class="favorite-box g-mod-shadow">\n        <div class="favorite-title">\n            <h4 class="title js-favtitle"></h4>\n            <i class="close-btn favorite-icon js-fav-close"></i>\n        </div>\n        \x3c!--文件夹列表容器--\x3e\n        <div class="favorite-cont">\n            <ul class="favorite-list-cont js-list-cont">\n\n            </ul>\n            <span class="create-list js-create-list">+ 创建收藏夹</span>\n        </div>\n        <div class="favorite-btn-cont">\n            <span class="favorite-btns save-btn js-save-btn">保存</span>\n            <span class="favorite-btns cancel-btn js-fav-close">取消</span>\n        </div>\n    </div>\n</div>\n'),define("new_toefl/tpl/favorite/newFavList.tpl",[],'<li class="favorite-lists js-favorite-lists favorite-icon js-newFav" data-jtype="2" data-fid="{{$data}}">\n    <p class="favorite-name js-favorite-name"></p>\n    <div class="new-fav-cont js-new-fav-cont">\n        <input type="text" class="new-favorite-input js-favorite-input" maxlength="20" placeholder="输入收藏夹名称(20个字符以内)">\n        <i class="delete-btn favorite-icon js-delete-btn"></i>\n    </div>\n</li>'),define("new_toefl/tpl/intensive/popButton.tpl",[],'{{each toolList}}\n{{if $index > 0}}\n<span class="split">|</span>\n{{/if}}\n<a class="menu {{$value.className}}" data-qid="{{qid}}"><span class="toolicobg {{$value.className}}-ico"></span>{{$value.menu}}</a>\n{{/each}}\n<span class="arrow"></span>\n'),define("new_toefl/tpl/intensive/translate.tpl",[],'<div class="inner word-inner js-translate-inner">\n\t<div class="main">\n\t\t<p class="word">{{result.word}}</p>\n\t\t\x3c!-- <a class="btn-favorite intensive-icons{{if result.fav_status == -1}} js-kmf-login {{/if}} {{if result.fav_status == 1}}fav-ico-ed{{/if}}" id="js-translate-fav" data-op="{{result.fav_status}}" href="javascript:void(0)" data-type="13" data-word="{{result.word}}" data-handle="1" data-qid="{{result.qid}}"> --\x3e\n\t\t\t\x3c!-- <span class="actionbg intensive-icons {{if result.fav_status == 1}}fav-ico-ed{{else}}fav-ico{{/if}}"></span> --\x3e\n\t\t\t\x3c!-- <span class="menu-text">{{if result.fav_status == 1}}已收藏{{else}}收藏{{/if}}</span> --\x3e\n\t\t\x3c!-- </a> --\x3e\n\t\t<span class="btn-favorite intensive-icons{{if result.fav_status == -1}} js-kmf-login {{/if}} {{if result.fav_status == 1}}fav-ico-ed{{/if}}" id="js-translate-fav" data-op="{{result.fav_status}}" data-type="13" data-word="{{result.word}}" data-handle="1" data-qid="{{result.qid}}">\n\t\t\t\x3c!-- <span class="actionbg intensive-icons {{if result.fav_status == 1}}fav-ico-ed{{else}}fav-ico{{/if}}"></span> --\x3e\n\t\t\t\x3c!-- <span class="menu-text">{{if result.fav_status == 1}}已收藏{{else}}收藏{{/if}}</span> --\x3e\n\t\t</span>\n\t\t<div class="word-note intensive-icons js-original-notes{{if result.fav_status == -1}} js-kmf-login {{/if}}"></div>\n\t\t{{if result.phon}}\n\t\t<p class="sound">\n\t\t\t<span class="sound-mark">{{result.phon}}</span>\n\t\t\t{{if result.us_pron}}\n\t\t\t<a href="javascript:void(0)" class="word-icobg intensive-icons sound-ico js-word-play{{if !result.supportAudio}} js-kmf-tips{{/if}}" {{if !result.supportAudio}} data-msg="您的浏览器版本太低"{{/if}}></a>\n\t\t\t{{/if}}\n\t\t</p>\n\t\t{{/if}}\n        {{each result.translate as $value i}}\n\t\t<p class="zh">\n\t\t\t{{if i<2}}\n\t\t\t\t{{$value.property}}&nbsp;{{$value.cn_translate}}\n\t\t\t{{/if}}\n\t\t</p>\n        {{/each}}\n\t\t<a href="{{result.detail_url}}" target="_blank" class="more">更多详情>></a>\n\t</div>\n\t{{if result.isShowGuide}}\n\t<div class="dict-toefl js-dict-toefl">\n\t\t<p class="slogan-q">不认识单词影响做题效率?</p>\n\t\t<p class="slogan-a"><span class="g-g6">背熟真题词汇，做题时间减半！</span><a href="http://www.kmf.com/static/appcenter?website=toeflwords&s=chaci" class="more" target="_blank">更多详情>></a></p>\n\t\t<div class="app-wrapper">\n\t\t\t<div class="app-profile">\n\t\t\t\t<p class="app-name">考满分词汇App</p>\n\t\t\t\t<p class="app-desc g-g9">为TOEFL考试而生</p>\n\t\t\t</div>\n\t\t\t<p class="app-ps g-g6">\n\t\t\t\t扫描右方二维码即可使用\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class="guide-close">\n\t\t\t<a href="javascript:void(0)" class="lk-skip js-ignore">不再显示广告</a>\n\t\t</div>\n\n\t</div>\n\t{{/if}}\n</div>'),define("new_toefl/js/mod/intensive/exit_listen",["jquery"],function(a,b,c){var d=a("jquery");c.exports=function(a){var b={title:"提示",message:"确定退出此操作吗？",ele:".js-player-exit",text_confirm:"退出",text_cancel:"继续练习",type:1},c=d.extend({},b);"object"==typeof a?c=d.extend({},b,a):"string"==typeof a&&(c.message=a),d(document).delegate(c.ele,"click",function(){return c.type?(confirm_url=d(this).attr("href"),cancel_url="javascript:;"):(confirm_url=d(this).attr("href"),cancel_url=d(this).find("a").attr("href")),confirm({title:c.title,message:c.message,confirm:{text:c.text_confirm,url:confirm_url},cancel:{text:c.text_cancel,url:cancel_url}}),!1})}}),define("new_toefl/js/mod/intensive/original-ctrl",["jquery","new_toefl/js/mod/intensive/favorite"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/js/mod/intensive/favorite"),f={init:function(a){var b=this,a=a||{},c={style:{active:"active"},select:{login:"#GlobeLogin",qid:"#target_id",varsion:"#version",unique:"#js-examUnique",questionId:"#js-question_id",fid:"#fid",lid:"#lid",favType:"#favType",subject:"#subject",handle:"#handle",jtype:"#jtype",originalList:".list-original",favoriteLists:".js-collect-lists",favoriteList:".js-collect-list",closeCollect:".js-close-collect",collectCont:".original-detail-box .js-collect-cont",sentenceCont:".sentence-original-cont .js-collect-cont",sentenceTools:".sentence-tools",originalNote:".js-original-notes"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.getOriginalUrl="/ajax/drilling/info",a},getDom:function(){var a=this;return a.$login=d(a.select.login),a.$collectCont=d(a.select.collectCont),a.$sentenceCont=d(a.select.sentenceCont),a.$originalNote=d(a.select.originalNote),a},setVariable:function(){var a=this;return a.status=200,a.login=~~a.$login.val(),a.bFavSend=!1,a},bindEvent:function(){var a=this;return this.getOriginalStatus(),e(),"function"==typeof a.opt.noteEvent&&a.opt.noteEvent(),a},getOriginalStatus:function(){var a=this,b=a.select,c=[],e={qid:d(b.qid).val()};return a.$collectCont.each(function(a,b){var e=d(b),f=e.data("jid");c.push(f)}),e.lids=c.join(","),d.get(a.getOriginalUrl,e,function(b){var c=b.status,d=b.result;b.message;c==a.status&&a.setOriginalData(d)},"json"),a},setOriginalData:function(a){var b=this,c=a.favData,e=a.noteData,f=b.select,g=f.originalNote,h={0:"other",1:"hard",2:"voice",3:"good"},i={0:"其他",1:"长难句",2:"语音问题",3:"好句"};return c&&e?(b.$collectCont.each(function(a,j){var k=d(j),l=k.closest(f.originalList),m=l.find(g),n=b.$sentenceCont.eq(a),o=n.parent(b.select.sentenceTools).find(g),p=k.data("jid");for(var q in c){var r=c[q],s=~~r.isFav,t=r.favType;p==q&&(k.attr("data-fav",s),s&&k.attr("title",i[t]),n.attr("data-fav",s),s&&n.attr("title",i[t]),s&&k.addClass(h[t]),s&&n.addClass(h[t]))}for(var q in e){var r=e[q],u=~~r.isNote,v=JSON.stringify(r);p==q&&(m.attr("data-note",u),m.attr("data-content",v),u&&m.addClass("notes"),o.attr("data-note",u),o.attr("data-content",v),u&&o.addClass("notes"))}}),b):b}};c.exports=function(a){return f.init(a)}}),define("new_toefl/js/mod/intensive/favorite",["jquery"],function(a,b,c){var d=a("jquery"),e={init:function(a){var b=this,a=a||{},c={style:{active:"active"},select:{login:"#GlobeLogin",qid:"#target_id",varsion:"#version",unique:"#js-examUnique",questionId:"#js-question_id",fid:"#fid",lid:"#lid",favType:"#favType",subject:"#subject",handle:"#handle",jtype:"#jtype",actionBtns:".origin-action-buttons",favorite:".js-original-collect",favoriteLists:".js-collect-lists",favoriteList:".js-collect-list",closeCollect:".js-close-collect",collectCont:".js-collect-cont",sentenceLi:".sentence-original-cont .js-collect-cont",fullLi:".listen-original-cont .js-collect-cont"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.favAjax="/record/ajaxaddfavorite",a.unFavAjax="/record/ajaxcancelfavorite",a},getDom:function(){var a=this;return a.$login=d(a.select.login),a.$collectCont=d(a.select.collectCont),a.$collectList=d(a.select.favoriteList),a.$closeBtn=a.$collectCont.find(a.select.closeCollect),a.$actionBtns=d(a.select.actionBtns),a.$sentenceLi=d(a.select.sentenceLi),a.$fullLi=d(a.select.fullLi),a},setVariable:function(){var a=this;return a.status=200,a.login=~~a.$login.val(),a.bFavSend=!1,a._title={0:"其他",1:"长难句",2:"语音问题",3:"好句"},a._className={0:"other",1:"hard",2:"voice",3:"good"},a},bindEvent:function(){var a=this;return a.favEvent(),a._collectListEvent(),a._closeListEvent(),a},favEvent:function(){var a=this;return a.$collectCont.on("click",function(b){var c=d(this),e=~~c.attr("data-fav");if(a.login)return e?a._unfavorite(c):(a.$collectCont.removeClass("active"),c.addClass("active"),a.$actionBtns.removeClass("active"),c.closest(a.select.actionBtns).addClass("active")),!1}),a},_collectListEvent:function(){var a=this;return a.$collectList.off().on("click",function(){var b=d(this);b.data("type");return a._sendFavData(b),!1}),a},_closeListEvent:function(){var a=this;return a.$closeBtn.off().on("click",function(){var b=d(this),c=b.closest(a.select.collectCont);return c.removeClass("active"),c.find(a.select.favorite).removeClass("active"),!1}),a},_sendFavData:function(a){var b=this,c=b.select,e=a.closest(c.collectCont),f=e.closest(".origin-action-buttons"),g=e.data("jid"),h={lid:d(c.lid).val(),type:d(c.favType).val(),sentenceType:a.data("type"),subject:d(c.subject).val(),jid:g,qid:d(c.qid).val(),handle:d(c.handle).val(),jtype:d(c.jtype).val(),fid:d(c.fid).val()};return e.removeClass("active"),f.size()&&f.removeClass("active"),d.post(b.favAjax,h,function(c){if(1==c.status){var d=a.data("type"),f=b._title[d],h=b._className[d];e.addClass(h),e.attr("data-fav",1),e.attr("title",f),b.updateFavState(e,g,h,f)}else alert("收藏失败了~~<br/>T_T")},"json"),b},_unfavorite:function(a){var b=this,c=b.select,e=a.data("jid"),f={type:d(c.favType).val(),jid:e};return b.bFavSend?b:(b.bFavSend=!0,d.post(b.unFavAjax,f,function(c){200==c.status?(a.removeClass("hard voice good other"),a.attr("data-fav",0),a.removeAttr("title"),b.updateFavState(a,e)):alert("取消收藏失败了~<br/>O_O"),b.bFavSend=!1},"json"),b)},updateFavState:function(a,b,c,e){var f=this;a.closest(".listen-original-cont").size()?d.each(f.$sentenceLi,function(a,f){var g=d(f);if(g.data("jid")==b)return c?(g.addClass(c),g.attr("data-fav",1),g.attr("title",e)):(g.removeClass("hard voice good other"),g.attr("data-fav",0),g.removeAttr("title")),!1}):d.each(f.$fullLi,function(a,f){var g=d(f);if(g.data("jid")==b)return c?(g.addClass(c),g.attr("data-fav",1),g.attr("title",e)):(g.removeClass("hard voice good other"),g.attr("data-fav",0),g.removeAttr("title")),!1})}};c.exports=function(a){return e.init(a)}}),define("new_toefl/js/mod/intensive/note-event",["jquery","new_toefl/kmf_components/xss-filter/main","new_toefl/js/util/drag"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/kmf_components/xss-filter/main");a("new_toefl/js/util/drag");var f={init:function(a){var b=this,a=a||{},c={style:{active:"active"},select:{parentBox:".js-container",noteDelete:".js-note-delete",addNote:".add-sentence-icon"},login:~~d("#GlobeLogin").val()};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.ajaxSaveNote="/record/ajaxaddusernotes",a.ajaxEditNote="/record/ajaxmodifyusernotes",a},getDom:function(){var a=this;return a.$dom=d(document),a.$body=d("body"),a.$type=d("#type"),a.$parentId=d("#target_id"),a.$originalNote=d(".js-original-notes"),a.$parentBox=d(a.select.parentBox),a},setVariable:function(){var a=this;if(a.status=200,a.data={},a.authkey=d.cookie("authkey"),a.bSave=!1,a.bEdit=!1,a.type=a.$type.val(),a.parentId=a.$parentId.val(),a.login=a.opt.login,a.savePause=5e3,a.saveSwitch=null,a.saveInterval=null,a.deleteIndex=null,a.editHasNote=!1,a.opt.parent){var b=a.opt.parent.closest(".paragraph-sentence");if(b.size())a.targetId=b.data("id"),a.noteBtn=b.find(".origin-action-buttons").find(".js-original-notes");else{var c=a.opt.parent.closest(".listen-sentence-list");a.targetId=c.data("id"),a.noteBtn=c.find(".sentence-tools").find(".js-original-notes")}}return a},bindEvent:function(){var a=this;return a._noteEvent(),a},_deleteNote:function(a,b){var c=this;d(c.select.noteDelete).off("click").on("click",function(b){var e=JSON.parse(a.attr("data-content")),f=d(this),g=f.closest(".word-note");if(g.size()){var h=g.data("nid"),i=window.kmfGlobalConf.prefix+"api.kmf.com/toefl-app/drilling/notes/"+h;d.ajax({type:"DELETE",url:i,beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+c.authkey),a.setRequestHeader("K-Product-Line","toefl-web")},success:function(b){if(200==b.status){var g=e.word.length;f.closest(".word-note").remove();var i=e.word;d.each(i,function(a,b){if(b.noteId==h)return c.deleteIndex=a,e.word.splice(a,1),!1});var j=d(".sentence-note-area").eq(0).find(".note-num"),k=1*j.text();if(d(".sentence-note-area .note-num").text(k-1),c.deleteIndex==g-1);else for(var l=d(".word-note"),m=0;m<l.length;m++){var n=l.eq(m).find(".note-num"),o=1*n.text();1!=o&&n.text(o-1)}e.word.length||e.sentence.length||(a.removeClass("notes"),a.attr("data-note",0)),a.attr("data-content",JSON.stringify(e))}}})}else{var j=f.closest(".sentence-note-area"),h=j.data("nid"),i=window.kmfGlobalConf.prefix+"api.kmf.com/toefl-app/drilling/notes/"+h;d.ajax({type:"DELETE",url:i,beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+c.authkey),a.setRequestHeader("K-Product-Line","toefl-web")},success:function(b){if(200==b.status){j.remove(),d(".word-add-sentence").removeClass("none"),e.sentence=[];var c=d(".word-add-sentence .sentence-note-area"),f=c.attr("data-nid"),g=c.data("nid");f?c.removeAttr("data-nid"):g&&c.data("nid",null),c.find(".js-note-textarea").val(null),e.word.length||e.sentence.length||(a.removeClass("notes"),a.attr("data-note",0)),a.attr("data-content",JSON.stringify(e))}}})}})},_noteEvent:function(){var b=this;return b.$originalNote.off("click").on("click",function(){var c=d(".g-word-tool");c.size()&&(c.hide(),d(".js-origin-main").data("word",!1));var e,f,g,h=d(this),i=~~h.attr("data-note"),j=h.attr("data-content"),k=d(".js-note-dialog");j&&(j=JSON.parse(j));var l={isNote:i,content:j,hasWord:b.opt.word};if(!h.hasClass("js-kmf-login")&&b.login)return b._removeDialog(k),b.editHasNote=!1,e=a("new_toefl/tpl/intensive/note-dialog.tpl"),f=template.compile(e),g=f(l),b.$body.append(g),b._initDialogEvent(h),!1}),b},_initDialogEvent:function(a){var b=this,c=d(".js-note-dialog"),e=c.find(".js-note-textarea");b._textareaEvent(a,c);var f=e.eq(0);return 1!=f.data("type")&&2!=f.data("type")||f.focus(),b._dialogDragEvent(c),b._closeDialogEvent(a,c),b._addSentenceNote(a,c),b._deleteNote(a,c),d.each(e,function(a,c){b._makeExpandingArea(c)}),b},_addSentenceNote:function(a,b){var c=this;b.find(c.select.addNote).on("click",function(){var a=d(this),b=a.parents(".word-add-sentence");a.parent().hide(),b.find(".sentence-note-area").show(),b.find(".note-textarea").focus()})},_makeExpandingArea:function(a){var b=function(a){a.style.height="auto",a.style.height=a.scrollHeight+"px"},c=function(a){window.setTimeout(function(){b(a)},0)};a.addEventListener?(a.addEventListener("input",function(){b(a)},!1),b(a)):a.attachEvent&&(a.attachEvent("onpropertychange",function(){b(a)}),b(a)),window.VBArray&&window.addEventListener&&(a.attachEvent("onkeydown",function(){var b=window.event.keyCode;8!=b&&46!=b||c(a)}),a.attachEvent("oncut",function(){c(a)}))},_saveNodeEvent:function(a,b,c){var d=this;return d.saveInterval&&(clearInterval(d.saveInterval),d.saveInterval=null),d.saveInterval=setInterval(function(){var e=a.data("type"),f=a.val(),g=b.data("tid");f.trim()&&d._savingEvent(a,e,f,g,b,c)},d.savePause),d},_savingEvent:function(a,b,c,f,g,h){var i=this;if(1==b){var j=a.closest(".note-cont"),k=j.data("word"),l=j.attr("data-nid"),m=null,n=JSON.parse(i.noteBtn.attr("data-content")).word;d.each(n,function(d,f){if(f.noteSource==k){var g=f.noteId,j={nid:g,content:e(c,{trim:!0})};return i.editHasNote=!0,i._sendEditData(j,a,i.noteBtn,h,b),!1}}),i.editHasNote||(l?(m={nid:l,content:e(c,{trim:!0})},i._sendEditData(m,a,i.noteBtn,h,b)):(m={target_id:i.targetId,parent_id:i.parentId,type:3,source:k,content:e(c,{trim:!0}),source_port:d("#source_port").val()},i._sendSaveData(m,a,i.noteBtn,h,b)))}else if(2==b){var j=a.closest(".note-cont"),l=j.attr("data-nid"),m=null;l?(m={nid:l,content:e(c,{trim:!0})},i._sendEditData(m,a,g,h,b)):(m={target_id:f,parent_id:i.parentId,type:d("#type").val(),content:e(c,{trim:!0}),source_port:d("#source_port").val()},i._sendSaveData(m,a,g,h,b))}else if(3==b){var l=a.closest(".word-note").data("nid"),o={nid:l,content:e(c,{trim:!0})};i._sendEditData(o,a,g,h,b)}else if(4==b){var l=a.closest(".sentence-note-area").data("nid"),o={nid:l,content:e(c,{trim:!0})};i._sendEditData(o,a,g,h,b)}else{var p=a.closest(".sentence-note-area"),l=p.attr("data-nid"),m=null;l?(m={nid:l,content:e(c,{trim:!0})},i._sendEditData(m,a,g,h,b)):(m={target_id:f,parent_id:i.parentId,type:d("#type").val(),content:e(c,{trim:!0}),source_port:d("#source_port").val()},i._sendSaveData(m,a,g,h,b))}},_sendSaveData:function(a,b,c,e,f){var g=this,h=a.source,i=JSON.parse(c.attr("data-content"));return d.post(g.ajaxSaveNote,a,function(d){var g=d.result;if(1==d.status){var j={noteId:g.noteid,noteContent:a.content};1==f?(j.noteSource=h,i.word.push(j),b.closest(".note-cont").attr("data-nid",g.noteid)):2==f?(i.sentence=j,b.closest(".note-cont").attr("data-nid",g.noteid)):5==f&&(b.parent().find(".note-delete-icon").show(),i.sentence=j,b.closest(".sentence-note-area").attr("data-nid",g.noteid)),c.attr("data-note",1),e.data("note",1),c.attr("data-content",JSON.stringify(i)),c.addClass("notes")}},"json"),g},_sendEditData:function(a,b,c,e,f){var g=this,h=JSON.parse(c.attr("data-content"));return 3==f&&b.index(),d.post(g.ajaxEditNote,a,function(b){var e=b.status;b.result;if(1==e){if(1==f){var g=h.word;d.each(g,function(b,c){if(a.nid==c.noteId)return c.noteContent=a.content,h.word.splice(b,1,c),!1})}else if(2==f)h.sentence.noteContent=a.content;else if(3==f){var g=h.word;d.each(g,function(b,c){if(a.nid==c.noteId)return c.noteContent=a.content,h.word.splice(b,1,c),!1})}else h.sentence.noteContent=a.content;c.attr("data-content",JSON.stringify(h))}},"json"),g},_editNodeEvent:function(a){var b=this,c=a.find(".js-edit-note"),d=a.find(".js-note-textarea");return c.off("click").on("click",function(){a.removeClass("edit"),d.removeAttr("readonly"),b._textRangeToEnd(d[0])}),b},_textareaEvent:function(a,b){var c=this,e=b.find(".js-note-textarea");return b.on("focus",".js-note-textarea",function(){var e=d(this);sessionStorage.setItem("hasNoteDialog",!0),e.removeClass("edit-note"),b.removeClass("warn"),c._saveNodeEvent(e,a,b)}),e.off("blur").on("blur",function(){var e=d(this),f=e.data("type"),g=e.val(),h=a.data("tid");sessionStorage.setItem("hasNoteDialog",!1),e.addClass("edit-note"),b.removeClass("warn"),clearInterval(c.saveInterval),c.saveInterval=null,g.trim()&&c._savingEvent(e,f,g,h,a,b)}),c},_dialogDragEvent:function(a){var b=this;return a.drag({parent:"body",handler:".js-note-drag"}),b},_closeDialogEvent:function(a,b){var c=this;return b.find(".js-close-note").off("click").on("click",function(){var e=(d(this),a.data("tid")),f=b.find(".js-note-textarea");c.opt.word&&(c.opt.word=null),c._removeDialog(b),d.each(f,function(f,g){var h=d(g),i=h.data("type"),j=h.val();"none"!=h.parent().css("display")&&j.trim()&&c._savingEvent(h,i,j,e,a,b)})}),c},_removeDialog:function(a){var b=this;return a.remove(),d(document).off(".dragUp"),d(document).off(".dragMove"),b},_textRangeToEnd:function(a){a.focus();var b=a.value.length;if(document.selection){var c=a.createTextRange();c.moveStart("character",b),c.collapse(),c.select()}else"number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd&&(a.selectionStart=a.selectionEnd=b);return a}};c.exports=function(a){return f.init(a)}}),define("new_toefl/kmf_components/xss-filter/main",[],function(a,b,c){var d={init:function(a,b){var c=this;if(a){if("String"!=c._checkType(a))throw new Error("error:参数错误");return c.value=a,c.opt={trim:!1,unescape:!1},$.extend(c.opt,b),c.opt.trim?c._trim(c._textDispose()):c._textDispose()}},_escapeMap:{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},_unescapeMap:{"&#60;":"<","&#62;":">","&#34;":'"',"&#39;":"'","&#38;":"&"},_textDispose:function(){var a=this;return a.opt.unescape?a._unescapeHTML(a.value):a._escapeHTML(a.value)},_checkType:function(a){return Object.prototype.toString.call(a).slice(8,-1)},_toString:function(a,b){var c=this,b=c._checkType(a);return"String"!==b&&("Number"===b?a+="":a="Function"===b?toString(a.call(a)):""),a},_escapeHTML:function(a){var b=this;return b._toString(a).replace(/&(?![\w#]+;)|[<>"']/g,function(a){return b._escapeMap[a]})},_unescapeHTML:function(a){var b=this;return b._toString(a).replace(/\&#60;|\&#62;|\&#34;|\&#39;/g,function(a){return b._unescapeMap[a]})},_trim:function(a){return a.replace(/(^\s+)|(\s+$)/gm,"")}};c.exports=function(a,b){return d.init(a,b)}}),define("new_toefl/js/util/drag",["jquery"],function(a,b,c){var d=a("jquery"),e=function(a,b){this.$ele=a,this.x=0,this.y=0,this.defaults={parent:"parent",position:"random",direction:"all",handler:!1,dragStart:function(a,b){},dragEnd:function(a,b){},dragMove:function(a,b){}},this.options=d.extend({},this.defaults,b)};e.prototype={run:function(){function a(){r=m.outerWidth(),s=m.outerHeight(),t=i.outerWidth(),u=i.outerHeight()}function b(){var a=r-t,b=s-u;if("random"==j){var c=parseInt(Math.random()*a),d=parseInt(Math.random()*b);"x"==k.toLowerCase()?i.css({left:c}):"y"==k.toLowerCase()?i.css({top:d}):i.css({left:c,top:d})}"object"!=typeof j||Array.isArray(j)||(j.x=j.x<0?0:j.x,j.x=j.x>a?a:j.x,j.y=j.y<0?0:j.y,j.y=j.y>b?b:j.y,i.css({left:j.x,top:j.y}))}function c(a){o.dragEnd(parseInt(i.css("left")),parseInt(i.css("top"))),i.removeClass("on"),n=!1}function e(a){function b(){if(1==n)return i.css({left:f}),f<0&&i.css({left:0}),f>r-t&&i.css({left:r-t}),f}function c(){if(1==n)return i.css({top:g}),g<0&&i.css({top:0}),g>s-u&&i.css({top:s-u}),g}function d(){1==n&&(i.css({left:f,top:g}),f<0&&i.css({left:0}),f>r-t&&i.css({left:r-t}),g<0&&i.css({top:0}),g>s-u&&i.css({top:s-u}))}if(f=h.x+a.pageX-p,g=h.y+a.pageY-q,!n)return!1;o.dragMove(parseInt(i.css("left")),parseInt(i.css("top"))),"x"==k.toLowerCase()?b():"y"==k.toLowerCase()?c():d()}var f,g,h=this,i=this.$ele,j=this.options.position,k=this.options.direction,l=this.options.handler,m=this.options.parent,n=!1,o=this.options,p=0,q=0;i.find("*").not("img").mousedown(function(a){a.stopPropagation()}),m="parent"==m?i.parent():i.parents(m),l=l?i.find(l):i,m.css({position:"relative"}),i.css({position:"absolute"});var r=0,s=0,t=0,u=0;a(),j&&b(),d(window).resize(function(){a(),j&&b()}),l.css({cursor:"move"}).mousedown(function(a){return n=!0,p=a.pageX,q=a.pageY,h.x=i.position().left,h.y=i.position().top,i.addClass("on"),o.dragStart(parseInt(i.css("left")),parseInt(i.css("top"))),!1}),d(document).off(".dragUp").on("mouseup.dragUp",c),d(document).off(".dragMove").on("mousemove.dragMove",e)}},d.fn.drag=function(a){return new e(this,a).run(),this},c.exports=function(a,b){return new e(a,b).run(),a}}),define("new_toefl/tpl/intensive/note-dialog.tpl",[],'\x3c!--笔记弹窗(edit:编辑笔记,succ:保存成功,error:保存失败,warn:内容不能为空)--\x3e\n\x3c!--输入框加上自定义属性，表示是哪种添加笔记--\x3e\n\x3c!--1表示划词添加笔记   2首次添加句子笔记  3划词笔记编辑 4句子笔记编辑 5有划词笔记的情况添加句子笔记--\x3e\n<div class="note-dialog js-note-dialog" data-note="{{isNote}}">\n    <div class="note-title js-note-drag">\n        <span class="note-title-msg"><b class="font-blod">我的笔记</b>（笔记框可以拖拽哦~）</span>\n        <span class="close-note intensive-icons js-close-note"></span>\n    </div>\n    {{if hasWord || !isNote}}\n    <div class="note-cont start-add" data-word="{{hasWord}}">\n        <textarea class="note-textarea js-note-textarea" placeholder="快来写笔记吧~" value="{{content}}" data-type="{{hasWord ? 1 : 2}}"\n            data-index="0">{{content}}</textarea>\n        \x3c!-- <div class="note-ctrls">\n            <div class="note-tips">\n                <div class="note-tip js-note-tip succ">保存成功!</div>\n                <div class="note-tip js-note-tip error">保存失败~</div>\n                <div class="note-tip js-note-tip warn">内容不能为空~</div>\n            </div>\n        </div> --\x3e\n    </div>\n    {{else}}\n    <div class="note-cont">\n        \x3c!--笔记区域划词笔记--\x3e\n        {{if content.word.length}}\n        <div class="word-note-area">\n            \x3c!--循环--\x3e\n            {{each content.word as $value i}}\n            <div class="word-note" data-nid="{{$value.noteId}}">\n                <span class="word-note-title"><em class="note-num">{{i+1}}</em>. {{$value.noteSource}}</span>\n                \x3c!--删除icon--\x3e\n                <span class="note-delete-icon common-back js-note-delete"></span>\n                <textarea class="note-textarea js-note-textarea edit-note" placeholder="快来写笔记吧~" value="{{$value.noteContent}}"\n                    data-type="3" data-index="{{i}}">{{$value.noteContent}}</textarea>\n            </div>\n            {{/each}}\n        </div>\n        {{/if}}\n        \x3c!--没有整句笔记--\x3e\n        <div class="word-add-sentence {{if content.sentence[\'noteId\']}} none {{/if}}">\n            <div class="add-sentence-note"><em class="add-sentence-icon common-back"></em>添加整句笔记</div>\n            <div class="sentence-note-area" style="display:none;">\n                <span><em class="note-num">{{content.word.length ? content.word.length +1 : 1}}</em>. 整句</span>\n                <span class="note-delete-icon common-back js-note-delete" style="display:none;"></span>\n                <textarea class="note-textarea js-note-textarea edit-note" placeholder="快来写笔记吧~" value="{{content.sentence.noteContent}}"\n                    data-type="5" data-index="{{content.word.length ? content.word.length : 0}}">{{content.sentence.noteContent}}</textarea>\n            </div>\n        </div>\n        {{if content.sentence[\'noteId\']}}\n        \x3c!--笔记区域句子笔记--\x3e\n        <div class="sentence-note-area" data-nid="{{content.sentence.noteId}}">\n            <span><em class="note-num">{{content.word.length ? content.word.length +1 : 1}}</em>. 整句</span>\n            <span class="note-delete-icon common-back js-note-delete"></span>\n            <textarea class="note-textarea js-note-textarea edit-note" placeholder="快来写笔记吧~" value="{{content.sentence.noteContent}}"\n                data-type="4" data-index="{{content.word.length ? content.word.length : 0}}">{{content.sentence.noteContent}}</textarea>\n        </div>\n        {{/if}}\n        \x3c!-- <div class="note-ctrls">\n            <div class="note-tips">\n                <div class="note-tip js-note-tip succ">保存成功!</div>\n                <div class="note-tip js-note-tip error">保存失败~</div>\n                <div class="note-tip js-note-tip warn">内容不能为空~</div>\n            </div>\n        </div> --\x3e\n    </div>\n    {{/if}}\n</div>'),define("new_toefl/js/mod/intensive/nice-research",["jquery"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/tpl/intensive/researchCard.tpl"),f={init:function(a){var b=this,a=a||{},c={style:{active:"active"},select:{outerBox:".g-kmf-wrapper",contentBox:".original-box",fullSentence:".sentence-content",eachSentence:".sentence-detail-content",researchEl:".nice-research",niceHover:".js-hover-card",hoverBox:".nice-research-container"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.ajaxResearve=window.kmfGlobalConf.prefix+"api.kmf.com/toefl-app/listen/sentence/getTag",a},getDom:function(){var a=this;return a.$outerBox=d(a.select.outerBox),a.$contentBox=d(a.select.contentBox),a.$researchEl=d(a.select.researchEl),a.$fullSentence=d(a.select.fullSentence),a.$eachSentence=d(a.select.eachSentence),a},setVariable:function(){var a=this;return a.status=200,a.login=~~d("#GlobeLogin").val(),a.authkey=d.cookie("authkey"),a.userid=d("#GLOBALPID").val(),a.username=d("#GLOBALNAME").val(),a.researchList=a.opt.niceList,a.clientHeight=document.documentElement.clientHeight,a.researveObj={},a.researchType={0:"连读",1:"弱读缩读",2:"口音",3:"易混音"},a},bindEvent:function(){var a=this;return a._showCard(),a._initCardBox(),a},_initCardBox:function(){var a=this;d(a.select.hoverBox).size()||d("body").append('<div class="nice-research-container"></div>');return a},_researchContent:function(){var a=this;return d.each(a.$researchEl,function(b,c){var e=d(c).data("jid"),f=a.researchList[e],g=d(".listen-sentence-list[data-id="+e+"]").index(),h=a.$fullSentence.eq(g),i=h.html(),j=a.$eachSentence.eq(g);d.each(f,function(a,b){var c=new RegExp(b.text,"g");i=i.replace(c,function(c,d){if(c==b.text&&d==b.index+41*a)return'<em class="nice-card js-hover-card">'+c+"</em>"})}),h.html(i),j.html(i)}),a},_showCard:function(){var a=this;return a.$contentBox.delegate(a.select.niceHover,"mouseover",function(){d(a.select.hoverBox).hide(),clearTimeout(a.personTimer);var b,c,e=d(this),f=e.parent();if(a.pageX=e.offset().left+e.width()+16,a.pageY=e.offset().top-16,b=f.hasClass("sentence-content")?f.closest(".paragraph-sentence"):f.closest(".listen-sentence-list"),!b.hasClass("hide-original"))if(c=b.data("id"),b.data("hovering",!0),d(a.select.hoverBox).html("").addClass("loading"),a.researveObj[c])a._renderCard(a.researveObj[c]);else{if(b.data("getdata"))return;b.data("getdata",!0),d(a.select.hoverBox).css({left:a.pageX,top:a.pageY}).show(),d.ajax({url:a.ajaxResearve,type:"get",dataType:"json",data:{sentence_id:c},beforeSend:function(a){a.setRequestHeader("K-Product-Line","toefl-web"),a.setRequestHeader("K-Platform","web")},success:function(d){if(d.status==a.status){a.researveObj[c]=d.result;if(!b.data("hovering"))return;a._renderCard(a.researveObj[c])}},complete:function(){b.data("getdata",!1)}})}}),a.$contentBox.delegate(a.select.niceHover,"mouseleave",function(){var b,c=d(this),e=c.parent();b=e.hasClass("sentence-content")?e.closest(".paragraph-sentence"):e.closest(".listen-sentence-list"),clearTimeout(a.personTimer),a.personTimer=setTimeout(function(){d(a.select.hoverBox).hide(),b.data("hovering",!1)},100)}),d(document).delegate(a.select.hoverBox,"mouseover",function(){clearTimeout(a.personTimer),d(a.select.hoverBox).show()}),d(document).delegate(a.select.hoverBox,"mouseleave",function(){d(this).hide(),d(".listen-sentence-list[data-hovering=true]").data("hovering",!1),d(".paragraph-sentence[data-hovering=true]").data("hovering",!1)}),a},_renderCard:function(a){var b=this;a.researchType=b.researchType,a.appLink=window.kmfGlobalConf.prefix+"www.kmf.com/static/appcenter?website=toefl";var c=template.compile(e),f=c(a);d(b.select.hoverBox).removeClass("loading").html(f),d(".nice-research-info *").removeAttr("style"),b.clientHeight-b.pageY<d(b.select.hoverBox).height()&&(b.pageY=b.pageY-(b.clientHeight-b.pageY)),d(b.select.hoverBox).css({left:b.pageX,top:b.pageY}).show()}};c.exports=function(a){return f.init(a)}}),define("new_toefl/tpl/intensive/researchCard.tpl",[],'<div class="nice-research-content">\n    <h4 class="nice-research-type">语音现象：{{small_cate}}</h4>\n    {{if explain}}\n    <div class="nice-research-info">{{#explain}}</div>\n    {{/if}}\n</div>\n{{if small_cate == researchType[0]}}\n<div class="knowledge-card">\n    <h3 class="knowledge-card-type">{{researchType[0]}}知识卡片</h3>\n    <p class="knowledge-card-info">托福听力中的连读通常是以下几种：</p>\n    <p class="knowledge-card-info">1 辅音+元音连读，前辅后元直接连。</p>\n    <p class="knowledge-card-info">2 同类音连读，相同两个辅音前后相连，只发一次。</p>\n    <p class="knowledge-card-info">3 失爆连读，[p] [b] [t] [d] [k] [ɡ] 六大爆破音前后相连，前音失爆。</p>\n    <p class="knowledge-card-info">精听时应留心观察连读现象，体会规律性，多做跟读模仿。</p>\n    <p class="app-link-text">使用 <a href="{{appLink}}" class="app-link">托福考满分 App</a> 进行更多精研练习</p>\n</div>\n{{else if small_cate == researchType[1]}}\n<div class="knowledge-card">\n    <h3 class="knowledge-card-type">{{researchType[1]}}知识卡片</h3>\n    <p class="knowledge-card-info">\n        弱读/缩读通常发生在介词、连词、代词等不太重要的单词，但有时候，弱读/缩读会发生在词组中，发生在关键词附近，阻碍你对重要细节的理解。该此处选取的弱读/缩读现象都与重要内容的理解相关。建议多做跟读练习，体会规律性。</p>\n    <p class="app-link-text">使用 <a href="{{appLink}}" class="app-link">托福考满分 App</a> 进行更多精研练习</p>\n</div>\n{{else if small_cate == researchType[2]}}\n<div class="knowledge-card">\n    <h3 class="knowledge-card-type">{{researchType[2]}}知识卡片</h3>\n    <p class="knowledge-card-info">托福听力素材以美音为主，偶有英音及其他口音。此处将标识以下特色美音发音及口音变化规律：</p>\n    <p class="knowledge-card-info">英音 [ɒ] / 美音 [ɑ]  例：pot </p>\n    <p class="knowledge-card-info">英音 [ɑː]  / 美音 [æ]  例： pass</p>\n    <p class="knowledge-card-info">英音 [eɪ]  / 美音 [e]  例： data </p>\n    <p class="knowledge-card-info">英音 [juː] / 美音 [u]  例： due</p>\n    <p class="knowledge-card-info">[aɪ] /  [ɪ] 互换 例：diversity</p>\n    <p class="knowledge-card-info">[dʒ] / [g] 互换 例：fungi</p>\n    <p class="knowledge-card-info">重音位置变化 例： garage</p>\n    <p class="app-link-text">使用 <a href="{{appLink}}" class="app-link">托福考满分 App</a> 进行更多精研练习</p>\n</div>\n{{else if small_cate == researchType[3]}}\n<div class="knowledge-card">\n    <h3 class="knowledge-card-type">{{researchType[3]}}知识卡片</h3>\n    <p class="knowledge-card-info">\n        无论是否包括语音现象，有些细节内容很容易听不清，或者错听成无关内容。此处选取的都是我们中国同学易混易错听不清的细节内容。精听时多留心，着重练习此处。</p>\n    <p class="app-link-text">使用 <a href="{{appLink}}" class="app-link">托福考满分 App</a> 进行更多精研练习</p>\n</div>\n{{/if}}');