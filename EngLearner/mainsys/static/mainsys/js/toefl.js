define("new_toefl/js/channel/toefl",["jquery","../mod/word/screen_word","../mod/word/note","../../tpl/word/note.tpl","../mod/word/drag","../util/new_favorite","../util/form-textarea","../../tpl/favorite/favList.tpl","../../tpl/favorite/favorite.tpl","../../tpl/favorite/newFavList.tpl","../../tpl/word/popButton.tpl","../../tpl/word/translate.tpl","../mod/statistics/userInformation","raphael","../mod/toefl-login","../../tpl/toefl-login.tpl","../util/loginGuide","../../tpl/login_guide.tpl","../mod/sign-in/judge-sign-in","../../tpl/login/logintips.tpl","../mod/learn/toefl-top-publicize","../mod/rank/rank-list","../../kmf_components/usercard/main","../../kmf_components/usercard/tpl/usercard-new.tpl","../mod/rank/level-up","../mod/rank/up-pie","../../tpl/rank/bang-list.tpl","../mod/learn/info-acq","../mod/learn/testTravlePlan","../util/nav-list","../mod/personal-center-in/personal-center-in","../../tpl/personal-center-in/personal-center-in.tpl","../../tpl/ets-video.tpl"],function(a,b,c){var d=a("jquery"),e=a("../mod/word/screen_word"),f=a("../mod/statistics/userInformation"),g=a("../mod/toefl-login");a("../util/loginGuide"),a("../mod/sign-in/judge-sign-in"),a("../mod/learn/toefl-top-publicize"),a("../mod/rank/rank-list")(),a("../mod/learn/info-acq"),a("../util/nav-list"),a("../mod/personal-center-in/personal-center-in"),g();var h=d("#roundCount");if(f({size:h.data("size"),name:h.data("name"),txt:h.data("txt"),day:h.data("day")}),new e(".js-translate-content"),location.host.indexOf("kmf.com")<0){var i=d("#GlobeSiteUrl").val()||"https://toefl.kmf.com";location.href=i}d(".js-ets-player-show");d(document).on("click",".js-ets-player-show",function(){var b=a("../../tpl/ets-video.tpl"),c=template.compile(b),e=c();d("body").append(e);var f=d(this).data("vid"),g=(polyvPlayer({wrap:"#ets-player",width:800,height:533,vid:f}),d(".ets-player-mask"));d(".js-ets-player-close").on("click",function(){g.remove()})}),c.exports={userPannel:f}}),define("new_toefl/js/mod/word/screen_word",["jquery","new_toefl/js/mod/word/note","new_toefl/js/mod/word/drag","new_toefl/js/util/new_favorite","new_toefl/js/util/form-textarea"],function(a,b,c){function d(a,b){for(var c in b)a[c]?alert("划词功能扩展时存在相同方法或属性！"):a[c]=b[c]}var e=a("jquery"),f=a("new_toefl/js/mod/word/note"),g=a("new_toefl/js/mod/word/drag"),h=a("new_toefl/js/util/new_favorite"),i=function(a,b){var c=e(document);this.ele=a,this.dSty="js-word-disabled",this.elements=e(a),this.eleLayer="#js-word-translate-layer",this.init(),this.noteInit(),this.url="/vocab/ajaxquery?word=",this.favUrl="/vocab/ajaxfavword",this.curWord="",this.$startEle=null,this.$endEle=null,this.noteHide=e("#noteHide").val()||0,this.offset=10,this.winWidth=c.width(),this.winHeight=c.height()};i.prototype={status:{loading:!1,fav:!1,$targetEle:{},selectId:[]},init:function(){0!==this.elements.length&&(this.createButton(),h({ele:"",s_icon:".actionbg",iconSty:"fav-ico-ed",eles:["#js-translate-fav"]}),this.setup())},setup:function(){var a=this,b=null,c=this.eleLayer;e(document).on("mouseup",function(c){var d=e(c.target).closest(a.ele);return b&&(clearTimeout(b),b=null),a.checkLayer.call(a,c)||a.closeLayer(),a.checkEle.call(a,c)?(b=setTimeout(function(){a.checkWord.call(a,d)},100),c.stopPropagation(),c.preventDefault(),!1):void a.hideButton()}),e(this.popButton).on("mousedown",function(a){return a.stopPropagation(),a.preventDefault(),!1}),e(document).delegate(".js-translate-inner","mousedown",function(a){return a.stopPropagation(),a.preventDefault(),!1}),e(this.popButton).on("click",".word",function(b){var c=e(this),d=c.data("qid");return a.openLayer().render(d),b.stopPropagation(),b.preventDefault(),!1}),e(document).delegate(".js-word-play","click",function(){a.phonEvent(e(this))}),g(c,{handleEle:".js-translate-dragHandle"}),e(document).on("click",".js-ignore",function(){e(".js-dict-toefl").hide(),e.cookie("kmfdictguide","1",{expires:10,path:"/"})})},resetCurEle:function(){this.$startEle=null,this.$endEle=null},checkEle:function(a){var b,c=this.ele,d=/^#/,f=/^\./,g=d.test(c),h=f.test(c),i=this.dSty,j=c.slice(1),k=e(a.target);return k.hasClass(i)||k.parents("."+i).length>0?b=!1:g&&(k.attr("id")==j||k.parents(c).length>0)?(k.attr("id")==j?k:k.parents(c),b=!0):h&&(k.hasClass(j)||k.parents(c).length>0)?(k.hasClass(j)?k:k.parents(c),b=!0):b=!1,b},checkLayer:function(a){var b=this.eleLayer,c=b.slice(1),d=e(a.target);return!!(d.attr("id")==c||d.parents(b).length>0||e(b).hasClass("js-blank-retain"))},checkWord:function(a){var b;if(this.curWord=b=e.trim(this.getWord.call(this)),""===b)return void this.hideButton();if(/\s/.test(b)){if(this.noteHide)return;this.createButton({word:{display:!1},parent:a})}else this.createButton({parent:a});this.setButtonPosition()},getWord:function(){var a,b,c,d="",f=this;if(void 0!==window.getSelection){if(b=window.getSelection(),b.rangeCount)for(a=0,c=b.rangeCount;a<c;a+=1)d+=b.getRangeAt(a).toString();f.status.$targetEle={},f.status.selectId=[],this.elements.each(function(a){if(b.containsNode&&b.containsNode(e(this).get(0),!0)){var c=e(this).data("id");c&&(f.status.selectId.push(c),f.status.$targetEle[c]=e(this))}})}else void 0!==document.selection&&"Text"===document.selection.type&&(d=document.selection.createRange().text);return d},getPosition:function(){var a,b,c,d,f,g,h,i,j=e(document).scrollTop();return void 0!==window.getSelection?(a=window.getSelection(),b=a.getRangeAt(0),c=b.getBoundingClientRect(),f=c.top+j,g=c.bottom+j,h=c.left,i=c.right):void 0!==document.selection&&(d=document.selection.createRange(),f=d.boundingTop+j,g=f+d.boundingHeight,h=d.boundingLeft,i=h+d.boundingWidth),this.boundary={left:h,right:i,top:f,bottom:g},this.boundary},setButtonPosition:function(){var a=this.popButton,b=a.width(),c=38,d=this.getPosition(),e=(d.left+d.right)/2-b/2,f=d.top-c;return a.css({left:e,top:f}).show(),this},setLayerPosition:function(){var a=this.boundary,b=e(this.eleLayer),c=b.width(),d=b.height(),f=a.bottom,g=a.left;return g>this.winWidth-c&&(g=this.winWidth-c-this.offset),f>this.winHeight-d&&(f=this.winHeight-d-this.offset),e(this.eleLayer).css({left:g,top:f}).show(),this},createButton:function(b){var c,d=this.popButton||e('<div class="g-word-tool" />'),f=a("new_toefl/tpl/word/popButton.tpl"),g=template.compile(f),h="",i={},j=[],k=b?b.parent:e(this.ele);c=kmfGlobalUser&&1==kmfGlobalUser.loginStatus?"note":"js-kmf-login note",i.word={menu:"查词",display:!0,className:"word"},this.noteHide||(i.note={menu:"笔记",display:!0,className:c}),d.appendTo("body");for(var l in i)"object"==typeof b&&b[l]&&e.extend(i[l],b[l]),i[l].display&&j.push(i[l]);h=g({toolList:j,qid:k.data("qid")}),d.html(h),this.popButton=d},hideButton:function(){this.popButton.hide()},createLayer:function(){e('<div class="g-word-translate" id="js-word-translate-layer" />').appendTo("body")},closeLayer:function(){return e(this.eleLayer).hide(),this},openLayer:function(){var a=e(this.eleLayer);return a.length<1&&this.createLayer(),this.resetLayer(),a.show(),this},setLayerSty:function(a){return e(this.eleLayer).addClass(a),this},resetLayer:function(){e(this.eleLayer).removeClass().addClass("g-word-translate").html("")},render:function(b){var c,d=this,f=e.trim(this.curWord),g=f.split(/\s/),d=this,b=b||e(this.ele).data("qid"),h=this.url+f+"&qid="+b,i=e(this.eleLayer),j=a("new_toefl/tpl/word/translate.tpl"),k=template.compile(j),l='<div class="nocontent"></div>',m=/[\u4e00-\u9fa5]/.test(f),n=e.cookie("kmfdictguide"),o=1!=n,p=b||e("#target_id").val()||0;return this.status.loading?this:g.length>1||m?(i.html(l),this):(this.status.loading=!0,e.post(h,function(a){1==a.status&&0==a.result?i.html(l):1==a.status&&(a.result.supportAudio=d.checkAudio(),a.result.isShowGuide=o,a.result.qid=p,c=k(a),i.html(c),d.curWord=a.result.word,d.curAudio=a.result.us_pron),d.status.loading=!1,d.setLayerPosition()},"json"),this)},favorite:function(a){var b,c,d=this.curWord,f=this;return c=a.data("op"),this.status.fav||-1==c?this:(b=this.favUrl+"?word="+d+"&op="+c,this.status.fav=!0,e.post(b,function(b){var d=1-c,e=["收藏","已收藏"],g=["word-icobg fav-ico","word-icobg faved-ico"];1==b.status&&(a.data("op",d),a.find(".menu-text").text(e[d]),a.find(".word-icobg").removeClass().addClass(g[d]),f.status.fav=!1)},"json"),this)},phonEvent:function(a){var b=this.curAudio;return this.checkAudio()&&(this.player||this.createPlayer(),this.setMedia(b).play()),this},checkAudio:function(){return!!document.createElement("audio").canPlayType},createPlayer:function(){return this.player=document.createElement("audio"),this.player.setAttribute("preload","auto"),document.body.appendChild(this.player),this},setMedia:function(a){return a&&""!=a?(this.player&&this.player.getAttribute("src")!=a&&this.player.setAttribute("src",a),this):this},play:function(){return this.player.play(),this}},d(i.prototype,f),c.exports=i}),define("new_toefl/js/mod/word/note",["jquery"],function(a,b,c){var d=a("jquery");c.exports={noteInit:function(){var a,b,c=this,e=this.eleLayer,f={noteButton:".note",noteSave:".note-save",noteCancel:".note-cancel"};this.noteEditorId="js-translate-note-editor",d(this.popButton).on("click",f.noteButton,function(d){kmfGlobalUser&&1!=kmfGlobalUser.loginStatus||(a=c.status.$targetEle,b=c.status.selectId,c.status.$targetEle={},c.openLayer().setLayerSty("g-translate-note js-blank-retain").setLayerPosition().noteRender())}),d(document).on("click",e+" "+f.noteSave,function(){c.noteSave.call(c,d(this),a,b)}),d(document).on("click",e+" "+f.noteCancel,function(){c.closeLayer()}),d(document).on("keyup","#"+this.noteEditorId,function(a){var b=d(e+" "+f.noteSave);""==d.trim(d(this).val())?b.addClass("btn-disabled"):b.removeClass("btn-disabled"),a.stopPropagation()})},noteSave:function(a,b,c){var e,f=this.noteSource,g=d("#"+this.noteEditorId),h=d.trim(g.val()),i=this,j=d("#target_id"),k=d("#parent_id"),l=d("#source_port"),m=d("#type");if(""!=h&&!a.data("doing")&&!a.hasClass("btn-disabled")){if(a.hasClass("js-translate-close"))return void this.closeLayer();1==c.length&&(e=c[0],b[e].data("type")),a.data("doing","doing"),d.post("/record/ajaxaddusernotes",{target_id:j.val(),parent_id:k.val(),source_port:l.val(),type:m.val(),content:h,source:f},function(b){var c=d(i.eleLayer),e=(c.find(".js-translate-notetips"),c.find(".note-cancel"),c.find(".save-btn"));1==b.status&&(a.removeData("doing"),e.show(),g.attr("readonly","readonly"),e.stop().animate({top:"-46px"},300,function(){e.delay(300).animate({top:"-66px",opacity:0},300),c.delay(500).fadeOut(500)}))},"json")}},noteRender:function(){var b,c=d(this.eleLayer),e=a("new_toefl/tpl/word/note.tpl"),f=template.compile(e),g="",h=this.curWord.replace(/\s{2,}/g," "),i=h.length+4,j=this.noteEditorId;g=f({words:h}),c.html(g),b=document.getElementById(j),this.setCursorPos(b,i),this.noteSource=h},setCursorPos:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}}}),define("new_toefl/tpl/word/note.tpl",[],'<div class="note-inner">\n\t<h2 class="title-bar js-translate-dragHandle">新的笔记</h2>\n\t<div class="note-editor">\n        \x3c!--"{{words}}"--\x3e\n\t\t<textarea class="editor" id="js-translate-note-editor"></textarea>\n\t</div>\n\t<div class="buttons g-clearfix">\n\t\t<span class="g-floatright">\n\t\t\t<a class="note-save" href="javascript:void(0)">保存</a>\n\t\t\t<a class="note-cancel" href="javascript:void(0)">取消</a>\n\t\t</span>\n\t\t<span class="tips js-translate-notetips">保存成功！<em class="g-g9">你可以在“</em><a href="/profile/notes" class="g-hl-1" target="_blank">我的记录→笔记</a><em class="g-g9">”中查看。</em></span>\n\t    <span class="save-btn"></span>\n    </div>\n</div>\n'),define("new_toefl/js/mod/word/drag",["jquery"],function(a,b,c){var d=a("jquery"),e=function(a,b){var c,e,f,g,h={handleEle:".title-bar"},i=!1,j="js-dragging";h=d.extend(h,b),d(document).delegate(a+" "+h.handleEle,"mousedown",function(b){var h=d(this).parents(a),k=(h.offset(),h.css("top")),l=h.css("left");c=b.pageX,e=b.pageY,f="auto"==l?0:parseInt(l),g="auto"==k?0:parseInt(k),h.addClass(j),i=!0}),d(document).on({mousemove:function(b){if(i){var h=b.pageX,j=b.pageY,k=d(a),l=h-c+f,m=j-e+g;d(this);b.preventDefault(),k.css({left:l,top:m})}},mouseup:function(){d(a).removeClass(j),i=!1}})};c.exports=e}),define("new_toefl/js/util/new_favorite",["jquery","new_toefl/js/util/form-textarea"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/js/util/form-textarea"),f=function(){};f.prototype={init:function(a,b){var c=this;if(c.opts={ele:".js-new-favorite",eles:[],dataEle:"",textEle:".menu-text",menuText:["已收藏","收藏"],delimiter:",",s_icon:".js-favicon",iconSty:"js-faved",cssSelector:{globleLogin:"#GlobeLogin",login:".js-kmf-login",favBox:"#js-kmf-favorite",favTitle:".js-favtitle",favListCont:".js-list-cont",favList:".js-favorite-lists",save:".js-save-btn",cancel:".js-fav-close",create:".js-create-list",deltet:".js-delete-btn",favInput:".js-favorite-input",favName:".js-favorite-name",newFav:".js-newFav"},favAjax:"/record/ajaxaddfavorite",unFavAjax:"/record/ajaxcancelfavorite",getFavAjax:"/record/ajaxgetuserfavorites",favCB:null,unfavCB:null},"Object"==c.checkType(a)?d.extend(c.opts,a):d.extend(c.opts,b),c.cssSelector=c.opts.cssSelector,c.bSend=!0,c.favSelectKey="",c.favCacheDate=null,c.maxNewFavList=10,c.nid=5,c.defaultFavName="默认收藏夹",1!=d(c.cssSelector.globleLogin).val()){var e=d(c.opts.ele),f=c.opts.eles.join(","),g=d(f);return e.addClass("js-kmf-login"),g.addClass("js-kmf-login"),c}return c._creatFavDialog(),c.ajaxUrl().getDom().bindEvent(),c},getDom:function(){var a=this,b="";return a.opts.eles[0]&&(b=a.opts.eles.join(","),a.favSelectKey=b),a.$textEle=d(a.opts.textEle),a.$icon=d(a.opts.s_icon),a.$favDialog=d(a.cssSelector.favBox),a.$favListCont=d(a.cssSelector.favListCont),a.$saveBtn=d(a.cssSelector.save),a.$cancelBtn=d(a.cssSelector.cancel),a.$createBtn=d(a.cssSelector.create),a},ajaxUrl:function(){var a=this;return a.favAjax=a.opts.favAjax,a.unFavAjax=a.opts.unFavAjax,a.getFavAjax=a.opts.getFavAjax,a},bindEvent:function(){var a=this;return a._tabEvent(),a._favoriteEvent(),a._cancelEvent(),a._createFavListEvent(),a._favListBlurEvent(),a._deleteFavListEvent(),a._inputKeybordEvent(),a},_favoriteEvent:function(){var a=this;return a.opts.ele&&d(document).off("click",a.opts.ele).on("click",a.opts.ele,function(){var b=d(this);a._favoriteFn(b)}),a.favSelectKey&&d(document).off("click",a.favSelectKey).on("click",a.favSelectKey,function(){var b=d(this);a._favoriteFn(b)}),a},_favoriteFn:function(a){var b=this,c=d(b.opts.dataEle),e="",f="",g="";b.bSend&&(b.bSend=!1,c[0]?(e=c.data("handle"),g=c.data("op"),f=c.data("text")):(c=d(a),e=a.data("handle"),g=a.data("op"),f=a.data("text")),f&&(b.opts.menuText=f.split(b.opts.delimiter)),1==e&&g?b._unfavorite(a,c):b._getFavList(a,c),b._saveEvent(a,c))},_getFavList:function(b,c){var e=this,f=c.data("type")||b.data("type"),g=c.data("handle")||b.data("handle"),h=c.data("fid")||b.data("fid"),i=d(e.cssSelector.favTitle),j={type:f},k=0;return d.post(e.getFavAjax,j,function(b){if(b.status){1==g?i.html("添加"+b.result.type+"收藏"):i.html("管理收藏");var c=a("new_toefl/tpl/favorite/favList.tpl"),f=template.compile(c),j=f(b.result);d(e.cssSelector.favListCont).html(""),d(e.cssSelector.favListCont).append(j),k=d(e.cssSelector.favList).size(),e.favListNum=k,e.favListNum>=e.maxNewFavList?d(e.cssSelector.create).hide():d(e.cssSelector.create).show(),e._setDefaultSelect(h,b.result.list),e.bSend=!0}},"json"),1==g?e.$createBtn.removeClass("hide"):e.$createBtn.addClass("hide"),e.$favDialog.show(),e.$favDialog.animate({opacity:1}),d(document.body).addClass("scrollHidden"),e},_setDefaultSelect:function(a,b){var c=this,e=d(c.cssSelector.favList);if(a&&b)return e.each(function(b,c){var f=d(c),g=f.data("jtype"),h=f.data("fid");1==g&&a==h&&(e.removeClass("active"),f.addClass("active"))}),c},_unfavorite:function(a,b){var c=this,e=c.checkType(c.opts.unfavCB),f=a.find(c.opts.textEle),g=a.find(c.opts.s_icon),h=b.data("type")||a.data("type"),i=b.data("jid")||a.data("jid"),j=b.data("word")||a.data("word"),k=b.data("handle")||a.data("handle"),l={type:h,jid:i,word:j};return d.post(c.unFavAjax,l,function(d){d.status&&1==k&&(b.data("op",0),g=g.size()?g:a,f.html(c.opts.menuText[1]),g.removeClass(c.opts.iconSty),"Function"==e&&c.opts.unfavCB(a),c.bSend=!0)},"json"),c},_saveEvent:function(a,b){var c=this,e=a.find(c.opts.textEle),f=!0,g=a.find(c.opts.s_icon),h=b.data("type")||a.data("type"),i=b.data("subject")||a.data("subject"),j=b.data("jid")||a.data("jid"),k=b.data("qid")||a.data("qid"),l=b.data("handle")||a.data("handle"),m=b.data("word")||a.data("word");return c.$saveBtn.off().on("click",function(){var n=(d(this),c.checkType(c.opts.favCB)),o=c._newFavListData(),p=c._getFavListData(),q={type:h,subject:i,jid:j,qid:k,handle:l,word:m,jtype:p.jtype,fid:p.fid,newlist:o};if(!f)return c;if(f=!1,p.jtype)d.post(c.favAjax,q,function(d){d.status&&(1==l&&(b.data("op",1),e.html(c.opts.menuText[0]),g.addClass(c.opts.iconSty)),c.$cancelBtn.click(),c.$favListCont.html(""),"Function"==n&&c.opts.favCB(a),f=!0)},"json");else{if(!f)return c;alert("请选择收藏夹")}}),c},_cancelEvent:function(){var a=this;return a.$cancelBtn.off().on("click",function(){d(this);a.$favDialog.animate({opacity:0},function(){a.$favDialog.hide()}),d(document.body).removeClass("scrollHidden")}),a},_creatFavDialog:function(){var b=this;if(!d("#js-kmf-favorite")[0]){var c=a("new_toefl/tpl/favorite/favorite.tpl"),e=template.compile(c),f=e();return d(document.body).append(f),b}},_tabEvent:function(){var a=this;return a.$favDialog.off("click",a.cssSelector.favList).on("click",a.cssSelector.favList,function(){var b=d(this);d(a.cssSelector.favList).removeClass("active"),b.addClass("active")}),a},_createFavListEvent:function(){var b=this;return b.$createBtn.off().on("click",function(){var c=(d(this),null),e=d(b.cssSelector.favList).size();if(b.favListNum=e,!(b.favListNum>=b.maxNewFavList)){var f=a("new_toefl/tpl/favorite/newFavList.tpl"),g=template.compile(f),h=g(b.nid);c=d(h),c.appendTo(b.$favListCont),d(b.cssSelector.favList).removeClass("active"),c.addClass("active"),c.find(b.cssSelector.favInput).focus(),b.favListNum++,b.nid++}}),b},_inputKeybordEvent:function(){var a=this;return a.$favDialog.off("keyup",a.cssSelector.favInput).on("keyup",a.cssSelector.favInput,function(b){return 13==b.keyCode&&d(a.cssSelector.favInput).blur(),!1}),a},_favListBlurEvent:function(){var a=this;return a.$favListCont.on("blur",a.cssSelector.favInput,function(){var b=d(this),c=b.closest(a.cssSelector.favList),f=e(b),g=c.find(a.cssSelector.favName);f?g.html(f):g.html(a.defaultFavName),a.favListNum>=a.maxNewFavList?a.$createBtn.hide():a.$cancelBtn.show(),c.addClass("success")}),a},_deleteFavListEvent:function(){var a=this;return a.$favListCont.on("click",a.cssSelector.deltet,function(b){return d(this).closest(a.cssSelector.favList).remove(),a.favListNum--,a.favListNum<=a.maxNewFavList&&a.$createBtn.show(),!1}),a},_newFavListData:function(){var a=this,b=[];return d(a.cssSelector.newFav).each(function(c,e){var f=d(e),g=f.find(a.cssSelector.favName),h={};h.nid=f.data("fid"),h.name=g.html(),b.push(h)}),b},_getFavListData:function(){var a=this,b={},c=d(a.cssSelector.favList),e="",f="";return c.each(function(a,b){var c=d(b);c.hasClass("active")&&(e=c.data("jtype"),f=c.data("fid"))}),b.jtype=e,b.fid=f,b},checkType:function(a){return Object.prototype.toString.call(a).slice(8,-1)}},c.exports=function(a,b){(new f).init(a,b)}}),define("new_toefl/js/util/form-textarea",[],function(a,b,c){var d={init:function(a,b){var c=this;if(a){if("String"==c._checkType(a)||"HTMLElement"==c._checkType(a))this.ele=$(a);else{if(!c._checkType("HTMLElement"==a[0]))throw new Error("error:参数错误");this.ele=a}return this.opt={trim:!1},$.extend(this.opt,b),this.trim?c._trim(c._textDispose()):c._textDispose()}},_escapeMap:{"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},_textDispose:function(){var a=this,b=this.ele.value||this.ele.val();return a._escapeHTML(b)},_checkType:function(a){return Object.prototype.toString.call(a).slice(8,-1)},_toString:function(a,b){var c=this;return"String"!==c._checkType(a)&&(b=c._checkType(a),"Number"===b?a+="":a="Function"===b?toString(a.call(a)):""),a},_escapeHTML:function(a){var b=this;return b._toString(a).replace(/&(?![\w#]+;)|[<>"']/g,function(a){return b._escapeMap[a]})},_trim:function(a){return a.replace(/(^\s+)|(\s+$)/gm,"")}};c.exports=function(a,b){return d.init(a,b)}}),define("new_toefl/tpl/favorite/favList.tpl",[],'{{if $data.list.length > 0}}\n    {{each $data.list as $value $index}}\n    <li class="favorite-lists js-favorite-lists favorite-icon {{if $index==0}}active{{/if}}" data-jtype="1" data-fid="{{$value.id}}">\n        <p class="favorite-name js-favorite-name">{{$value.name}}</p>\n\n    </li>\n    {{/each}}\n{{else}}\n    \x3c!--新建--\x3e\n    <li class="favorite-lists js-favorite-lists favorite-icon js-newFav active" data-jtype="2" data-fid="1">\n        <p class="favorite-name js-favorite-name">默认收藏夹</p>\n    </li>\n{{/if}}'),define("new_toefl/tpl/favorite/favorite.tpl",[],'\x3c!-- 新收藏功能弹窗元素 --\x3e\n<div id="js-kmf-favorite" class="g-new-favorite g-hide">\n    <div class="favorite-box g-mod-shadow">\n        <div class="favorite-title">\n            <h4 class="title js-favtitle"></h4>\n            <i class="close-btn favorite-icon js-fav-close"></i>\n        </div>\n        \x3c!--文件夹列表容器--\x3e\n        <div class="favorite-cont">\n            <ul class="favorite-list-cont js-list-cont">\n\n            </ul>\n            <span class="create-list js-create-list">+ 创建收藏夹</span>\n        </div>\n        <div class="favorite-btn-cont">\n            <span class="favorite-btns save-btn js-save-btn">保存</span>\n            <span class="favorite-btns cancel-btn js-fav-close">取消</span>\n        </div>\n    </div>\n</div>\n'),define("new_toefl/tpl/favorite/newFavList.tpl",[],'<li class="favorite-lists js-favorite-lists favorite-icon js-newFav" data-jtype="2" data-fid="{{$data}}">\n    <p class="favorite-name js-favorite-name"></p>\n    <div class="new-fav-cont js-new-fav-cont">\n        <input type="text" class="new-favorite-input js-favorite-input" maxlength="20" placeholder="输入收藏夹名称(20个字符以内)">\n        <i class="delete-btn favorite-icon js-delete-btn"></i>\n    </div>\n</li>'),define("new_toefl/tpl/word/popButton.tpl",[],'{{each toolList}}\n{{if $index > 0}}\n<span class="split">|</span>\n{{/if}}\n<a class="menu {{$value.className}}" href="javascript:;" data-qid="{{qid}}"><span class="toolicobg {{$value.className}}-ico"></span>{{$value.menu}}</a>\n{{/each}}\n<span class="arrow"></span>\n'),define("new_toefl/tpl/word/translate.tpl",[],'<div class="inner word-inner js-translate-inner">\n\t<div class="main">\n        <a class="btn-favorite{{if result.fav_status == -1}} js-kmf-login {{/if}}" id="js-translate-fav" data-op="{{result.fav_status}}" href="javascript:void(0)" data-type="13" data-word="{{result.word}}" data-handle="1" data-qid="{{result.qid}}">\n\t\t\t<span class="actionbg {{if result.fav_status == 1}}fav-ico-ed{{else}}fav-ico{{/if}}"></span>\n\t\t\t<span class="menu-text">{{if result.fav_status == 1}}已收藏{{else}}收藏{{/if}}</span>\n\t\t</a>\n\t\t<p class="word">{{result.word}}</p>\n\t\t<p class="sound">\n\t\t\t<span class="sound-mark">{{result.phon}}</span>\n\t\t\t{{if result.us_pron}}\n\t\t\t<a href="javascript:void(0)" class="word-icobg sound-ico js-word-play{{if !result.supportAudio}} js-kmf-tips{{/if}}" {{if !result.supportAudio}} data-msg="您的浏览器版本太低"{{/if}}></a>\n\t\t\t{{/if}}\n\t\t</p>\n        {{each result.translate}}\n\t\t<p class="zh">\n\t\t\t{{$value.property}}&nbsp;{{$value.cn_translate}}\n\t\t</p>\n        {{/each}}\n\t\t<a href="{{result.detail_url}}" target="_blank" class="more">更多详情>></a>\n\t</div>\n\t{{if result.isShowGuide}}\n\t<div class="dict-toefl js-dict-toefl">\n\t\t<p class="slogan-q">不认识单词影响做题效率?</p>\n\t\t<p class="slogan-a"><span class="g-g6">背熟真题词汇，做题时间减半！</span><a href="http://www.kmf.com/static/appcenter?website=toeflwords&s=chaci" class="more" target="_blank">更多详情>></a></p>\n\t\t<div class="app-wrapper">\n\t\t\t<div class="app-profile">\n\t\t\t\t<p class="app-name">考满分词汇App</p>\n\t\t\t\t<p class="app-desc g-g9">为TOEFL考试而生</p>\n\t\t\t</div>\n\t\t\t<p class="app-ps g-g6">\n\t\t\t\t扫描右方二维码即可使用\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class="guide-close">\n\t\t\t<a href="javascript:void(0)" class="lk-skip js-ignore">不再显示广告</a>\n\t\t</div>\n\n\t</div>\n\t{{/if}}\n</div>'),define("new_toefl/js/mod/statistics/userInformation",["raphael","jquery"],function(a,b,c){function d(a){var b={elem:"roundCount",size:0,name:0,txt:"蓄势待发",day:"今日"};e.extend(b,a);b.elem;if(this.obj=e("#"+b.elem)[0],!this.obj)return!1;this.size=b.size,this.r=Raphael(this.obj,300,300),this.rad=80,this.init=!0,this.speed=200,this.z=null,this.txtM=b.txt,this.name=b.name,this.day=b.day,0===this.size?this.color="#cecece":this.color="#b0e39e",this.minit()}a("raphael");var e=a("jquery");d.prototype.minit=function(){this.r.customAttributes.arc=function(a,b,c){var d,e=360/b*a,f=(90-e)*Math.PI/180,g=150+c*Math.cos(f),h=150-c*Math.sin(f);return d=b==a?[["M",150,150-c],["A",c,c,0,1,1,149.99,150-c]]:[["M",150,150-c],["A",c,c,0,+(e>180),1,g,h]],bpath=d,{path:d}},this.r.path().attr({arc:[100,100,this.rad],"stroke-width":15,stroke:"#f5f5f5"}),this.size&&(this.z=this.r.path().attr({arc:[.01,100,this.rad],"stroke-width":15,stroke:this.color,cursor:"pointer"}),this.updateVal(this.size,100,80,this.z,2));var a=this.r.circle(150,150,70);a.attr("fill","#fff"),a.attr("stroke","none"),this.txt=this.r.text(150,120,this.day+"得分").attr({font:"100 12px Arial",fill:"#333"}),this.txt=this.r.text(150,150,this.name).attr({font:"700 36px Arial",fill:"#000"}),this.txt=this.r.text(150,180,this.txtM).attr({font:"100 14px Arial",fill:"#000"})},d.prototype.updateVal=function(a,b,c,d,e){this.init?d.animate({arc:[a,b,c]},900,">"):a&&a!=b?d.animate({arc:[a,b,c]},750,"elastic"):(a=b,d.animate({arc:[a,b,c]},750,"bounce",function(){d.attr({arc:[0,b,c]})}))},c.exports=function(a){return new d(a)}}),define("new_toefl/js/mod/toefl-login",["jquery"],function(a,b,c){var d=a("jquery"),e={init:function(a){var b=this,a=a||{},c={style:{active:"active",disabled:"disabled"},select:{login:"#GlobeLogin",dialog:".js-login-dialog",loginBtn:".js-toefl-login",kmfLogin:".js-kmf-login",closeBtn:".js-close-login"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b=d.extend(b,b.style,b.select),b.opt=d.extend(c,a||{}),b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.ajaxGetData="",a},getDom:function(){var a=this;return a.$doc=d(document),a.$body=d("body"),a.$login=d(a.login),a.$kmfLogin=d(a.kmfLogin),a},setVariable:function(){var a=this;return a.status=200,a.login=~~a.$login.val(),a},bindEvent:function(){var a=this;return a._createDialogEvent(),a._kmfLoginEvent(),a},_createDialogEvent:function(){var a=this;return a.$doc.on("click",a.loginBtn,function(){d(this);return a._randerLogin(),!1}),a},_randerLogin:function(){var b=this,c=a("new_toefl/tpl/toefl-login.tpl"),d=template.compile(c),e=d();return b.$body.append(e),b._closeDialogEvent(),b},_closeDialogEvent:function(){var a=this,b=d(a.dialog);return d(a.closeBtn).off("click").on("click",function(){d(this),b.remove()}),a},_kmfLoginEvent:function(){var a=this;return a.$doc.on("click",a.kmfLogin,function(){d(this);d(a.dialog).remove()}),a}};c.exports=function(a){return e.init(a)}}),define("new_toefl/tpl/toefl-login.tpl",[],'\x3c!--托福登录框--\x3e\n<div class="toelf-new-login js-login-dialog">\n    <div class="toefl-login-box">\n        <div class="toefl-login-title">\n            <div class="toefl-title-msg">托福考满分，助你科学高效提分</div>\n            <div class="close-toelf-dialog login-icon js-close-login"></div>\n        </div>\n        <div class="toefl-login-buttons">\n            <div class="toelf-login-img login-icon"></div>\n            <div class="toefl-login-btn js-kmf-login">登录，开始练习</div>\n            <div class="toefl-register-btns">\n                <span class="toefl-register-msg">还没账号？</span>\n                <a href="/account/passportregister" class="toefl-register-link" target="_blank">马上注册>></a>\n            </div>\n        </div>\n        <div class="toefl-login-details">\n            <div class="login-detail-title">加入考满分，你将享有：</div>\n            <div class="login-lists-box">\n                <ul class="login-detail-lists">\n                    <li class="login-detail-list">\n                        <div class="detail-list-title">1.使用全部考满分在线学习内容 </div>\n                        <div class="detail-list-subtitle">ETS权威官方真题结合多种练习方式在线练</div>\n                    </li>\n                    <li class="login-detail-list">\n                        <div class="detail-list-title">2.做题数据全记录</div>\n                        <div class="detail-list-subtitle">做题数据云存储，网站做题手机同步，方便「温故而知新」</div>\n                    </li>\n                    <li class="login-detail-list">\n                        <div class="detail-list-title">3.多种备考方式，告别低效枯燥备考</div>\n                        <div class="detail-list-subtitle">Plan+备考指导，多种学习活动和大家一起备战托福</div>\n                    </li>\n                    <li class="login-detail-list">\n                        <div class="detail-list-title">4.新用户还可免费获得批改券 2 张</div>\n                        <div class="detail-list-subtitle">口语写作各一张，建议用于成绩检测，明确弱项</div>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>'),define("new_toefl/js/util/loginGuide",["jquery"],function(a,b,c){function d(a){l&&f.cookie("toefl_fe_login_warn",1),"up"==a?h.animate({top:-300},300,function(){h.hide()}):h.hide()}var e=a("new_toefl/tpl/login_guide.tpl"),f=a("jquery"),g={close:".js-guide-close",btnLogin:".btn-guide-login",btnRegister:".btn-guide-register",btnIgnore:".btn-guide-ignore"},h=f(e),i=f("#GlobeLoginWarn"),j=i.length>0&&"0"==f.trim(i.val())&&1!=f.cookie("toefl_fe_login_warn"),k=location.pathname.slice(1).split("/"),l="exam"==k[0];j&&(h.appendTo("body"),h.animate({top:0},500),h.find(g.close).on("click",function(){d("up")}),h.find(g.btnLogin).on("click",d),h.find(g.btnRegister).on("click",d),h.find(g.btnIgnore).on("click",d))}),define("new_toefl/tpl/login_guide.tpl",[],'<div class="i-toefl-login-guide" id="js-login-guide-layer">\n\t<div class="guide-container">\n\t\t<div class="topbar">\n\t\t\t<span class="title">请登录账号</span>\n\t\t\t<a class="guide-close js-guide-close">关闭</a>\n\t\t</div>\n\t\t<div class="guide-body">\n\t\t\t<div class="chart">\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class="buttons">\n\t\t\t\t<p>\n\t\t\t\t\t<a class="btn-guide-login js-kmf-login" href="javascript:void(0)">马上登录</a>\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t<a class="btn-guide-register" href="/account/passportregister?from=tanceng">快速注册</a>\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t<a class="btn-guide-ignore" href="javascript:void(0)">随便看看</a>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="shadow"></div>\n</div>'),define("new_toefl/js/mod/sign-in/judge-sign-in",["jquery"],function(a,b,c){var d,e,f,g=a("jquery"),h=parseInt(g("#GlobeSignIn").val()),i=a("new_toefl/tpl/login/logintips.tpl"),j=template.compile(i);e={platUrl:"/account/thirdlogin",platform:["qq","weixin","weibo"],backUrl:encodeURIComponent(window.location.href)},0==h&&(d=j(e),g("body").append(d),f=g("#js-signin-judge"),setTimeout(function(){f.show()},5e3)),g(document).delegate(".close-login","click",function(){f.hide()})}),define("new_toefl/tpl/login/logintips.tpl",[],'<div class="g-kmf-signin g-clearfix" id="js-signin-judge">\n    <div class="content g-clearfix">\n        <h2 class="login">登录使用，可以享受完善的 <span>练习数据报告</span></h2>\n        <div class="login-button g-clearfix">\n            <a class="login-in js-kmf-login" href="javascript:;">马上登录</a>\n            <a class="register" href="/account/passportregister">快速注册</a>\n            </div>\n        <div class="login-third g-clearfix">\n            <span>第三方登录</span>\n            <ul class="g-clearfix">\n                {{each platform}}\n                <li class="list-{{$index+1}}"><a href="{{platUrl}}?plat={{$value}}&backurl={{backUrl}}"></a></li>\n                {{/each}}\n            </ul>\n        </div>\n        <div class="close-login"></div>\n    </div>\n</div>'),define("new_toefl/js/mod/learn/toefl-top-publicize",[],function(a,b,c){!function(){var a=$(".i-toefl-ad980");if(a.size()){var b=a.find(".ad-btn-show"),c=a.find(".btn-top-close"),d=a.find(".ad-wrap"),e=($.cookie("toefl_top_ad"),Number($("#TopAdTime").val()));b.on("click",function(){$(this).stop().animate({height:0},500,function(){$(this).hide(),d.show().stop().animate({height:280})})}),c.on("click",function(){d.stop().animate({height:0},1e3,function(){$(this).hide(),b.show().stop().animate({height:30},500),$.cookie("toefl_top_ad",1,{expires:e/86400,path:"/"})})})}}()}),define("new_toefl/js/mod/rank/rank-list",["jquery","new_toefl/kmf_components/usercard/main","new_toefl/js/mod/rank/level-up","new_toefl/js/mod/rank/up-pie"],function(a,b,c){var d=a("jquery");a("new_toefl/kmf_components/usercard/main")({ajaxUrl:"/ajax/getusercard"}),a("new_toefl/js/mod/rank/level-up"),a("new_toefl/js/mod/rank/up-pie");var e=function(b){function c(a){var a=a||{},b=0==a.time?0:a.time||1,c=0==a.sub?0:a.sub||1,e=h.closest(".js-down"),f=e.find(".default-val"),g=i.closest(".js-down"),j=g.find(".default-val");h.each(function(a,c){var e=d(c),g=e.data("type");b==g&&f.html(e.text()).data("ctype",b)}),i.each(function(a,b){var e=d(b),f=e.data("type");c==f&&j.html(e.text()).data("ctype",c)})}function e(){var b={classify:m,type:k,pid:n,limit:o};g.html(""),d.post(r,b,function(b){var c=b.result;if(1==b.status){c.topList.map(function(a){a.login=q});var d=a("new_toefl/tpl/rank/bang-list.tpl"),e=template.compile(d),f=e(b);g.html(f),b.result.topList&&0==b.result.topList.length?g.addClass("no-people"):g.removeClass("no-people")}else g.html('<div class="default-img"></div>')},"json")}var b=b||{},f=d(".js-down"),g=d(".load-list-box"),h=d(".time-list"),i=d(".subject-list"),j=d("#rank_type"),k=j.val(),l=d("#rank_subject"),m=l.val(),n=d("#rank_pid").val(),o=b.limit||10,p=d("#GlobeLogin"),q=parseInt(p.val())||0,r=b.ajaxUrl||"/ajax/getranking";g[0]&&(c({time:k,sub:m}),e(),f.on("click",function(){var a=d(this);return d(".rank-sel-down").slideUp(),a.find(".rank-sel-down").stop().slideToggle(300),d(".up-bang").hide(),!1}),d(document).bind("click",function(){d(".rank-sel-down").slideUp()}),d(".time-list,.subject-list").on("click",function(){var a=d(this),b=(a.index(),a.data("type")),c=a.closest(".js-down"),f=c.find(".default-val");a.hasClass("time-list")&&(k=b),a.hasClass("subject-list")&&(m=b),f.html(a.text()).data("ctype",b),e()}))};c.exports=function(a){e(a)}}),define("new_toefl/kmf_components/usercard/main",["jquery"],function(a,b,c){var d=a("jquery"),e=function(b){function c(b){var c=a("new_toefl/kmf_components/usercard/tpl/usercard-new.tpl"),d=template.compile(c),f=d(b);e.html(f)}var d=b('<div class="js-user-card-wrap g-kmf-user-card"></div>'),e=b('<div class="js-user-card-inner user-card"></div>'),f=b("<div></div>"),g={};return e.appendTo(d),f.appendTo(d),function(a,h){var i,j,k,l,m,n,o,p=this.offset(),q=p.top,r=p.left,s=this.width(),t=this.height(),u=b(window).scrollTop(),v=(b(window).width(),b(window).height()),w=15,x="loading",y=this.data("id");if(l={bl:"bottomleft",br:"bottomright",tl:"topleft",tr:"topright"},m=l.tl,e.html(""),e.removeClass(x),b("body").append(d),d.outerWidth(),i=d.outerHeight(),n=q-u,o=v-n-t,o<i+w&&n>=i+w?(m=l.bl,j=q-i-w,k=r+s/2-55):(j=q+t+w,k=r+s/2-55),d.css({top:j,left:k<0?0:k}),f.removeClass().addClass(m),"close"==a)d.hide();else{if(d.show(),g[y])return g[y].tostyle=m,void c(g[y]);e.addClass(x),h.isRestful?b[h.ajaxType](h.ajaxUrl+y,function(a){1!=a.status&&200!=a.status||(a.result.tostyle=m,a.result.personalUrl=window.kmfGlobalConf.prefix+"toefl.kmf.com/user/personal/"+a.result.passport_id,g[y]=a.result,c(a.result),e.removeClass(x))},"json"):b[h.ajaxType](h.ajaxUrl,{pid:y},function(a){1!=a.status&&200!=a.status||(a.result.tostyle=m,a.result.personalUrl=window.kmfGlobalConf.prefix+"toefl.kmf.com/user/personal/"+a.result.passport_id,g[y]=a.result,c(a.result),e.removeClass(x))},"json")}}}(d);d.fn.extend({kmfUserCard:e});var f=function(a){var b,c,e=null,f=300;b={ajaxUrl:"/ajax/getusercard",ajaxType:"post",isRestful:!1,cssSelector:".js-user-card"},c="object"==typeof a?d.extend({},b,a):b,d(document).on({mouseenter:function(){var a=this;e&&(clearTimeout(e),e=null),d(a).kmfUserCard("open",c)},mouseleave:function(){var a=this;e=setTimeout(function(){d(a).kmfUserCard("close")},f)}},c.cssSelector),d(document).on({mouseenter:function(){e&&(clearTimeout(e),e=null)},mouseleave:function(){e&&clearTimeout(e),e=setTimeout(function(){d(".js-user-card-wrap").hide()},f)}},".js-user-card-inner")};c.exports=f}),define("new_toefl/kmf_components/usercard/tpl/usercard-new.tpl",[],'<div class="user-card-top g-clearfix">\n    <div class="top-head-bg">\n        <div class="user-pic">\n            <img src="{{pic_url}}"/>\n            <div class="card-leval">Lv{{userLevel}}</div>\n        </div>\n    </div>\n    <div class="user-info-card">\n        <p class="user-card-name">{{name}}</p>\n        <a href="{{personalUrl}}" class="user-card-url">进入<em>{{name}}</em>的个人主页 ></a>\n    </div>\n</div>\n<div class="card-content g-clearfix js-card-details">\n    <ul class="g-clearfix card-li-name">\n        <li>今日成长值</li>\n        <li>累计成长值</li>\n    </ul>\n    <ul class="g-clearfix card-li-cout">\n        <li>+{{todayScore}}</li>\n        <li>{{totalScore}}</li>\n    </ul>\n</div>'),define("new_toefl/js/mod/rank/level-up",["jquery"],function(a,b,c){var d=a("jquery"),e=d(".i-agree-bg"),f=d(".is-up-box"),g=d(".is-level-box");e.on("click",function(){f.hide(),g.show(),d.post("/ajax/userlevelrecord",{level:e.data("level")},function(a){},"json")})}),define("new_toefl/js/mod/rank/up-pie",["jquery"],function(a,b,c){var d=a("jquery");d("#pieChartBox").length&&a.async("//code.kmf.com/dist/libs/echarts/3.3.1/echarts.min.js",function(){var a=d("#pieChartBox").data("txt");d("#pieChartBox").data("nextscore"),d("#pieChartBox").data("currentscore");echarts.init(document.getElementById("pieChartBox")).setOption({title:{text:"今日成长",subtext:"+"+a,x:"center",y:120,textStyle:{fontSize:12,fontWeight:400,color:"#777"},subtextStyle:{fontSize:30,fontWeight:400,color:"#333"}},axis:{position:"top"},series:[{itemStyle:{normal:{color:function(a){return["#FFD032","#ededef"][a.dataIndex]},labelLine:{show:!1}}},legendHoverLink:!1,hoverAnimation:!1,silent:!0,animationEasing:"linear",type:"pie",center:["50%","50%"],radius:["50%","60%"],x:"0%",axisTick:{show:!1},data:[{value:a},{value:"3000"}]}]})})}),define("new_toefl/tpl/rank/bang-list.tpl",[],'{{each result.topList}}\n    {{if $index <= 2 }}\n    <div class="top-three {{if $value[\'current\'] == 1}}on-rank{{/if}}">\n        <div class="top-three-inbox g-clearfix">\n            <p class="user-portrait">\n                <span class="grade-tip {{if $value[\'rank\'] == 1}}top-one{{else if $value[\'rank\'] == 2}}top-two{{else $value[\'rank\'] == 3}}top-third{{/if}}">No.{{$value.rank}}</span>\n                <img src="{{$value[\'pic_url\']}}" class="js-user-card" data-id="{{$value.passport_id}}" data-sty="topleft">\n            </p>\n            <p class="user-message">\n                <span class="user-nikname js-user-card" data-id="{{$value.passport_id}}"\n                      data-sty="topleft">{{$value.name}}</span>\n                <span class="user-qnumb">当前等级Lv{{$value.levelData}}</span>\n            </p>\n            <p class="grow-up-val">+<span>{{$value.growthData}}</span></p>\n            <p></p>\n        </div>\n    </div>\n    {{else}}\n    <p class="d-r-list {{if $value[\'on-rank\'] == 1}}on-rank{{else if $value[\'rank\'] == -1}}ceil{{/if}}">\n        <span class="{{if $value[\'rank\'] > 10}}d-r-outrank{{else if $value[\'rank\'] == -1}}d-r-listnum ceil-icon{{else}}d-r-listnum{{/if}}">\n              {{if $value[\'rank\'] > 10}}No.{{/if}}{{$value[\'rank\']}}\n        </span>\n        <span class="d-r-name js-user-card" data-id="{{$value.passport_id}}" data-sty="topleft">\n            <em class="user-name">{{$value.name}}</em>\n            {{if $value[\'rank\'] == -1}}<em class="d-r-goup">不要偷懒，快去练习吧！</em>{{/if}}\n        </span>\n        {{if $value[\'rank\'] != -1}}<span class="d-r-integral">+{{$value.growthData}}</span>{{/if}}\n    </p>\n    {{/if}}\n{{/each}}\n{{if result.topList.length > 0}}\n    {{if result.myInfo.login != 1 }}\n    <p class="i-noat-list">\n                <span class="i-login-box">\n                    <span class="i-infinity-bg"></span>\n                    <span class="i-user-text">\n                        <span class="i-login-text js-kmf-login">\n                            登录\n                        </span>\n                    </span>\n                    <span class="i-text-container">\n                        后和大家一起PK吧！\n                    </span>\n                </span>\n    </P>\n    {{else }}\n        {{if result.myInfo.userRank >= 10 && result.myInfo.userRank < 99 && result.myInfo.emptyScore == 0 }}\n        <p class="i-noat-list">\n                        <span class="i-num-box">\n                            <span class="i-num-text">\n                               No.{{ result.myInfo.userRank}}\n                            </span>\n                            <span class="i-user-text">\n                                {{ result.myInfo.userName}}\n                            </span>\n                            <span class="i-text-container">\n                                +{{result.myInfo.userSource}}\n                            </span>\n                        </span>\n        </P>\n        {{else if result.myInfo.userRank > 100 && result.myInfo.emptyScore == 1}}\n        <p class="i-noat-list">\n            <span class="i-infinity-bg"></span>\n                        <span class="i-user-text">\n                            {{ result.myInfo.userName}}\n                        </span>\n                        <span class="i-text-container">\n                            不要偷懒，快去练习吧！\n                        </span>\n        </P>\n        {{else if result.myInfo.userRank > 100 && result.myInfo.emptyScore == 0 }}\n        <p class="i-noat-list">\n            <span class="i-infinity-bg"></span>\n                        <span class="i-user-text">\n                            {{ result.myInfo.userName}}\n                        </span>\n                        <span class="i-text-container">\n                        没上榜，加油哦~\n                        </span>\n        </P>\n        {{/if}}\n    {{/if}}\n{{/if}}'),define("new_toefl/js/mod/learn/info-acq",["new_toefl/js/mod/learn/testTravlePlan"],function(a,b,c){({lang:["你问我要去向何方<br/>我指着大海的方向","走难走的路<br/>收获不一样的风景","人没有目标跟<br/>咸鱼有什么区别？","目标是用来超越的"],score:{80:[22,18,17,23],90:[25,21,20,24],100:[27,25,21,27],110:[30,28,23,29]},init:function(){var b=$("#exam-time"),c=new Date(b.data("currenttime")),d=a("new_toefl/js/mod/learn/testTravlePlan"),e=this;if(this.$wrap=$("#i-kmf-infoacqwrapper"),0==this.$wrap.size())return!1;this.$btns=this.$wrap.find("dd.infoacq-btn"),this.$inputs=this.$wrap.find("input.line-input"),this.$uprow=this.$wrap.find("i.uprow"),this.$downrow=this.$wrap.find("i.downrow"),this.$submit=this.$wrap.find(".btn-start"),this.$warn=this.$wrap.find("span.rightwarn"),this.$txt=this.$wrap.find("div.infoacq-txt"),this.$subscore=this.$wrap.find("div.sub-score"),this.$selcts=this.$wrap.find("select.sel-date"),this.$totalpoints=this.$wrap.find(".infoacq-top"),this.btnFault=!0,this.taskId=$("#exam-time").data("targetid")?$("#exam-time").data("targetid"):0,d.setPlanTime.init(this.$wrap,{currentTime:c,examTime:b.data("examtime"),selectBack:function(a){e.selectDate=a,e.validate.call(e)}}),this.selectedScore=-1,this.bindListner(),this.initScore()},initScore:function(){var a=this,b=a.$totalpoints.data("totalscore")||0,c=a.$totalpoints.data("firstscore")||0,d=a.$totalpoints.data("secondscore")||0,e=a.$totalpoints.data("thirdscore")||0,f=a.$totalpoints.data("fourthscore")||0,g=[parseInt(c),parseInt(d),parseInt(e),parseInt(f)];b>=80&&-1==$.inArray(0,g)&&(a.$btns.each(function(){if(b-Number($(this).html().replace("+",""))<10){$(this).addClass("hot");var c=$(this).index(),d="sub-score sub-score-"+c;return a.$subscore.removeClass().addClass(d),!1}}),$.each(g,function(b,c){a.$inputs.eq(b).val(c)}),this.selectedScore=b)},bindListner:function(){var a=this;this.$btns.click(function(){var b,c=$(this).index(),d="sub-score sub-score-"+c;a.$btns.removeClass("hot"),$(this).addClass("hot"),a.$subscore.removeClass().addClass(d),a.selectedScore=Number($(this).html().replace("+","")),b=a.score[a.selectedScore],a.$inputs.each(function(a,c){$(this).val(b[a])}),a.validate()}),this.$uprow.click(function(){a.changeInput($(this),1)}),this.$downrow.click(function(){a.changeInput($(this),-1)}),this.$uprow.add(this.$downrow).add(this.$inputs).click(function(){a.$warn.hide()}),this.$submit.click(function(){var b=a.validate();if(a.btnFault&&a.selectedScore>0&&b)return a.btnFault=!1,a.submitForm(),btnFault=!1,!1}),this.$txt.html(function(){return'<span class="infoacq-prefix fixtail">『</span>'+a.lang[Math.floor(4*Math.random())]+'<span class="infoacq-afterfix fixtail">』</span>'})},changeInput:function(a,b){var c,d=a.siblings(".line-input"),e=d.val();if(/^-?\d+$/.test(e)){if(e=Number(e),(c=e+b)>30||c<0)return;d.val(c)}},submitForm:function(){var a=this,b={};a.validate()&&(b={exam_id:a.taskId,exam_time_year:a.selectDate.year,exam_time_month:a.selectDate.month,exam_time_day:a.selectDate.day,score:a.getScore()},$.post("/profile/ajaxuserexaminfo",b,function(a){200==a.status?(this.btnFault=!1,window.location.reload()):alert("开启备考旅程失败~~请重新尝试")},"json"))},donePost:function(){var a=this;return function(){a.$wrap.fadeOut(800)}},checkParam:function(){var a=this,b=!1;return a.$inputs.each(function(){var a=$(this).val();""==$.trim(a)?b="empty":/^-?\d+$/.test(a)&&Number(a)<0?b="lesszero":/^-?\d+$/.test(a)&&Number(a)>30?b="error":/^-?\d+$/.test(a)||(b="error")}),{warntype:b,arg:{score:a.$inputs.map(function(){return this.value}).toArray()}}},warnMsg:{empty:"目标分数不能为空",lesszero:"目标分数不能为空",error:"目标分数不正确"},validate:function(){var a=this.selectDate;return!!a&&("0000"!=a.year&&"0"!=a.month&&this.selectedScore>0?(this.$submit.removeClass("disabled"),!0):(this.$submit.addClass("disabled"),!1))},getScore:function(){var a=[];return this.$inputs.each(function(){a.push($(this).val())}),a}}).init()}),define("new_toefl/js/mod/learn/testTravlePlan",[],function(a,b,c){var d={init:function(a,b){var c,d,e,f,g,h=this;c={cssYear:".js-sel-year",cssMonth:".js-sel-month",cssDay:".js-sel-day",afterYears:3,currentTime:new Date,selectBack:null,examTime:null},this.opts=d=$.extend({},c,b),this.$year=e=a.find(d.cssYear),this.$month=f=a.find(d.cssMonth),this.$day=g=a.find(d.cssDay),this.setYear(e),this.setMouth(e,f,g),this.setDay(e,f,g),e.on("change",function(){h.examMouth(e,f,g),"function"==typeof h.opts.selectBack&&h.opts.selectBack(h.getSelDate())}),g.on("change",function(){"function"==typeof h.opts.selectBack&&h.opts.selectBack(h.getSelDate())}),"string"==typeof this.opts.examTime&&""!==this.opts.examTime&&this.setExamTime(this.opts.examTime)},setYear:function(a){for(var b=this.opts,c=b.currentTime,d=c.getFullYear(),e="",f=0;f<b.afterYears;f++)e+='<option value="'+(d+f)+'">'+(d+f)+"</option>";a.append(e)},setMouth:function(a,b,c){var d=this.opts,e=d.currentTime,f=e.getFullYear(),g=e.getMonth()+1,h=(e.getDate(),b);if(parseInt(a.val())==f)var i=g;else var i=1;h.empty().html("<option value='0'>月</option>"),0!=a.val()&&this.addItem(h,i,12),c.empty().html("<option value='0'>日</option>"),this.examDay(a,b,c)},setDay:function(a,b,c){var d=this;b.change(function(){d.examDay(a,b,c),"function"==typeof d.opts.selectBack&&d.opts.selectBack(d.getSelDate())})},examDay:function(a,b,c){var d=new Date,e=this.opts,d=e.currentTime;Y=d.getFullYear(),M=d.getMonth()+1,D=d.getDate();var f,g=c,h=parseInt(b.val()),i=parseInt(a.val());f=i==Y&&h==M?D:1,g.empty().append("<option value='00'>日</option>");var j=this.maxMonth(h,i);0!=parseInt(h)&&this.addItem(g,f,j)},examMouth:function(a,b,c){var d=this.opts,e=d.currentTime,f=e.getFullYear(),g=e.getMonth()+1,h=(e.getDate(),b);if(parseInt(a.val())==f)var i=g;else var i=1;h.empty().html('<option value="0">月</option>'),0!=a.val()&&this.addItem(h,i,12),c.empty().html("<option value='00'>日</option>"),this.examDay(a,b,c)},examYear:function(a,b,c){var d=this.opts,e=d.currentTime,f=e.getFullYear(),g=(e.getMonth(),e.getDate(),a),h=b,i=c;g.empty();for(var j=f;j<=f+2;j++)g.append('<option value="'+j+'">'+j+"</option>");h.empty(),i.empty().html("<option value='00'>日</option>")},maxMonth:function(a,b){var c=[1,3,5,7,8,10,12],d=[4,6,9,11];return $.inArray(a,c)>-1?31:$.inArray(a,d)>-1?30:b%4==0||b%400==0?29:28},addItem:function(a,b,c){for(b;b<=c;b++){var d="0"+b;a.append('<option value="'+d.substring(d.length-2)+'">'+b+"</option>")}},resetTime:function(a,b,c,d,e,f){this.examYear(d,e,f),a&&d.val(a),this.examMouth(d,e,f),b&&e.val(b),this.examDay(d,e,f),c&&f.val(c)},getSelDate:function(){return{year:this.$year.val(),month:this.$month.val(),day:this.$day.val()}},setExamTime:function(a){var b=a.split("-");this.$year.val(b[0]),this.examMouth(this.$year,this.$month,this.$day),this.$month.val(b[1]),this.examDay(this.$year,this.$month,this.$day),this.$day.val(b[2]),"function"==typeof this.opts.selectBack&&this.opts.selectBack(this.getSelDate())}};c.exports={setPlanTime:d}}),define("new_toefl/js/util/nav-list",["jquery"],function(a,b,c){var d=a("jquery");({init:function(a){var b=this,c={cssStyle:{active:"active"},cssSelector:{showNav:"#shownav",subNavCont:".js-sub-nav"}};return b.opt=d.extend(c,a),b.style=b.opt.cssStyle,b.select=b.opt.cssSelector,b.ajaxUrl().getDom().setVariable().bindEvent(),b},ajaxUrl:function(){var a=this;return a.ajaxGetData=window.kmfGlobalConf.prefix+"api.kmf.com/toefl-app/nav/practice",a},getDom:function(){var a=this;return a.$showNav=d(a.select.showNav),a.$subNavCont=d(a.select.subNavCont),a},setVariable:function(){var a=this;return a.showNav=a.$showNav.val(),a.status=200,a.data={},a},bindEvent:function(){var a=this;return a._sendAjax(),a},_sendAjax:function(){var a=this;return a.showNav?(d.ajax({url:a.ajaxGetData,beforeSend:function(a){a.setRequestHeader("K-Product-Line","toefl-web"),a.setRequestHeader("K-Platform","web")},type:"GET",success:function(b){var c=b;a._randerDom(c)}}),a):a},_randerDom:function(a){var b=this;return b.$subNavCont.html(""),b.$subNavCont.append(a),b}}).init()}),define("new_toefl/js/mod/personal-center-in/personal-center-in",["jquery"],function(a,b,c){var d=a("jquery"),e=a("new_toefl/tpl/personal-center-in/personal-center-in.tpl");({init:function(a){var b=this,a=a||{},c={style:{},select:{jsAvater:".js-avater-hover"}};return b.style=d.extend(c.style,a.style||{}),b.select=d.extend(c.select,a.select||{}),b.opt=d.extend(c,a||{}),b.ajaxUrl().setVariable().getDom().bindEvent(),b},ajaxUrl:function(){return this},setVariable:function(){var a=this;return a.authkey=d.cookie("authkey"),a.detailBoxEl='<div class="person-detail-box"></div>',a.personElHeight=170,a.clientHeight=document.documentElement.clientHeight,a.personTimer=null,a},getDom:function(){return this},bindEvent:function(){var a=this;return a._hoverEnvet(),a},_hoverEnvet:function(){var a=this;return d(".g-kmf-wrapper").on("click",a.select.jsAvater,function(){return window.location.href=window.kmfGlobalConf.prefix+"toefl.kmf.com/user/personal/"+d(this).data("pid"),!1}),d(document).delegate(a.select.jsAvater,"mouseover",function(b){d(".person-detail-box").hide(),clearTimeout(a.personTimer);var c=d(this),f=c.find(".person-detail-box"),g=c.data("pid");c.data("personal",!0);var h=c[0].getBoundingClientRect().top,i=a.clientHeight-h>a.personElHeight;if(f.length)i?f.removeClass("top").show():f.addClass("top").show();else{if(c.data("getdata"))return;c.data("getdata",!0),d.ajax({url:window.kmfGlobalConf.prefix+"api.kmf.com/toefl-app/preparation/getUserData?passport_id="+g,type:"get",dataType:"json",beforeSend:function(b){b.setRequestHeader("Authorization","Bearer "+a.authkey),b.setRequestHeader("K-Product-Line","toefl-web"),b.setRequestHeader("K-Platform","web")},success:function(b){if(200==b.status){var g=template.compile(e),h=g({data:b.result});d(a.detailBoxEl).html(h).appendTo(c),f=c.find(".person-detail-box");if(!c.data("personal"))return;var i=c[0].getBoundingClientRect().top;a.clientHeight-i>a.personElHeight?f.removeClass("top").show():f.addClass("top").show()}},complete:function(){c.data("getdata",!1)}})}}),d(document).delegate(a.select.jsAvater,"mouseleave",function(b){d(this).data("personal",!1),clearTimeout(a.personTimer),a.personTimer=setTimeout(function(){d(".person-detail-box").hide()},50)}),a}}).init()}),define("new_toefl/tpl/personal-center-in/personal-center-in.tpl",[],'<div class="position-box">\n    <div class="person-detail-box-con person-detail-justify">\n        <div class="person-detail-image">\n            <div class="person-detail-image">\n                <img class="person-image"\n                    src="{{data.pic ? data.pic : \'//code.kmf.com/dist/common/images/avatar.jpg\'}}">\n            </div>\n\n            <span class="person-detail-level">Lv{{ data.level }}</span>\n        </div>\n        <div class="person-detail-msg">\n            <p class="person-detail-name">{{ data.name }}</p>\n            <p class="person-detail-text">帮助考友：<span class="text-span">共解答{{ data.q_num }}个提问</span></p>\n            <p class="person-detail-text">备考心得：<span class="text-span">共创造{{ data.a_num }}篇内容</span></p>\n        </div>\n    </div>\n\n    <a class="enter-person" href="{{ data.center_url }}">进入{{data.name}}的个人主页 ></a>\n</div>'),define("new_toefl/tpl/ets-video.tpl",[],'<div class="ets-player-mask">\n    <div id="ets-player">\n        <span class="js-ets-player-close ets-player-close"></span>\n    </div>\n</div>');